import{bq as ge,br as z,bs as fe,bt as te,aE as be,bu as ye,bv as ve,r as g,bw as je,bx as we,by as Ne,bz as Ce,bA as G,bB as J,bC as Re,bD as ke,j as e,S as c,K as w,t as Se,z as O,w as B,a1 as Oe,aq as Pe,ar as Ie,as as qe,at as Qe,B as S,C as $e,b as Ee,D as Ae,c as Te,u as Me,af as Fe,aG as Be,ah as _e,ay as ze,az as Le,ai as We,bE as De}from"./index-BiCr9dd_.js";import{B as _}from"./badge-gylWw4eT.js";import{R as Ve}from"./ReadMore-DMY4alUQ.js";import{B as He}from"./breadcrumb-wrapper-448K_ANJ.js";import{R as Ke}from"./ReviewCard-CMVhcThB.js";import{a as ae}from"./StarRating-BvoSMCCK.js";import{p as X}from"./productService-DV0qzB1U.js";import{L as Y}from"./LazyImage-B7kMTuiL.js";import{u as Ue,a as Ge,g as Je,P as Xe}from"./ProductCard-ueUUK-Pf.js";import{g as q}from"./colorUtils-Cg0F6a_m.js";import{m as Z}from"./proxy-16hbtkMy.js";import{M as Ye}from"./minus-D5glgwFc.js";import{P as Ze}from"./pen-dOS5U9bV.js";import"./date-utils-CIparGJB.js";function ee(i,t){const l=new Set(t);return i.filter(n=>!l.has(n))}function es(i,t,l){const n=i.slice(0);return n[t]=l,n}var ss=class extends ge{#a;#e;#r;#i;#s;#t;#l;#n;#o=[];constructor(i,t,l){super(),this.#a=i,this.#i=l,this.#r=[],this.#s=[],this.#e=[],this.setQueries(t)}onSubscribe(){this.listeners.size===1&&this.#s.forEach(i=>{i.subscribe(t=>{this.#u(i,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#s.forEach(i=>{i.destroy()})}setQueries(i,t){this.#r=i,this.#i=t,z.batch(()=>{const l=this.#s,n=this.#m(this.#r);this.#o=n,n.forEach(m=>m.observer.setOptions(m.defaultedQueryOptions));const d=n.map(m=>m.observer),u=d.map(m=>m.getCurrentResult()),r=d.some((m,x)=>m!==l[x]);l.length===d.length&&!r||(this.#s=d,this.#e=u,this.hasListeners()&&(ee(l,d).forEach(m=>{m.destroy()}),ee(d,l).forEach(m=>{m.subscribe(x=>{this.#u(m,x)})}),this.#x()))})}getCurrentResult(){return this.#e}getQueries(){return this.#s.map(i=>i.getCurrentQuery())}getObservers(){return this.#s}getOptimisticResult(i,t){const l=this.#m(i),n=l.map(d=>d.observer.getOptimisticResult(d.defaultedQueryOptions));return[n,d=>this.#d(d??n,t),()=>this.#c(n,l)]}#c(i,t){return t.map((l,n)=>{const d=i[n];return l.defaultedQueryOptions.notifyOnChangeProps?d:l.observer.trackResult(d,u=>{t.forEach(r=>{r.observer.trackProp(u)})})})}#d(i,t){return t?((!this.#t||this.#e!==this.#n||t!==this.#l)&&(this.#l=t,this.#n=this.#e,this.#t=fe(this.#t,t(i))),this.#t):i}#m(i){const t=new Map(this.#s.map(n=>[n.options.queryHash,n])),l=[];return i.forEach(n=>{const d=this.#a.defaultQueryOptions(n),u=t.get(d.queryHash);u?l.push({defaultedQueryOptions:d,observer:u}):l.push({defaultedQueryOptions:d,observer:new te(this.#a,d)})}),l}#u(i,t){const l=this.#s.indexOf(i);l!==-1&&(this.#e=es(this.#e,l,t),this.#x())}#x(){if(this.hasListeners()){const i=this.#t,t=this.#c(this.#e,this.#o),l=this.#d(t,this.#i?.combine);i!==l&&z.batch(()=>{this.listeners.forEach(n=>{n(this.#e)})})}}};function se({queries:i,...t},l){const n=be(),d=ye(),u=ve(),r=g.useMemo(()=>i.map(s=>{const h=n.defaultQueryOptions(s);return h._optimisticResults=d?"isRestoring":"optimistic",h}),[i,n,d]);r.forEach(s=>{je(s),we(s,u)}),Ne(u);const[m]=g.useState(()=>new ss(n,r,t)),[x,b,N]=m.getOptimisticResult(r,t.combine),C=!d&&t.subscribed!==!1;g.useSyncExternalStore(g.useCallback(s=>C?m.subscribe(z.batchCalls(s)):Ce,[m,C]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),g.useEffect(()=>{m.setQueries(r,t)},[r,t,m]);const y=x.some((s,h)=>G(r[h],s))?x.flatMap((s,h)=>{const f=r[h];if(f){const P=new te(n,f);if(G(f,s))return J(f,P,u);Re(s,d)&&J(f,P,u)}return[]}):[];if(y.length>0)throw Promise.all(y);const k=x.find((s,h)=>{const f=r[h];return f&&ke({result:s,errorResetBoundary:u,throwOnError:f.throwOnError,query:n.getQueryCache().get(f.queryHash),suspense:f.suspense})});if(k?.error)throw k.error;return b(N())}const ts=()=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"})]}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-20"})]}),e.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((i,t)=>e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"},t))}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})]})]})}),as=()=>e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-4 w-12"}),e.jsx(c,{className:"h-4 w-2"}),e.jsx(c,{className:"h-4 w-20"}),e.jsx(c,{className:"h-4 w-2"}),e.jsx(c,{className:"h-4 w-24"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-12",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx(c,{className:"w-full h-[250px] sm:h-[350px] md:h-[400px] rounded-sm"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{className:"absolute left-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full"}),e.jsx("div",{className:"flex gap-2 sm:gap-3 mx-10 sm:mx-12 md:mx-14",children:Array.from({length:3}).map((i,t)=>e.jsx(c,{className:"flex-shrink-0 w-[80px] h-[60px] sm:w-[120px] sm:h-[80px] md:w-[150px] md:h-[100px] lg:w-[180px] lg:h-[120px] rounded-lg"},t))}),e.jsx(c,{className:"absolute right-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"h-8 sm:h-10 lg:h-12 w-full mb-3 sm:mb-4"}),e.jsx(c,{className:"h-6 sm:h-8 w-3/4 mb-2"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(c,{className:"h-8 sm:h-10 w-20"}),e.jsx(c,{className:"h-6 sm:h-8 w-16"}),e.jsx(c,{className:"h-6 w-12 rounded-full"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(c,{className:"h-4 w-20"}),e.jsx(c,{className:"h-4 w-24"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 sm:pt-6 space-y-2",children:[e.jsx(c,{className:"h-4 w-full"}),e.jsx(c,{className:"h-4 w-full"}),e.jsx(c,{className:"h-4 w-3/4"}),e.jsx(c,{className:"h-4 w-1/2"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsx(c,{className:"h-4 w-48"})}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsx(c,{className:"h-4 w-32"})}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:[e.jsx(c,{className:"h-4 w-16 mb-2"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:3}).map((i,t)=>e.jsx(c,{className:"h-6 w-16 rounded-full"},t))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:[e.jsx(c,{className:"h-4 w-16 mb-2"}),e.jsx("div",{className:"flex gap-3",children:Array.from({length:4}).map((i,t)=>e.jsx(c,{className:"w-12 h-12 rounded-full"},t))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4 pt-4 sm:pt-6",children:[e.jsx(c,{className:"w-full sm:flex-1 h-[48px] sm:h-[56px] rounded"}),e.jsx(c,{className:"w-full sm:flex-1 h-[48px] sm:h-[56px] rounded"})]})]})]}),e.jsxs("div",{className:"mt-8 sm:mt-12 border-t border-gray-200 pt-6 sm:pt-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx(c,{className:"h-6 sm:h-8 w-40 mb-3 sm:mb-4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex space-x-1",children:Array.from({length:5}).map((i,t)=>e.jsx(c,{className:"w-5 h-5"},t))}),e.jsx(c,{className:"h-4 w-20"})]})]}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:Array.from({length:3}).map((i,t)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsx(c,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"h-4 w-24"}),e.jsx(c,{className:"h-3 w-20"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"flex space-x-1",children:Array.from({length:5}).map((l,n)=>e.jsx(c,{className:"w-4 h-4"},n))})})]}),e.jsx(c,{className:"h-4 w-full"}),e.jsx(c,{className:"h-4 w-3/4"}),e.jsx(c,{className:"h-4 w-1/2"})]},t))})]})]});class rs{async createReview(t){return(await w.post("/reviews",t)).data}async getProductReviews(t,l){return(await w.get(`/reviews/products/${t}`,{params:l})).data}async getUserReviews(t){return(await w.get("/reviews/my-reviews",{params:t})).data}async updateReview(t,l){return(await w.put(`/reviews/${t}`,l)).data}async deleteReview(t){return(await w.delete(`/reviews/${t}`)).data}async markReviewHelpful(t,l){return(await w.post(`/reviews/${t}/helpful`,{helpful:l})).data}async addReviewResponse(t,l){return(await w.post(`/reviews/${t}/response`,{comment:l})).data}async updateReviewStatus(t,l,n){return(await w.put(`/reviews/${t}/status`,{status:l,reason:n})).data}}const re=new rs,is=()=>Se({mutationFn:re.createReview,onSuccess:i=>{B.invalidateQueries({queryKey:["reviews"]}),B.invalidateQueries({queryKey:["product-reviews"]}),B.invalidateQueries({queryKey:["user-reviews"]})},onError:i=>{const t=i.response?.data?.message||"Failed to submit review";O.error(t)}}),ls=({isOpen:i,onClose:t,productId:l,orderId:n,onSuccess:d,existingReview:u})=>{const[r,m]=g.useState(0),[x,b]=g.useState(""),N=is();Oe.useEffect(()=>{i&&(u&&u.id?(m(u.rating||0),b(u.comment||"")):(m(0),b("")))},[i,u]);const C=async()=>{if(r===0){O.error("Please select a rating");return}if(x.length<10){O.error("Comment must be at least 10 characters");return}try{await N.mutateAsync({type:"product",product:l,order:n,rating:r,comment:x}),O.success(u?"Review updated successfully!":"Review submitted successfully!"),m(0),b(""),d?.(),R()}catch(y){console.error("Failed to submit review:",y)}},R=()=>{m(0),b(""),t()};return e.jsx(Pe,{open:i,onOpenChange:R,children:e.jsxs(Ie,{className:"sm:max-w-[500px] bg-white",children:[e.jsx(qe,{children:e.jsx(Qe,{className:"text-xl font-bold",children:u?"Edit Review & Rating":"Add Review & Rating"})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Rating"}),e.jsx(ae,{size:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8",rating:r,onRatingChange:y=>m(y)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Comment"}),e.jsx("textarea",{placeholder:"Share your experience with the seller...",className:"w-full min-h-[100px] sm:min-h-[120px] md:min-h-[150px] p-2 sm:p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none text-sm sm:text-base  leading-relaxed",value:x,maxLength:500,onChange:y=>b(y.target.value),rows:3})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(S,{variant:"outline",onClick:R,className:"px-6 w-[220px] border-gray-200 text-gray-600 ",children:"Cancel"}),e.jsx(S,{onClick:C,disabled:N.isPending||r===0||x.length<10,className:"bg-primary hover:bg-primary/90 text-white px-6 w-[220px]",children:N.isPending?"Submitting...":u?"Update Review":"Add Review"})]})]})})},ns=()=>e.jsxs($e,{className:"overflow-hidden border-none shadow-none bg-transparent p-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-full h-44 bg-gray-200 rounded-xl animate-pulse"}),e.jsx("div",{className:"absolute top-2 right-2 w-10 h-10 bg-gray-300 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute bottom-2 left-2 w-24 h-6 bg-gray-300 rounded animate-pulse"})]}),e.jsxs(Ee,{className:"p-3 space-y-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-24 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full animate-pulse"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 animate-pulse"})]})]})]}),ws=()=>{const{slug:i}=Ae(),t=Te(),{user:l,isAuthenticated:n}=Me(),[d,u]=g.useState(0),[r,m]=g.useState(null),[x,b]=g.useState(1),[N,C]=g.useState(!1),R=g.useRef(null),y=g.useRef([]),k=se({queries:[{queryKey:["product",i],queryFn:()=>X.getProductBySlug(i||""),enabled:!!i}]})[0],s=k.data?.data,h=s?.id||s?._id||"",f=se({queries:[{queryKey:["related-products",h],queryFn:()=>X.getRelatedProducts(h,4),enabled:!!h},{queryKey:["product-reviews",h],queryFn:()=>re.getProductReviews(h),enabled:!!h}]}),[P,$]=f,ie=k.isLoading,le=k.error,E=P.data,L=P.isLoading,ne=$.data,oe=$.isLoading,W=Ue(),D=Ge(),[A,Q]=g.useState(s?.isInWishlist||!1),V=W.isPending||D.isPending;g.useEffect(()=>{Q(s?.isInWishlist||!1)},[s?.isInWishlist]);const ce=a=>{if(a.stopPropagation(),!n){O.error("Please login to add to wishlist");return}if(!V&&h){const o=!A;Q(o),o?W.mutate({productId:h},{onError:()=>{Q(!1)}}):D.mutate({productId:h},{onError:()=>{Q(!0)}})}},v=r?.images?.length>0?r.images:s?.images||[];g.useEffect(()=>{u(0),b(1)},[r]);const T=ne?.data?.reviews?.map(a=>({id:a._id||a.id,userName:`${a.reviewer?.firstName||""} ${a.reviewer?.lastName||""}`.trim()||"Anonymous",date:new Date(a.createdAt),rating:a.rating,comment:a.comment,avatar:a.reviewer?.profile?.avatar||`https://placehold.co/50x50/FF6B6B/ffffff?text=${(a.reviewer?.firstName?.[0]||"A").toUpperCase()}${(a.reviewer?.lastName?.[0]||"").toUpperCase()}`,helpfulCount:a.helpfulCount,response:a.response}))||[];g.useEffect(()=>{const a=y.current[d],o=R.current;if(a&&o){const p=o.getBoundingClientRect(),j=a.getBoundingClientRect();(j.left<p.left||j.right>p.right)&&a.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[d]);const de=()=>{v.length&&u(a=>a>0?a-1:v.length-1)},me=()=>{v.length&&u(a=>a<v.length-1?a+1:0)},ue=a=>{u(a)},H=a=>{const o=r?r?.outOfStock?0:r?.quantity:s?.outOfStock?0:s?.quantity||0;a?x<o&&b(x+1):x>1&&b(x-1)},{addItem:xe}=Fe(),K=(a=!1)=>{if(!s)return;const o=r?.price||s.price||0,p=r?.discount||s.discount;let j=o;p&&p.discountType!=="none"&&p.discountValue&&(p.discountType==="flat"?j=Math.max(0,o-p.discountValue):p.discountType==="percentage"&&(j=o*(1-p.discountValue/100)));const M=r?r?.outOfStock?0:r?.quantity:s?.outOfStock?0:s?.quantity||0,I=r?.color||s.color,U=I?q(I).name:"",pe=U?` - ${U}`:"",F=`${s.title}${pe}`;if(a){if(!l){t("/auth/login",{state:{from:{pathname:"/checkout"},buyNowItem:{productId:s.id||"",variantId:r&&(r?._id||r?.id)||"",title:F,slug:s.slug,price:j,originalPrice:o,discount:p,quantity:x,image:v[0]||"https://placehold.co/300x200.png",color:I,seller:s.seller?.profile?.businessName?{id:s.seller?._id||"",businessName:s.seller.profile.businessName}:void 0,maxQuantity:M,selectedOptions:r?{color:r.color}:s.color?{color:s.color}:void 0}}});return}t("/checkout",{state:{buyNowItem:{id:`${s.id}-${r?.id||"base"}-${Date.now()}`,productId:s.id||"",variantId:r&&(r?._id||r?.id)||"",title:F,slug:s.slug,price:j,originalPrice:o,discount:p,quantity:x,image:v[0]||"https://placehold.co/300x200.png",color:I,seller:s.seller?.profile?.businessName?{id:s.seller?._id||"",businessName:s.seller.profile.businessName}:void 0,maxQuantity:M,marketplaceOptions:s.marketplaceOptions,shippingPrice:s.shippingPrice,selectedOptions:r?{color:r.color}:s.color?{color:s.color}:void 0}}});return}xe({productId:s.id||"",variantId:r&&(r?._id||r?.id)||"",title:F,slug:s.slug,price:j,originalPrice:o,discount:p,quantity:x,image:v[0]||"https://placehold.co/300x200.png",color:I,seller:s.seller?.profile?.businessName?{id:s.seller?._id||"",businessName:s.seller.profile.businessName}:void 0,maxQuantity:M,marketplaceOptions:s.marketplaceOptions,shippingPrice:s.shippingPrice,selectedOptions:r?{color:r.color}:s.color?{color:s.color}:void 0})},he=[{label:"Home",href:"/"},{label:"Marketplace",href:"/marketplace"},{label:s?.title||"Product",isCurrentPage:!0}];return ie?e.jsx(as,{}):le||!s?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load product"}),e.jsx(S,{onClick:()=>t("/seller/products"),variant:"outline",children:"Back to Products"})]})}):e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsx("div",{className:"",children:e.jsx(He,{items:he})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-12",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"rounded-md relative",children:[e.jsx("div",{className:"w-full absolute bottom-2 left-2 z-10 justify-end",children:Je(s)}),e.jsx(Z.button,{className:"absolute top-2 right-2 rounded-full bg-black/20 backdrop-blur-sm p-2 transition-all duration-200 hover:bg-black/30 z-10",onClick:ce,whileHover:{scale:1.1},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2},children:e.jsx(Z.div,{animate:{scale:A?[1,1.2,1]:1},transition:{duration:.3},children:e.jsx(Be,{className:_e("h-5 w-5 transition-colors duration-200 cursor-pointer",A?"text-red-500 fill-red-500":"text-white hover:text-red-400",V&&"opacity-50")})})}),e.jsx(Y,{src:v[d]||"https://placehold.co/600x600/e5e7eb/6b7280?text=No+Image",alt:s?.title||"Product image",className:"rounded-sm bg-white border-gray-200 shadow-md border",wrapperClassName:"w-full h-[250px] sm:h-[350px] md:h-[450px] bg-gray-100 rounded-sm",fallbackSrc:"https://placehold.co/600x600/e5e7eb/6b7280?text=No+Image",objectFit:"cover",showSkeleton:!0,fadeInDuration:.3,rootMargin:"100px"})]}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:de,className:"absolute left-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-white rounded-full border border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm cursor-pointer","aria-label":"Previous image",children:e.jsx(ze,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})}),e.jsx("div",{ref:R,className:"flex gap-2 sm:gap-3 overflow-x-auto mx-10 sm:mx-12 md:mx-14 px-1 sm:px-2 scroll-smooth [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:v.map((a,o)=>e.jsx("button",{ref:p=>{y.current[o]=p},onClick:()=>ue(o),className:`flex-shrink-0 w-[80px] h-[60px cursor-pointer bg-white sm:w-[120px] sm:h-[80px] md:w-[150px] md:h-[100px] lg:w-[180px] lg:h-[120px] rounded-lg overflow-hidden border-2 transition-all ${d===o?"border-primary shadow-md":"border-gray-200 hover:border-gray-300"}`,children:e.jsx(Y,{src:a,alt:`${s?.title} ${o+1}`,className:"rounded-lg  border-gray-200 shadow-md border",wrapperClassName:"w-full h-full",fallbackSrc:"https://placehold.co/180x120/e5e7eb/6b7280?text=No+Image",objectFit:"cover",showSkeleton:!0,fadeInDuration:.2,rootMargin:"50px"})},o))}),e.jsx("button",{onClick:me,className:"absolute right-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-white rounded-full border border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm cursor-pointer","aria-label":"Next image",children:e.jsx(Le,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-3 sm:mb-4",children:s.title}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4",children:[e.jsx("div",{className:"flex items-center space-x-2 sm:space-x-4",children:(()=>{const a=r?.discount||s.discount,o=r?.price||s.price||0;if(a?.discountType!=="none"&&a?.discountValue){if(a.discountType==="percentage"){const p=o*(1-a.discountValue/100);return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-primary",children:["$",p.toFixed(2)]}),e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl text-gray-400 line-through",children:["$",o.toFixed(2)]}),e.jsxs(_,{className:"bg-primary text-white px-2 sm:px-3 py-0.5 sm:py-1 text-xs sm:text-sm font-semibold",children:["-",a.discountValue,"%"]})]})}if(a.discountType==="flat"){const p=o-a.discountValue;return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-primary",children:["$",p.toFixed(2)]}),e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl text-gray-400 line-through",children:["$",o.toFixed(2)]}),e.jsxs(_,{className:"bg-primary text-white px-2 sm:px-3 py-0.5 sm:py-1 text-xs sm:text-sm font-semibold",children:["-$",a.discountValue]})]})}}else return e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-primary",children:["$",o.toFixed(2)]})})()}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Availability:"}),(()=>{const a=r?r?.outOfStock?0:r?.quantity:s.outOfStock?0:s.quantity||0;return a>0?e.jsxs("span",{className:"text-green-600 font-medium",children:["In stock (",a," available)"]}):e.jsx("span",{className:"text-red-600 font-medium",children:"Out of stock"})})()]})]})]}),e.jsxs("div",{className:" flex flex-col sm:hidden border-t border-gray-200 text-xs sm:text-sm text-gray-600 pt-4 sm:pt-6 space-y-2",children:[e.jsx("span",{className:"font-medium",children:"Colors: "}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2",children:[e.jsx("div",{onClick:()=>m(null),className:`w-12 h-12 rounded-full border-2transition-all cursor-pointer ${r===null?"border-black bg-primary/5 border-3":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:s.color},title:s.color?q(s.color).name:""}),s.variants&&s.variants.length>0&&s.variants.map((a,o)=>e.jsx("div",{onClick:()=>m(a),className:`w-12 h-12 rounded-full cursor-pointer transition-all ${r===a?"ring-2 ring-black ring-offset-2":"ring-1 ring-gray-300 ring-offset-2 hover:ring-gray-400"}`,style:{backgroundColor:a.color},title:a.color?q(a.color).name:""},o))]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsx(Ve,{text:s.description||"No description available",maxLength:200,className:"text-sm sm:text-base text-gray-700 leading-relaxed"})}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Categories: "}),e.jsxs("span",{className:"text-gray-900",children:[s.category,", ",s.subCategory]})]})}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6 grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs sm:text-sm",children:s.brand&&e.jsxs("div",{className:" text-gray-600 flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Brand: "}),e.jsx("p",{className:"text-sm font-medium",children:s.brand})]})}),s.productTag&&s.productTag.length>0&&e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.jsxs("div",{className:"col-span-2 space-y-2 text-xs sm:text-sm  text-gray-600 flex-col items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Tags: "}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.productTag.map((a,o)=>e.jsx(_,{variant:"secondary",className:"text-xs bg-blue-100 capitalize",children:a},o))})]})}),e.jsxs("div",{className:"border-t hidden sm:flex flex-col border-gray-200 text-xs sm:text-sm text-gray-600 pt-4 sm:pt-6 space-y-2 ",children:[e.jsx("span",{className:"font-medium",children:"Colors: "}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2",children:[e.jsx("div",{onClick:()=>m(null),className:`w-12 h-12 rounded-full cursor-pointer transition-all ${r===null?"ring-2 ring-black ring-offset-2 ":"ring-1 ring-gray-300 ring-offset-2 hover:ring-gray-400 "}`,style:{backgroundColor:s.color},title:s.color?q(s.color).name:""}),s.variants&&s.variants.length>0&&s.variants.map((a,o)=>e.jsx("div",{onClick:()=>m(a),className:`w-12 h-12 rounded-full cursor-pointer transition-all ${r===a?"ring-2 ring-black ring-offset-2":"ring-1 ring-gray-300 ring-offset-2 hover:ring-gray-400"}`,style:{backgroundColor:a.color},title:a.color?q(a.color).name:""},o))]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-6",children:[e.jsxs("div",{className:"flex items-center bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>H(!1),disabled:x<=1,className:"p-3  hover:bg-gray-200 transition-colors cursor-pointer  disabled:opacity-50 disabled:cursor-not-allowed h-[56px]",children:e.jsx(Ye,{className:"h-5 w-5 text-gray-600"})}),e.jsx("span",{className:"px-6 py-3 text-lg font-semibold min-w-[60px] text-center",children:x}),e.jsx("button",{onClick:()=>H(!0),disabled:x>=(r?r?.outOfStock?0:r?.quantity:s?.outOfStock?0:s?.quantity||0),className:"p-3 hover:bg-gray-200 transition-colors cursor-pointer  disabled:opacity-50 disabled:cursor-not-allowed h-[56px]",children:e.jsx(We,{className:"h-5 w-5 text-gray-600"})})]}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsxs(S,{onClick:()=>K(!1),disabled:r?r?.outOfStock||r?.quantity===0:s?.outOfStock||s?.quantity===0,className:"flex-1 bg-primary hover:bg-primary/90 text-white font-semibold py-3 text-base h-[56px] rounded-xl flex items-center justify-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),"Add to Cart"]}),e.jsx(S,{onClick:()=>{K(!0)},disabled:r?r?.outOfStock||r?.quantity===0:s?.outOfStock||s?.quantity===0,variant:"outline",className:"flex-1 border-primary text-primary hover:bg-primary/10 font-semibold py-3 text-base h-[56px] rounded-xl",children:"Buy Now"})]})]})]})]}),(L||E?.data&&E.data.length>0)&&e.jsx("div",{className:"mt-8 sm:mt-12 border-t border-gray-200 pt-6 sm:pt-8",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Related Products"})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-4 sm:gap-6",children:L?[...Array(8)].map((a,o)=>e.jsx(ns,{},`skeleton-${o}`)):E?.data?.slice(0,8).map(a=>e.jsx(Xe,{product:a,onProductClick:o=>{t(`/products/${o}`),window.scrollTo(0,0)}},a._id||a.id))})]})}),e.jsx("div",{className:"mt-8 sm:mt-12 border-t border-gray-200 pt-6 sm:pt-8",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 flex justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 ",children:"Reviews & Rating"}),e.jsx(ae,{rating:s?.rating||0,showValue:!0,totalReviews:s?.totalReviews||0})]}),e.jsx(S,{variant:"link",leftIcon:Ze,onClick:()=>{if(!n){O.error("Please login to write a review"),t("/auth/login");return}C(!0)},className:" underline text-sm sm:text-base h-[40px]",children:s?.hasUserReviewed?"Edit Review":"Write a review"})]}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:oe?[...Array(3)].map((a,o)=>e.jsx(ts,{},`skeleton-${o}`)):T.length>0?T.map(a=>e.jsx(Ke,{review:a},a.id)):e.jsx("div",{className:"text-gray-500 w-full text-center text-lg flex justify-center items-center min-h-[400px]",children:"No reviews yet!"})}),T.length>10&&e.jsx("div",{className:"mt-6 sm:mt-8 text-center",children:e.jsx(S,{variant:"outline",className:"px-6 sm:px-8 py-2 text-sm sm:text-base text-primary hover:text-primary/80 underline border-none shadow-none",children:"View all"})})]})}),e.jsx(ls,{isOpen:N,onClose:()=>{C(!1)},productId:h,existingReview:s?.userReview,onSuccess:()=>{k?.refetch(),$?.refetch()}})]})};export{ws as default};
