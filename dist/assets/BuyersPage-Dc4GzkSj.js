import{u as T,r as a,ar as g,j as r}from"./index-CUSVstqU.js";import{P as q}from"./pagination-wrapper-Caj-HnEp.js";import{u as A,a as G,b as Q,c as W,B as $,U as z}from"./BuyersPageSkeleton-9nkLXZSf.js";import{M as J}from"./MetricsGrid-BlEYQlJ2.js";import"./index-7rtZR-0h.js";import"./table-DneWR9W7.js";import"./badge-c_xwgsXg.js";import"./orderUtils-DR-jD4b-.js";import"./date-utils-CIparGJB.js";import"./EmptyState-CH6fPGhV.js";import"./buyingEmptyState-C5ryqnDV.js";import"./UserTableSkeleton-Dw2BkS24.js";import"./SearchInput-CIs23NSy.js";import"./SortDropdown-BZ2QEsue.js";import"./en-US-CPLesiGp.js";import"./isSameDay-CeY-boyx.js";import"./format-Byp0gi1d.js";import"./endOfMonth-B0jjArdg.js";import"./arrow-up-down-BPvpXmMH.js";import"./ellipsis-vertical-CPx5VAQW.js";import"./trash-2-BLdsFbCa.js";const K=[{id:"total",title:"Total Buyers",value:"0",color:"bg-[#269210]",icon:g,bgColor:"bg-white/20"},{id:"pending",title:"Pending Buyers",value:"0",color:"bg-[#e68814]",icon:g,bgColor:"bg-white/20"},{id:"active",title:"Active Buyers",value:"0",color:"bg-[#2b5aac]",icon:g,bgColor:"bg-white/20"},{id:"inactive",title:"Inactive Buyers",value:"0",color:"bg-gray-500",icon:g,bgColor:"bg-white/20"}],fe=()=>{const U=T(),[l,u]=a.useState(1),[d]=a.useState(10),[n,x]=a.useState(""),[o,P]=a.useState("recent"),[i,y]=a.useState(""),[c,v]=a.useState({}),[w,k]=a.useState(K),C=a.useMemo(()=>{const e={page:l,limit:d,role:"buyer"};if(n&&(e.search=n),i&&(e.status=i.toLowerCase()),o==="custom"&&c.from&&c.to){const t=new Date(c.from);t.setHours(0,0,0,0);const s=new Date(c.to);s.setHours(23,59,59,999),e.startDate=t.toISOString(),e.endDate=s.toISOString()}else if(o!=="recent"){const t=new Date;t.setHours(23,59,59,999);let s=new Date;switch(o){case"this-week":s.setDate(t.getDate()-7);break;case"this-month":s.setMonth(t.getMonth()-1);break;case"last-3-months":s.setMonth(t.getMonth()-3);break;case"last-6-months":s.setMonth(t.getMonth()-6);break}s.setHours(0,0,0,0),o!=="recent"&&(e.startDate=s.toISOString(),e.endDate=t.toISOString())}return e},[l,d,n,i,o,c]),{data:m,isLoading:p,isError:M,error:j}=A(C),b=G(),f=Q(),S=W(),B=e=>{U(`/view-buyer/${e}`)},V=e=>{u(e)},E=e=>{x(e),u(1)},I=(e,t)=>{P(e),t&&v(t),u(1)},N=e=>{y(e.status||""),u(1)},F=e=>{b.mutate(e)},H=e=>{f.mutate(e)},O=e=>{S.mutate(e)};if(M)return r.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-center",children:[r.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Error loading users"}),r.jsx("p",{className:"text-gray-600 text-sm",children:j?.response?.data?.message||"Failed to fetch users. Please try again."})]});const L=m?.users||[],h=m?.stats;a.useEffect(()=>{h&&k(e=>e.map(t=>{const s=h[t.id],R=s!==void 0?s.toString():t.value;return{...t,value:R}}))},[h]);const D=m?.pagination?.totalPages||1;return p&&!n&&!i&&o==="recent"&&l===1?r.jsx($,{}):r.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[r.jsx(J,{metrics:w}),r.jsx(z,{users:L,onViewDetails:B,onBlock:F,onUnblock:H,onDelete:O,title:"Buyers",searchValue:n,onSearchChange:E,selectedSort:o,onSortChange:I,filters:{status:i},onFilterChange:N,isLoading:p,actionLoading:b.isPending||f.isPending||S.isPending}),D>1&&r.jsx(q,{currentPage:l,totalPages:D,onPageChange:V})]})};export{fe as default};
