import{r as z,j as e,C as I,X as U,f as b,ax as he,L as K,aN as ae,B as M,ai as re,aZ as Z,ap as ue,z as C,a$ as ge,b0 as be,b1 as le,b2 as ye,b3 as je}from"./index-BiCr9dd_.js";import{F}from"./FormSelect-B-UjWW9p.js";import{P as ve}from"./PickupHoursSelector-CukVc2JL.js";import{g as H}from"./colorUtils-Cg0F6a_m.js";import{U as X}from"./upload-BsZw_j0x.js";import{T as Ne}from"./trash-2-BSx2CMeK.js";import{B}from"./badge-gylWw4eT.js";const Fe=({methods:s,uploadedPhotos:h,existingImages:m=[],removeExistingImage:j,imageError:N,setImageError:u,addressOptions:k=[],showAddAddressModal:S,setShowAddAddressModal:_,variants:y,showVariants:O,handleDrag:$,handleDrop:v,handleFileChange:W,removePhoto:G,addVariant:n,removeVariant:i,handleVariantImageUpload:d,removeVariantImage:L,removeExistingVariantImage:Y,handleVariantDrag:P,handleVariantDrop:J,dragActive:V,variantDragActive:ee,MAX_IMAGES:se,categoryOptions:ie,subCategoryOptions:ce,tagOptions:ne,isLoading:T=!1})=>{const{watch:oe,setValue:f,clearErrors:q,formState:{errors:w},trigger:de}=s,o=oe(),[R,te]=z.useState(1),[A,Q]=z.useState(null),me=async()=>{if(m.length+h.length<2)return u(!0),C.error("Please upload at least 2 product images"),!1;u(!1);const r=["title","price","description","category","subCategory","quantity","brand","color","locationIds","availabilityRadius","productTag"];o.discount?.discountType&&o.discount.discountType!=="none"&&r.push("discount.discountValue"),y&&y.length>0&&y.forEach((c,a)=>{r.push(`variants.${a}.color`),r.push(`variants.${a}.quantity`),r.push(`variants.${a}.price`);const g=o.variants?.[a]?.discount;g?.discountType&&g.discountType!=="none"&&r.push(`variants.${a}.discount.discountValue`)});const t=await de(r);if(!t){const c=w.discount;if(c?.discountValue)return C.error(`Discount: ${c.discountValue.message}`),!1;const a=w.variants;if(y.some((p,x)=>a?.[x]?.color||a?.[x]?.quantity||a?.[x]?.price||a?.[x]?.discount?.discountValue)){const p=y.findIndex((x,D)=>a?.[D]?.color||a?.[D]?.quantity||a?.[D]?.price||a?.[D]?.discount?.discountValue);if(p!==-1){const x=a?.[p];x?.color?C.error(`Variant ${p+1}: ${x.color.message}`):x?.quantity?C.error(`Variant ${p+1}: ${x.quantity.message}`):x?.price?C.error(`Variant ${p+1}: ${x.price.message}`):x?.discount?.discountValue&&C.error(`Variant ${p+1}: ${x.discount.discountValue.message}`)}}else{const p=r.find(x=>x.startsWith("variants.")?!1:w[x]);if(p&&w[p]){const x=w[p]?.message;x&&C.error(x)}}}return t},pe=async()=>{await me()&&(te(2),window.scrollTo({top:0,behavior:"smooth"}))},xe=()=>{te(1),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("div",{className:"w-full h-full ",children:[e.jsxs(I,{className:"p-0 bg-white rounded-xl shadow-sm border-gray-200 h-full flex flex-col ",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 p-4 sm:p-6",children:[R===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Product Details"}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",id:"photos",children:e.jsxs("h3",{className:`text-sm font-medium ${N?"text-red-600":"text-gray-900"}`,children:["Photos · ",m.length+h.length,"/",se," - Minimum 2, maximum ",se," photos required.",e.jsx("span",{className:"text-red-500",children:"*"})]})}),m.length===0&&h.length===0?e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-6 text-center ${N?"bg-red-50":"bg-gray-50"} ${V?"border-primary bg-blue-50":N?"border-red-300":"border-gray-300"}`,onDragEnter:$,onDragLeave:$,onDragOver:$,onDrop:v,children:[e.jsx("input",{type:"file",id:"photo-upload",className:"hidden",multiple:!0,accept:"image/*",onChange:W}),e.jsxs("label",{htmlFor:"photo-upload",className:"cursor-pointer inline-flex flex-col items-center",children:[e.jsx(X,{className:"h-10 w-10 text-gray-400 mb-3"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]}),e.jsx("span",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 text-center bg-gray-50 ${V?"border-primary bg-blue-50":"border-gray-300"}`,onDragEnter:$,onDragLeave:$,onDragOver:$,onDrop:v,children:[e.jsx("input",{type:"file",id:"photo-upload-more",className:"hidden",multiple:!0,accept:"image/*",onChange:W}),e.jsxs("label",{htmlFor:"photo-upload-more",className:"cursor-pointer inline-flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]})]}),e.jsx("div",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]}),e.jsxs("div",{className:"grid grid-cols-3 lg:grid-cols-5 gap-2",children:[m.map((l,r)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:l,alt:`Existing ${r+1}`,className:"w-full h-20 sm:h-24 md:h-28 lg:h-16 object-cover rounded-sm"}),j&&e.jsx("button",{type:"button",onClick:()=>j(r),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(U,{className:"h-3 w-3"})})]},`existing-${r}`)),h.map((l,r)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:URL.createObjectURL(l),alt:`Upload ${r+1}`,className:"w-full h-20 sm:h-24 md:h-28 lg:h-16 object-cover rounded-sm"}),e.jsx("button",{type:"button",onClick:()=>G(r),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(U,{className:"h-3 w-3"})})]},`upload-${r}`))]})]}),N&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:"At least 2 images are required"})]}),e.jsx("div",{className:"",children:e.jsx(b,{name:"title",label:"Title",placeholder:"Primed MDF 3.25″ Casing, 7′ x 1/2",className:"border-gray-300 h-[53px] "})}),e.jsx("div",{children:e.jsx(b,{name:"price",label:"Price ($ sq ft) ",placeholder:"$0.00 / sq ft",type:"text",className:"border-gray-300 h-[53px]",onInput:l=>{const r=l.currentTarget,c=r.value.replace(/[^0-9.]/g,""),a=c.split(".");a.length>2?r.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?r.value=a[0]+"."+a[1].substring(0,2):r.value=c}})}),e.jsx("div",{children:e.jsx(he,{name:"description",label:"Description",placeholder:"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",rows:3,className:"border-gray-300 resize-none rounded-sm"})}),e.jsx("div",{children:e.jsx(F,{name:"category",label:"Category",placeholder:"Select Category",options:ie,className:"h-[53px]"})}),e.jsxs("div",{children:[e.jsx(F,{name:"subCategory",label:"Sub Category",placeholder:o.category?"Select Sub Category":"Select category first",options:ce,className:"h-[53px]",disabled:!o.category,creatable:!0,searchable:!0,createPlaceholder:'Add "{search}" as custom subcategory'}),!o.category&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Please select a category first"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{htmlFor:"outOfStock",className:"text-sm text-gray-600",children:"Out of Stock"}),e.jsx(ae,{id:"outOfStock",className:"h-6 w-12",checked:o.outOfStock||!1,onCheckedChange:l=>{f("outOfStock",l),o?.quantity===""&&(f("quantity","0"),q("quantity"))}})]})]}),e.jsx(b,{name:"quantity",label:"",placeholder:"2",type:"number",className:"border-gray-300 h-[53px]",min:"0",step:"1",disabled:o.outOfStock,onInput:l=>{const r=l.currentTarget,t=r.value.replace(/[^0-9]/g,"");t==="0"?r.value="0":r.value=t.replace(/^0+/,"")||""},onKeyDown:l=>{[".","-","+","e","E"].includes(l.key)&&l.preventDefault()}})]}),e.jsx("div",{children:e.jsx(b,{name:"brand",label:"Brand",placeholder:"Styling",className:"border-gray-300 h-[53px]"})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(b,{name:"color",label:"Color (HEX)",type:"text",placeholder:"#FF0000",className:"flex-1 h-[53px]",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",maxLength:7,onInput:l=>{const r=l.currentTarget;let t=r.value.toUpperCase();t.length===1&&t!=="#"&&/[A-Fa-f0-9]/.test(t)&&(t="#"+t),t=t.replace(/[^#A-Fa-f0-9]/g,""),t.indexOf("#")>0&&(t="#"+t.replace(/#/g,"")),r.value=t,q("color")}}),e.jsx("input",{type:"color",value:o.color||"#000000",onChange:l=>f("color",l.target.value),className:`w-[53px] h-[53px] ${w.color?"mt-0":"mt-5"} rounded border border-gray-300 cursor-pointer flex-shrink-0`})]}),o.color&&o.color.length>=4&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 ml-1 capitalize",children:["Color: ",H(o.color).name]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Locations"}),e.jsxs(M,{type:"button",onClick:()=>{_&&_(!0)},variant:"outline",className:"flex items-center gap-2 text-sm h-[48px] border border-primary text-primary hover:text-primary hover:bg-primary/10",children:[e.jsx(re,{className:"h-4 w-4"}),"Add Location"]})]}),e.jsx(F,{name:"locationIds",label:"",placeholder:"Select locations for this product",options:k,multiple:!0,searchable:!0,searchPlaceholder:"Search locations...",className:"border-gray-300"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Product Dimensions (Optional)"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[e.jsx(b,{name:"dimensions.width",label:"Width (inches)",placeholder:"24",type:"text",className:"border-gray-300 h-[53px]",onInput:l=>{const r=l.currentTarget,c=r.value.replace(/[^0-9.]/g,""),a=c.split(".");a.length>2?r.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?r.value=a[0]+"."+a[1].substring(0,2):r.value=c}}),e.jsx(b,{name:"dimensions.length",label:"Length (inches)",placeholder:"36",type:"text",className:"border-gray-300 h-[53px]",onInput:l=>{const r=l.currentTarget,c=r.value.replace(/[^0-9.]/g,""),a=c.split(".");a.length>2?r.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?r.value=a[0]+"."+a[1].substring(0,2):r.value=c}}),e.jsx(b,{name:"dimensions.height",label:"Height (inches)",placeholder:"30",type:"text",className:"border-gray-300 h-[53px]",onInput:l=>{const r=l.currentTarget,c=r.value.replace(/[^0-9.]/g,""),a=c.split(".");a.length>2?r.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?r.value=a[0]+"."+a[1].substring(0,2):r.value=c}})]})]}),e.jsx("div",{children:e.jsx(F,{name:"productTag",label:"Product Tag",placeholder:"Select or create tags",options:ne,multiple:!0,searchable:!0,creatable:!0,className:"h-[53px]",createPlaceholder:'Add "{search}" as a new tag',searchPlaceholder:"Type to search or create tags...",maxSelections:10})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{name:"discount.discountType",label:"Discount Type",placeholder:"Select Discount Type",options:[{value:"none",label:"No Discount"},{value:"flat",label:"Flat Amount"},{value:"percentage",label:"Percentage"}],className:"text-sm h-[53px]"}),o.discount?.discountType&&o.discount?.discountType!=="none"&&e.jsx(b,{name:"discount.discountValue",label:"Discount Value",placeholder:o.discount.discountType==="percentage"?"10%":"10.00",className:"text-sm h-[53px]",type:"text",min:"0",onInput:l=>{const r=l.currentTarget,t=r.value,c=o.discount.discountType==="percentage";let a=t.replace(/[^0-9.]/g,"");a=a.replace(/^-/,"");const g=a.split(".");if(g.length>2&&(a=g[0]+"."+g.slice(1).join("")),g.length===2&&g[1].length>2&&(a=g[0]+"."+g[1].substring(0,2)),c){const p=parseFloat(a);!isNaN(p)&&p>100&&(a="100")}r.value=a},onKeyDown:l=>{l.key==="-"&&l.preventDefault()}})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-base font-medium text-gray-900",children:["Product Variants",e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",y.length,"/5)"]})]}),e.jsxs(M,{type:"button",onClick:n,variant:"outline",className:"flex items-center gap-2 text-sm h-[48px] border border-primary text-primary hover:text-primary hover:bg-primary/10",disabled:y.length>=5,children:[e.jsx(re,{className:"h-4 w-4"}),"Add Variant"]})]}),O&&y.length>0&&e.jsx("div",{className:"space-y-4",children:y.map((l,r)=>e.jsxs(I,{className:"p-4 border-2 border-gray-200 shadow-md gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between h-10",children:[e.jsxs("h4",{className:"font-medium text-sm",children:["Variant ",r+1]}),e.jsx(M,{type:"button",onClick:()=>Q(l.id),variant:"ghost",className:"text-red-500 hover:text-red-700 p-1 h-10",children:e.jsx(Ne,{className:"h-4 w-4"})})]}),e.jsx("hr",{className:"my-0 py-0 text-gray-200"}),e.jsxs("div",{className:"my-3",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-2 block",children:"Variant Images (Max 5)"}),l.images.length===0&&(!l.existingImages||l.existingImages.length===0)?e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-4 text-center bg-gray-50 ${ee===l.id?"border-primary bg-blue-50":"border-gray-300"}`,onDragEnter:t=>{t.preventDefault(),t.stopPropagation(),P(t,l.id)},onDragLeave:t=>{t.preventDefault(),t.stopPropagation(),P(t,l.id)},onDragOver:t=>{t.preventDefault(),t.stopPropagation(),P(t,l.id)},onDrop:t=>{t.preventDefault(),t.stopPropagation(),J(t,l.id)},children:[e.jsx("input",{type:"file",id:`variant-photo-upload-${l.id}`,className:"hidden",multiple:!0,accept:"image/*",onChange:t=>{if(t.target.files){const c=Array.from(t.target.files);d(l.id,c)}t.target.value=""}}),e.jsxs("label",{htmlFor:`variant-photo-upload-${l.id}`,className:"cursor-pointer inline-flex flex-col items-center",children:[e.jsx(X,{className:"h-8 w-8 text-gray-400 mb-2"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]}),e.jsx("span",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-3 text-center bg-gray-50 ${ee===l.id?"border-primary bg-blue-50":"border-gray-300"}`,onDragEnter:t=>{t.preventDefault(),t.stopPropagation(),P(t,l.id)},onDragLeave:t=>{t.preventDefault(),t.stopPropagation(),P(t,l.id)},onDragOver:t=>{t.preventDefault(),t.stopPropagation(),P(t,l.id)},onDrop:t=>{t.preventDefault(),t.stopPropagation(),J(t,l.id)},children:[e.jsx("input",{type:"file",id:`variant-photo-upload-more-${l.id}`,className:"hidden",multiple:!0,accept:"image/*",onChange:t=>{if(t.target.files){const c=Array.from(t.target.files);d(l.id,c)}t.target.value=""}}),e.jsxs("label",{htmlFor:`variant-photo-upload-more-${l.id}`,className:"cursor-pointer inline-flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]})]}),e.jsx("div",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]}),e.jsxs("div",{className:"grid grid-cols-3 lg:grid-cols-5 gap-2",children:[l.existingImages?.map((t,c)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:t,alt:`Variant ${r+1} Existing ${c+1}`,className:"w-full sm:h-24 md:h-28  h-20 lg:h-16 object-cover rounded-sm"}),Y&&e.jsx("button",{type:"button",onClick:()=>Y(l.id,c),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(U,{className:"h-3 w-3"})})]},`existing-${c}`)),l.images.map((t,c)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:URL.createObjectURL(t),alt:`Variant ${r+1} Image ${c+1}`,className:"w-full sm:h-24 md:h-28  h-20 lg:h-16 object-cover rounded-sm"}),e.jsx("button",{type:"button",onClick:()=>L(l.id,c),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(U,{className:"h-3 w-3"})})]},c))]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{name:`variants.${r}.color`,label:"Color (HEX)",type:"text",placeholder:"#FF0000",className:"flex-1 h-[53px]",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",maxLength:7,onInput:t=>{const c=t.currentTarget;let a=c.value.toUpperCase();a.length===1&&a!=="#"&&/[A-Fa-f0-9]/.test(a)&&(a="#"+a),a=a.replace(/[^#A-Fa-f0-9]/g,""),a.indexOf("#")>0&&(a="#"+a.replace(/#/g,"")),c.value=a}}),e.jsx("input",{type:"color",value:o.variants?.[r]?.color||"#000000",onChange:t=>f(`variants.${r}.color`,t.target.value),className:"w-[53px] h-[53px] mt-5 rounded border border-gray-300 cursor-pointer flex-shrink-0"})]}),o.variants?.[r]?.color&&o.variants[r].color.length>=4&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 ml-1 capitalize",children:["Color: ",H(o.variants[r].color).name]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{htmlFor:`variant-out-of-stock-${r}`,className:"text-xs text-gray-600",children:"Out of Stock"}),e.jsx(ae,{id:`variant-out-of-stock-${r}`,className:"h-6 w-12",checked:o.variants?.[r]?.outOfStock||!1,onCheckedChange:t=>{f(`variants.${r}.outOfStock`,t),o.variants?.[r]?.quantity===""&&(f(`variants.${r}.quantity`,"0"),q(`variants.${r}.quantity`))}})]})]}),e.jsx(b,{name:`variants.${r}.quantity`,label:"",placeholder:"10",type:"number",className:"text-sm",min:"0",step:"1",disabled:o.variants?.[r]?.outOfStock,onInput:t=>{const c=t.currentTarget,a=c.value.replace(/[^0-9]/g,"");a==="0"?c.value="0":c.value=a.replace(/^0+/,"")||""},onKeyDown:t=>{[".","-","+","e","E"].includes(t.key)&&t.preventDefault()}})]}),e.jsx("div",{children:e.jsx(b,{name:`variants.${r}.price`,label:"Price ($ sq ft)",placeholder:"$0.00 / sq ft",type:"text",className:"text-sm",onInput:t=>{const c=t.currentTarget,g=c.value.replace(/[^0-9.]/g,""),p=g.split(".");p.length>2?c.value=p[0]+"."+p.slice(1).join(""):p.length===2&&p[1].length>2?c.value=p[0]+"."+p[1].substring(0,2):c.value=g}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{name:`variants.${r}.discount.discountType`,label:"Discount Type",placeholder:"Select Discount Type",options:[{value:"none",label:"No Discount"},{value:"flat",label:"Flat Amount"},{value:"percentage",label:"Percentage"}],className:"text-sm h-[53px]"}),o.variants?.[r]?.discount?.discountType!=="none"&&e.jsx(b,{name:`variants.${r}.discount.discountValue`,label:"",placeholder:o.variants?.[r]?.discount?.discountType==="percentage"?"10%":"10.00",className:"text-sm h-[53px]",type:"text",min:"0",onInput:t=>{const c=t.currentTarget,a=c.value,g=o.variants?.[r]?.discount?.discountType==="percentage";let p=a.replace(/[^0-9.]/g,"");p=p.replace(/^-/,"");const x=p.split(".");if(x.length>2&&(p=x[0]+"."+x.slice(1).join("")),x.length===2&&x[1].length>2&&(p=x[0]+"."+x[1].substring(0,2)),g){const D=parseFloat(p);!isNaN(D)&&D>100&&(p="100")}c.value=p},onKeyDown:t=>{t.key==="-"&&t.preventDefault()}})]})]})]},l.id))}),!O&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Add variants to offer different options like colors, sizes, or styles for your product."})]})]}),R===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Marketplace"}),e.jsxs("div",{className:"sm:space-y-2 flex flex-row sm:flex-col gap-2 items-center sm:items-start ",children:[e.jsxs("label",{htmlFor:"pickup",className:"flex items-center space-x-3 p-2 m-0 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(Z,{id:"pickup",checked:o.marketplaceOptions?.pickup||!1,disabled:T,onCheckedChange:l=>{f("marketplaceOptions",{...o.marketplaceOptions,pickup:l}),q("marketplaceOptions")},className:"h-5 w-5 border-gray-300"}),e.jsx("span",{className:"text-sm font-medium leading-none",children:"Pickup"})]}),e.jsxs("label",{htmlFor:"shipping",className:"flex items-center space-x-3 p-2 m-0 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(Z,{id:"shipping",checked:o.marketplaceOptions?.shipping||!1,disabled:T,onCheckedChange:l=>{f("marketplaceOptions",{...o.marketplaceOptions,shipping:l}),q("marketplaceOptions")},className:"h-5 w-5 border-gray-300"}),e.jsx("span",{className:"text-sm font-medium leading-none",children:"Shipping"})]}),e.jsxs("label",{htmlFor:"delivery",className:"flex items-center space-x-3 p-2 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(Z,{id:"delivery",checked:o.marketplaceOptions?.delivery||!1,disabled:T,onCheckedChange:l=>{f("marketplaceOptions",{...o.marketplaceOptions,delivery:l}),q("marketplaceOptions")},className:"h-5 w-5 border-gray-300"}),e.jsx("span",{className:"text-sm font-medium leading-none",children:"Delivery"})]})]}),w.marketplaceOptions&&e.jsx("p",{className:"text-red-500",children:typeof w.marketplaceOptions=="object"&&"message"in w.marketplaceOptions?w.marketplaceOptions.message:"At least one marketplace option is required"})]}),o.marketplaceOptions?.pickup&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"border-gray-200 my-4"}),e.jsxs("div",{className:"mb-4 mt-2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",children:"Pickup Hours"}),e.jsx(ve,{value:o.pickupHours,onChange:l=>f("pickupHours",l)})]})]}),o.marketplaceOptions?.shipping&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"border-gray-200 my-4"}),e.jsx("div",{className:"mb-4",children:e.jsx(b,{disabled:T,name:"shippingPrice",label:"Shipping Price ($)",placeholder:"$10.00",type:"text",className:"border-gray-300 h-[53px]",onInput:l=>{const r=l.currentTarget,c=r.value.replace(/[^0-9.]/g,""),a=c.split(".");a.length>2?r.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?r.value=a[0]+"."+a[1].substring(0,2):r.value=c}})})]}),e.jsx("hr",{className:"border-gray-200 my-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Ready By"}),e.jsx("div",{children:e.jsx(F,{disabled:T,name:"readyByDays",label:"Ready By Days",placeholder:"Select days",options:Array.from({length:61},(l,r)=>({value:r.toString(),label:r===0?"Ready Today":r===1?"1 Day":`${r} Days`})),className:"border-gray-300 h-[53px]"})})]})]})]}),e.jsxs("div",{className:"pt-4 space-y-4 flex-shrink-0 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:`h-1 flex-1 ${R>=1?"bg-primary":"bg-gray-200"} rounded-full`}),e.jsx("div",{className:`h-1 flex-1 ${R>=2?"bg-primary":"bg-gray-200"} rounded-full`})]}),R===1?e.jsx(M,{type:"button",onClick:pe,className:"w-full bg-gray-200 h-[48px] hover:bg-gray-300 text-gray-700 font-medium py-3 rounded-lg",children:"Next"}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(M,{type:"button",disabled:T,onClick:xe,className:"bg-gray-200 h-[48px] hover:bg-gray-300 text-gray-700 font-medium py-3 rounded-lg",children:"Back"}),e.jsx(M,{disabled:T,type:"submit",className:"bg-primary h-[48px] hover:bg-primary/80 text-white font-medium py-3 rounded-lg",children:T?"Publishing...":"Publish"})]})]})]}),e.jsx(ue,{isOpen:!!A,onClose:()=>Q(null),onConfirm:()=>{A&&(i(A),Q(null))},title:"Delete Variant?",description:`Are you sure you want to delete Variant ${A?y.findIndex(l=>l.id===A)+1:""}? This action cannot be undone.`,confirmText:"Delete Variant",cancelText:"Cancel"})]})},Se=({formValues:s,uploadedPhotos:h,existingImages:m=[],addressOptions:j=[],savedAddresses:N=[],variants:u,categoryOptions:k,subCategoryOptions:S,tagOptions:_,handleBackClick:y})=>{const[O,$]=z.useState(0),[v,W]=z.useState();z.useEffect(()=>{v&&v.on("select",()=>{$(v.selectedScrollSnap())})},[v]);const G=s.discount?.discountType==="percentage"&&s.discount?.discountValue?(parseFloat(s.price)*(1-parseFloat(s.discount.discountValue)/100)).toFixed(2):s.discount?.discountType==="flat"&&s.discount?.discountValue?(parseFloat(s.price)-parseFloat(s.discount.discountValue)).toFixed(2):s.price;return e.jsx("div",{className:"w-full lg:flex-1 h-full ",children:e.jsxs(I,{className:"p-4 sm:p-6 border-gray-200 h-full flex flex-col rounded-none border-none lg:border lg:rounded-sm ",children:[e.jsxs("div",{className:"flex  justify-between items-center gap-2 border-b border-gray-200 pb-4 ",children:[e.jsxs("div",{className:"",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Preview"}),e.jsx("p",{className:"text-sm text-gray-500",children:"See how your listing will appear"})]}),y&&e.jsx("button",{type:"button",onClick:y,className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(U,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-4 lg:gap-0 lg:flex-row rounded-lg overflow-hidden min-h-0",children:[e.jsx("div",{className:"w-full  lg:w-3/5  lg:h-full rounded-sm overflow-hidden  lg:rounded-e-none",children:m.length+h.length>=2?e.jsxs(ge,{setApi:W,className:" min-h-[300px] min-w-[300px] rounded-sm w-full  flex-col lg:flex-row  lg:rounded-e-none lg:h-full bg-[#A9A9A9]   lg:rounded-l-lg  lg:py-20 lg:px-12 relative flex items-center ",children:[e.jsxs(be,{children:[m.map((n,i)=>e.jsx(le,{children:e.jsx("div",{className:"aspect-square relative  overflow-hidden border rounded-sm border-gray-400 shadow-2xl",children:e.jsx("img",{src:n,alt:`Product ${i+1}`,className:"w-full h-full object-cover "})})},`existing-${i}`)),h.map((n,i)=>e.jsx(le,{children:e.jsx("div",{className:"aspect-square relative  overflow-hidden border rounded-sm border-gray-400 shadow-2xl",children:e.jsx("img",{src:URL.createObjectURL(n),alt:`Product ${m.length+i+1}`,className:"w-full h-full object-cover"})})},`upload-${i}`))]}),m.length+h.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"left-0 lg:left-[49px] bg-white shadow-md border-none hover:bg-gray-50 h-12 sm:h-16 md:h-20 rounded-l-sm"}),e.jsx(je,{className:"right-0 lg:right-[49px] bg-white border-none shadow-md hover:bg-gray-50 h-12 sm:h-16 md:h-20 rounded-r-sm"})]}),e.jsx("div",{className:"hidden sm:flex absolute   bottom-10 md:bottom-20 justify-center items-center text-white z-10 left-0 flex gap-2 w-full px-2",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 m-0 overflow-x-auto max-w-full",children:[m.map((n,i)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(i),children:e.jsx("img",{src:n,alt:`Product ${i+1}`,className:`${i===O?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`existing-thumb-${i}`)),h.map((n,i)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(m.length+i),children:e.jsx("img",{src:URL.createObjectURL(n),alt:`Product ${m.length+i+1}`,className:`${m.length+i===O?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`upload-thumb-${i}`))]})})]}):e.jsx("div",{className:"h-full bg-gray-100 rounded-t-lg sm:rounded-t-none sm:rounded-l-lg flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-600",children:"Your listing Preview"}),e.jsx("p",{className:"text-sm sm:text-base mt-4 text-red-500 font-medium",children:"Minimum 2 images required for preview"}),m.length+h.length===1&&e.jsxs("p",{className:"text-xs sm:text-sm mt-2 text-gray-500",children:["Please add ",2-(m.length+h.length)," more image(s) to see the preview"]}),m.length+h.length===0&&e.jsx("p",{className:"text-xs sm:text-sm mt-2 text-gray-500",children:"Please add at least 2 images to see how your listing will appear"})]})})}),e.jsx("div",{className:" sm:hidden justify-center items-center  flex gap-2 w-full px-2",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 m-0 overflow-x-auto max-w-full",children:[m.map((n,i)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(i),children:e.jsx("img",{src:n,alt:`Product ${i+1}`,className:`${i===O?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`existing-thumb-${i}`)),h.map((n,i)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(m.length+i),children:e.jsx("img",{src:URL.createObjectURL(n),alt:`Product ${m.length+i+1}`,className:`${m.length+i===O?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`upload-thumb-${i}`))]})}),e.jsxs("div",{className:"w-full lg:w-2/5 p-3 sm:p-4 md:p-6 border border-gray-200 rounded-sm lg:rounded-l-none lg:rounded-r-lg lg:overflow-y-auto min-h-0",children:[e.jsxs("div",{className:"pb-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 mb-2",children:s.title||"Product Title"}),e.jsxs("div",{className:"flex  items-baseline gap-2",children:[e.jsx("div",{className:"text-xl font-medium text-gray-900 max-content",children:s.discount?.discountType!=="none"&&s.discount?.discountValue?e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["$",s.price]}),e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",G||"0.00"]}),e.jsx(B,{variant:"destructive",className:"text-xs bg-primary text-white",children:s.discount.discountType==="percentage"?`${s.discount.discountValue}% OFF`:`$${s.discount.discountValue} OFF`})]}):e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",s.price||"0.00"]})}),s.category&&e.jsxs("div",{className:"text-gray-600",children:["/"," ",k.find(n=>n.value===s.category)?.label||s.category]}),s.discount?.discountType!=="none"&&s.discount?.discountValue&&e.jsx(B,{variant:"destructive",className:"text-xs ml-2",children:s.discount.discountType==="percentage"?`${s.discount.discountValue}% OFF`:`$${s.discount.discountValue} OFF`})]})]}),s.subCategory&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Sub Category"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:S.find(n=>n.value===s.subCategory)?.label||s.subCategory})]}),(s.quantity||s.outOfStock)&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Quantity"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:s.outOfStock?e.jsx(B,{variant:"destructive",className:"bg-red-500 text-white",children:"Out of Stock"}):s.quantity})]}),s.brand&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Brand"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:s.brand})]}),(s.color||u.length>0&&s.variants&&s.variants.some(n=>n.color))&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:["Color",u.length>0&&s.variants&&s.variants.filter(n=>n.color).length>0?"s":""]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.color&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border border-gray-300 shadow-sm",style:{backgroundColor:s.color}}),e.jsx("span",{className:"text-xs sm:text-sm md:text-base text-gray-600 capitalize",children:H(s.color).name})]}),u.length>0&&s.variants&&s.variants.filter(n=>n.color).map((n,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border border-gray-300 shadow-sm",style:{backgroundColor:n.color}}),e.jsx("span",{className:"text-xs sm:text-sm md:text-base text-gray-600 capitalize",children:H(n.color).name})]},i))]})]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Product Tag"}),s.productTag&&s.productTag.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.productTag.map((n,i)=>e.jsx(B,{variant:"secondary",className:"bg-blue-50 text-primary border border-blue-200 hover:bg-blue-100",children:typeof n=="string"?n:_.find(d=>d.value===n)?.label||n},i))}):"Tags will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Dimensions"}),s.dimensions?.width||s.dimensions?.length||s.dimensions?.height?e.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[s.dimensions.width&&`W: ${s.dimensions.width}"`,s.dimensions.width&&s.dimensions.length&&" × ",s.dimensions.length&&`L: ${s.dimensions.length}"`,s.dimensions.length&&s.dimensions.height&&" × ",s.dimensions.height&&`H: ${s.dimensions.height}"`]}):"Dimensions will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:s.locationIds.length>1?"Locations":"Location"}),s.locationIds&&s.locationIds.length>0?e.jsx("div",{className:"space-y-3",children:s.locationIds.map(n=>{const i=N.find(d=>(d.id||d._id)===n);if(!i){const d=j.find(L=>L.value===n);return e.jsx("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:e.jsx("p",{className:"font-medium",children:d?.label||n})},n)}return e.jsxs("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[e.jsx("p",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-gray-500 mt-1",children:i.formattedAddress}),s.availabilityRadius&&e.jsxs("p",{className:"text-gray-500 mt-1",children:["Delivery within ",s.availabilityRadius," km"]})]},n)})}):"Locations will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Delivery Options"}),s.marketplaceOptions?.pickup||s.marketplaceOptions?.shipping||s.marketplaceOptions?.delivery?e.jsxs("div",{className:"space-y-2",children:[s.marketplaceOptions?.pickup&&e.jsxs("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pickup"}),s.pickupHours&&e.jsxs("span",{children:[": ",s.pickupHours]})]}),s.marketplaceOptions?.shipping&&e.jsxs("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Shipping"}),s.shippingPrice&&e.jsxs("span",{children:[": $",s.shippingPrice]})]}),s.marketplaceOptions?.delivery&&e.jsx("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:e.jsx("span",{className:"font-medium",children:"Delivery Available"})})]}):"Delivery Options will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Ready By"}),s.readyByDays!==void 0||s.readyByDate||s.readyByTime?e.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[s.readyByDays!==void 0&&s.readyByDays!=="0"&&e.jsx("span",{className:"font-medium",children:s.readyByDays==="1"?"1 Day":`${s.readyByDays} Days`}),s.readyByDays==="0"&&e.jsxs("span",{className:"font-medium",children:["Ready Today",s.readyByDate||s.readyByTime]})]}):"Ready By will appear here"]}),e.jsxs("div",{className:"py-4",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Description"}),s.description?e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600 leading-relaxed whitespace-pre-line",children:s.description}):"Description will appear here"]}),u.length>0?e.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Available Variants (",u.filter((n,i)=>s.variants?.[i]?.color&&s.variants?.[i]?.price&&(s.variants?.[i]?.quantity||s.variants?.[i]?.outOfStock)).length,")"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[u.map((n,i)=>{const d=s.variants?.[i];if(!d?.color||!d?.price||!d?.quantity&&!d?.outOfStock)return null;const L=d.discount?.discountType==="percentage"&&d.discount?.discountValue?(parseFloat(d.price)*(1-parseFloat(d.discount.discountValue)/100)).toFixed(2):d.discount?.discountType==="flat"&&d.discount?.discountValue?(parseFloat(d.price)-parseFloat(d.discount.discountValue)).toFixed(2):d.price;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 bg-white h-full",children:e.jsxs("div",{className:"flex gap-3",children:[n.images.length>0&&e.jsxs("div",{className:"relative w-16 h-16 rounded overflow-hidden bg-gray-100 flex-shrink-0",children:[e.jsx("img",{src:URL.createObjectURL(n.images[0]),alt:`Variant ${i+1}`,className:"w-full h-full object-cover"}),n.images.length>1&&e.jsxs("div",{className:"absolute bottom-0 right-0 bg-black/50 text-white text-xs px-1 rounded-tl",children:["+",n.images.length-1]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-300 capitalize",style:{backgroundColor:d.color},title:H(d.color).name}),e.jsxs("span",{className:"text-sm font-medium",children:["Variant ",i+1]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:d.outOfStock?e.jsx(B,{variant:"destructive",className:"text-xs bg-red-500 text-white",children:"Out of Stock"}):`Stock: ${d.quantity} units`})]}),e.jsx("div",{className:"text-right",children:d.discount?.discountType!=="none"&&d.discount?.discountValue?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["$",d.price]}),e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",L]}),e.jsx(B,{variant:"destructive",className:"text-xs mt-1",children:d.discount.discountType==="percentage"?`${d.discount.discountValue}% OFF`:`$${d.discount.discountValue} OFF`})]}):e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",d.price]})})]})})]})},i)}),u.length>0&&!u.some((n,i)=>s.variants?.[i]?.color&&s.variants?.[i]?.price&&(s.variants?.[i]?.quantity||s.variants?.[i]?.outOfStock))&&e.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"Complete variant details to see them here"})]})]}):"Variants will appear here"]})]})]})})},E={MAX_FILE_SIZE:5*1024*1024,MIN_WIDTH:400,MIN_HEIGHT:400},fe=async s=>s.type.startsWith("image/")?s.size>E.MAX_FILE_SIZE?{valid:!1,error:`Selected image is ${(s.size/1048576).toFixed(1)}MB. Maximum size is 5MB allowed`}:new Promise(h=>{const m=new Image,j=URL.createObjectURL(s);m.onload=()=>{URL.revokeObjectURL(j),m.width<E.MIN_WIDTH||m.height<E.MIN_HEIGHT?h({valid:!1,error:`Image is ${m.width}x${m.height}px. Minimum size required is ${E.MIN_WIDTH}x${E.MIN_HEIGHT}px`}):h({valid:!0})},m.onerror=()=>{URL.revokeObjectURL(j),h({valid:!1,error:`Failed to load image "${s.name}"`})},m.src=j}):{valid:!1,error:`"${s.name}" is not an image file`},Pe=async(s,h,m=0)=>{const j=h-m,N=[],u=[];if(m>=h)return u.push(`Maximum ${h} images allowed`),{validFiles:N,errors:u};for(let k=0;k<Math.min(s.length,j);k++){const S=await fe(s[k]);S.valid?N.push(s[k]):S.error&&u.push(S.error)}return s.length>j&&u.push(`Only ${j} more image(s) can be added (max ${h} total)`),{validFiles:N,errors:u}};export{Se as P,Fe as a,Pe as v};
