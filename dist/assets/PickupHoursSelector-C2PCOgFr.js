import{ae as S,r as m,j as d,B as E}from"./index-CUSVstqU.js";const y=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],C=u=>{const[a,p]=u.split(":").map(Number),h=a>=12?"PM":"AM";return`${a===0?12:a>12?a-12:a}:${p.toString().padStart(2,"0")} ${h}`},N=u=>{const a=u.match(/(\d+):(\d+)\s*(AM|PM)/i);if(!a)return u;let[,p,h,f]=a,l=parseInt(p);return f.toUpperCase()==="PM"&&l!==12?l+=12:f.toUpperCase()==="AM"&&l===12&&(l=0),`${l.toString().padStart(2,"0")}:${h}`},k=S.memo(({day:u,hours:a,onUpdateTime:p,onUpdateClosed:h,onApplyToAll:f})=>d.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-gray-50 rounded-lg",children:[d.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[d.jsx("span",{className:"w-12 font-medium text-sm",children:u}),d.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[d.jsx("input",{type:"time",value:a.open,disabled:a.closed,onChange:l=>p(u,"open",l.target.value),onClick:l=>l.target.showPicker?.(),className:"border border-gray-300 rounded-md px-2 py-1 text-sm disabled:bg-gray-100 h-8 w-28 cursor-pointer"}),d.jsx("span",{className:"text-gray-500 text-sm",children:"to"}),d.jsx("input",{type:"time",value:a.close,min:a.open,disabled:a.closed,onChange:l=>p(u,"close",l.target.value),onClick:l=>l.target.showPicker?.(),className:"border border-gray-300 rounded-md px-2 py-1 text-sm disabled:bg-gray-100 h-8 w-28 cursor-pointer"})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[d.jsx("input",{type:"checkbox",checked:a.closed,onChange:l=>h(u,l.target.checked),className:"h-4 w-4 rounded border-gray-300"}),"Closed"]}),d.jsx(E,{type:"button",variant:"outline",size:"sm",onClick:()=>f(u),className:"!text-xs whitespace-nowrap h-7 border-primary text-primary hover:text-primary",children:"Apply to All"})]})]}));k.displayName="DayRow";const A=S.memo(({value:u,onChange:a})=>{const[p,h]=m.useState(()=>y.reduce((e,t)=>(e[t]={open:"09:00",close:"17:00",closed:!1},e),{})),[f,l]=m.useState([]),b=m.useCallback(e=>{const t={Mon:0,Monday:0,Tue:1,Tuesday:1,Wed:2,Wednesday:2,Thu:3,Thursday:3,Fri:4,Friday:4,Sat:5,Saturday:5,Sun:6,Sunday:6},o=[];if(e.includes("–")||e.includes("-")){const s=e.split(/[–-]/);if(s.length===2){const n=s[0].trim(),c=s[1].trim(),r=t[n],i=t[c];if(r!==void 0&&i!==void 0)for(let x=r;x<=i;x++)o.push(y[x])}}else{const s=e.trim(),n=t[s];n!==void 0&&o.push(y[n])}return o},[]),w=m.useCallback(e=>{try{const t={};return y.forEach(s=>{t[s]={open:"09:00",close:"17:00",closed:!1}}),e.split(",").map(s=>s.trim()).forEach(s=>{if(!s.toLowerCase().includes("holiday"))if(s.includes("Closed")){const n=s.replace("Closed","").trim();b(n).forEach(r=>{t[r]={open:"09:00",close:"17:00",closed:!0}})}else{let n=s.match(/^(.+?)\s+(\d{1,2}:\d{2}(?:\s*[AP]M)?)[–-](\d{1,2}:\d{2}(?:\s*[AP]M)?)$/i);if(n){const[,c,r,i]=n,x=b(c),g=r.includes("M")?N(r):r,D=i.includes("M")?N(i):i;x.forEach(H=>{t[H]={open:g,close:D,closed:!1}})}}}),t}catch(t){return console.error("Error parsing formatted string:",t),null}},[b]);m.useEffect(()=>{if(u)try{const e=JSON.parse(u);if(e.hours){const t={};Object.entries(e.hours).forEach(([o,s])=>{t[o]={open:s.open||"09:00",close:s.close||"17:00",closed:s.closed||!1}}),h(t)}e.holidays&&l(e.holidays)}catch{const e=w(u);e&&h(e)}},[]);const T=m.useCallback(e=>{const t={Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6,Sun:7},o=e.sort((r,i)=>t[r]-t[i]),s=[];let n=o[0],c=o[0];for(let r=1;r<o.length;r++)t[o[r]]!==t[c]+1&&(s.push(n===c?n:`${n}–${c}`),n=o[r]),c=o[r];return s.push(n===c?n:`${n}–${c}`),s.join(", ")},[]),j=m.useCallback((e,t=[])=>{const o=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],s={};o.forEach(c=>{const r=e[c];if(r.closed){const i="Closed";s[i]||(s[i]=[]),s[i].push(c)}else{const i=C(r.open),x=C(r.close),g=`${i}–${x}`;s[g]||(s[g]=[]),s[g].push(c)}});const n=Object.entries(s).map(([c,r])=>`${T(r)} ${c}`);return t.length>0&&t.some(c=>c)&&n.push(`Holidays: ${t.filter(Boolean).join(", ")}`),n.join(", ")},[T]),M=m.useCallback((e,t)=>{h(o=>({...o,[e]:{...o[e],closed:t}}))},[]),$=m.useCallback((e,t,o)=>{h(s=>{const n={...s},c=s[e];if(t==="open"&&o>=c.close){const r=new Date(`2000-01-01T${o}`);r.setHours(r.getHours()+1);const i=r.toTimeString().slice(0,5);n[e]={...c,open:o,close:i}}else{if(t==="close"&&o<=c.open)return s;n[e]={...c,[t]:o}}return n})},[]),P=m.useCallback(e=>{const t=p[e];h(y.reduce((o,s)=>(o[s]={...t},o),{}))},[p]);m.useEffect(()=>{if(!a)return;const e=setTimeout(()=>{const t=j(p,f);a(t)},500);return()=>clearTimeout(e)},[p,f]);const v=m.useMemo(()=>j(p,f)||"No pickup hours set",[p,f,j]);return d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"space-y-2",children:y.map(e=>d.jsx(k,{day:e,hours:p[e],onUpdateTime:$,onUpdateClosed:M,onApplyToAll:P},e))}),d.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[d.jsx("h3",{className:"font-medium text-sm mb-1 text-primary",children:"Preview"}),d.jsx("p",{className:"text-sm text-primary",children:v})]})]})});A.displayName="PickupHoursSelector";export{A as P};
