import{u as H,a as J,r as d,j as e,D as _,b as E,M as I,C as $,c as z,d as O,e as m,f as K}from"./index-CUSVstqU.js";import{P as X}from"./pagination-wrapper-Caj-HnEp.js";import{F as k}from"./FilterDropdown-CdlgF2Po.js";import{u as Y,a as Z}from"./useProductMutations-CP-SVJ5v.js";import{P as ee}from"./ProductCard-Bxz0lhNv.js";import{M as ae}from"./MarketPlacePageSkeleton-DWydYiJ-.js";import{E as se}from"./EmptyState-CH6fPGhV.js";import{P as te}from"./productEmptyState-B0Qq07aF.js";import{C as le}from"./circle-alert-CpzCXbnG.js";import"./index-BdQq_4o_.js";import"./badge-c_xwgsXg.js";import"./LazyImage-D5w62-6q.js";import"./useWishlist-DogIdL_T.js";const fe=()=>{const U=H(),n=J(),[w,x]=d.useState(1),[h,g]=d.useState({sorting:"ascending"}),[i,p]=d.useState("all"),[u,N]=d.useState({popularity:[{id:"best-selling",label:"Best-Selling Products",checked:!1},{id:"most-viewed",label:"Most Viewed",checked:!1},{id:"top-rated",label:"Top-Rated",checked:!1},{id:"most-reviewed",label:"Most Reviewed",checked:!1},{id:"featured",label:"Featured Products",checked:!1},{id:"trending",label:"Trending Now",checked:!1}],newest:[{id:"recently-updated",label:"Recently Updated",checked:!1},{id:"featured-new",label:"Featured New Products",checked:!1},{id:"sort-by-date",label:"Sort by Date Added",checked:!1},{id:"new-arrivals",label:"New Arrivals",checked:!1}],availability:[{id:"delivery",label:"Delivery",checked:!1},{id:"shipping",label:"Shipping",checked:!1},{id:"pickup",label:"Pickup",checked:!1}],readyTime:[{id:"next-day",label:"Ready Next Day",checked:!1},{id:"this-week",label:"Ready This Week",checked:!1}],sorting:"ascending",pricing:"",priceRange:[]}),[y,P]=d.useState({isOpen:!1,productId:"",productTitle:""}),W=10;d.useEffect(()=>{const a=new URLSearchParams(n.search),s=a.get("category"),c=a.get("subCategory");g(l=>({...l,category:s!=="All"?s:void 0,subCategory:c||void 0}))},[n.search]);const{data:v,isLoading:B,isError:V,refetch:C}=Y({page:w,limit:W,location:i==="all"?void 0:i,...h}),F=Z(),f=a=>{N(a);const s={},c=new URLSearchParams(n.search),l=c.get("category"),S=c.get("subCategory");l&&l!=="All"&&(s.category=l),S&&(s.subCategory=S);const M=a.popularity.filter(t=>t.checked).map(t=>t.id);M.length>0&&(s.popularity=M);const T=a.newest.filter(t=>t.checked).map(t=>t.id);T.length>0&&(s.newest=T);const R=a.availability.filter(t=>t.checked).map(t=>t.id);R.length>0&&(s.availability=R);const L=a.readyTime.filter(t=>t.checked).map(t=>t.id);L.length>0&&(s.readyTime=L),a.sorting!=="ascending"&&(s.sorting=a.sorting),a.pricing!=="custom"&&a.pricing!==""?s.pricing=a.pricing:a.priceRange&&a.pricing!==""&&(s.pricing="custom",s.priceRange=a.priceRange.join(",")),g(s),x(1)},b=()=>{const a=new URLSearchParams(n.search),s=a.get("category"),c=a.get("subCategory"),l={};s&&s!=="All"&&(l.category=s),c&&(l.subCategory=c),g(l),x(1),N({popularity:[{id:"best-selling",label:"Best-Selling Products",checked:!1},{id:"most-viewed",label:"Most Viewed",checked:!1},{id:"top-rated",label:"Top-Rated",checked:!1},{id:"most-reviewed",label:"Most Reviewed",checked:!1},{id:"featured",label:"Featured Products",checked:!1},{id:"trending",label:"Trending Now",checked:!1}],newest:[{id:"recently-updated",label:"Recently Updated",checked:!1},{id:"featured-new",label:"Featured New Products",checked:!1},{id:"sort-by-date",label:"Sort by Date Added",checked:!1},{id:"new-arrivals",label:"New Arrivals",checked:!1}],availability:[{id:"delivery",label:"Delivery",checked:!1},{id:"shipping",label:"Shipping",checked:!1},{id:"pickup",label:"Pickup",checked:!1}],readyTime:[{id:"next-day",label:"Ready Next Day",checked:!1},{id:"this-week",label:"Ready This Week",checked:!1}],sorting:"ascending",pricing:"",priceRange:[]})},Q=(a,s)=>{U(`/products/${a}`)},q=async()=>{try{await F.mutateAsync(y.productId),P({isOpen:!1,productId:"",productTitle:""}),C()}catch(a){console.error("Failed to delete product:",a)}},G=()=>{P({isOpen:!1,productId:"",productTitle:""})},j=h.category&&!n.search.includes("type=all")?`${h.category.split("-").join(" ")}`:"Marketplace";if(B)return e.jsx(ae,{});if(V)return e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 capitalize max-w-80 sm:max-w-full truncate",children:j}),e.jsx(k,{onApply:f,onClear:b,initialFilters:u})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(le,{className:"h-12 w-12 text-red-500"}),e.jsx("p",{className:"text-gray-600",children:"Failed to load products"}),e.jsx("button",{onClick:()=>C(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90",children:"Try Again"})]})]});const o=v?.data,A=Array.isArray(o)?o:o?.products||[],r=Array.isArray(o)?[]:o?.availableLocations||[],D=v?.pagination?.totalPages||1;return A.length===0?e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 capitalize max-w-80 sm:max-w-full truncate",children:j}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{children:[e.jsx(E,{asChild:!0,children:e.jsxs("button",{className:"bg-blue-50 flex gap-2 h-[42px] items-center px-2 md:px-3 py-2 rounded-lg hover:bg-blue-100 transition-colors outline-none cursor-pointer",children:[e.jsx(I,{className:"w-5 h-5 text-gray-700"}),e.jsxs("div",{className:"flex flex-col text-left",children:[e.jsx("span",{className:"text-xs text-gray-600 hidden md:block",children:"Location"}),e.jsxs("span",{className:"text-xs md:text-sm font-semibold text-gray-900 flex items-center gap-1",children:[i==="all"?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden lg:inline",children:"All Locations"}),e.jsx("span",{className:"lg:hidden",children:"All"})]}):e.jsx(e.Fragment,{children:r.find(a=>a._id===i)?.displayName||r.find(a=>a._id===i)?.city||"Select Location"}),e.jsx($,{size:12})]})]})]})}),e.jsxs(z,{align:"start",className:"w-56",children:[e.jsx(O,{}),e.jsx(m,{className:"cursor-pointer",onClick:()=>p("all"),children:"All Locations"}),r.map(a=>e.jsx(m,{className:"cursor-pointer",onClick:()=>p(a._id),children:a.displayName||`${a.city}, ${a.state}`},a._id))]})]}),e.jsx(k,{onApply:f,onClear:b,initialFilters:u})]})]}),e.jsx("div",{children:e.jsx(se,{title:"No products found",description:"Check back later for new products",icon:e.jsx("img",{src:te,alt:"Product empty",className:"h-64 w-auto"}),className:"h-100"})})]}):e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 capitalize max-w-80 sm:max-w-full truncate",children:j}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{children:[e.jsx(E,{asChild:!0,children:e.jsxs("button",{className:"bg-blue-50 flex gap-2 h-[42px] items-center px-2 md:px-3 py-2 rounded-lg hover:bg-blue-100 transition-colors outline-none cursor-pointer",children:[e.jsx(I,{className:"w-5 h-5 text-gray-700"}),e.jsxs("div",{className:"flex flex-col text-left",children:[e.jsx("span",{className:"text-xs text-gray-600 hidden md:block",children:"Location"}),e.jsxs("span",{className:"text-xs md:text-sm font-semibold text-gray-900 flex items-center gap-1",children:[i==="all"?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden lg:inline",children:"All Locations"}),e.jsx("span",{className:"lg:hidden",children:"All"})]}):e.jsx(e.Fragment,{children:r.find(a=>a._id===i)?.displayName||r.find(a=>a._id===i)?.city||"Select Location"}),e.jsx($,{size:12})]})]})]})}),e.jsxs(z,{align:"start",className:"w-56",children:[e.jsx(O,{}),e.jsx(m,{className:"cursor-pointer",onClick:()=>p("all"),children:"All Locations"}),r.map(a=>e.jsx(m,{className:"cursor-pointer",onClick:()=>p(a._id),children:a.displayName||`${a.city}, ${a.state}`},a._id))]})]}),e.jsx(k,{onApply:f,onClear:b,initialFilters:u})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:A.map(a=>e.jsx(ee,{product:a,onProductClick:Q},a.id||a._id))}),D>1&&e.jsx(X,{currentPage:w,totalPages:D,onPageChange:x}),e.jsx(K,{isOpen:y.isOpen,onClose:G,onConfirm:q,title:"Delete Product",description:e.jsxs(e.Fragment,{children:["Are you sure you want to delete"," ",e.jsxs("strong",{className:"font-semibold",children:['"',y.productTitle,'"']}),"? This action cannot be undone."]}),confirmText:"Delete",cancelText:"Cancel",isLoading:F.isPending})]})};export{fe as default};
