import{V as A,n as j,a3 as ue,E as D,aK as y,G as V,r as W,j as e,D as E,b as M,B as d,aL as pe,c as R,aM as ge,ae as h,a6 as B,a7 as $,a8 as K,a9 as q,e as p,am as Ne,K as C,N as je,bC as ye,ab as be,f as we,S as n}from"./index-CUSVstqU.js";import{u as fe,f as z,g as ve,a as Ce,b as ke}from"./index-7rtZR-0h.js";import{T as Se,a as Ue,b as O,c as Fe,d as Ie,e as Te}from"./table-DneWR9W7.js";import{B as P}from"./badge-c_xwgsXg.js";import{g as _}from"./orderUtils-DR-jD4b-.js";import{f as Q}from"./date-utils-CIparGJB.js";import{E as Le}from"./EmptyState-CH6fPGhV.js";import{B as Ee}from"./buyingEmptyState-C5ryqnDV.js";import{U as Me}from"./UserTableSkeleton-Dw2BkS24.js";import{S as Re}from"./SearchInput-CIs23NSy.js";import{S as Ae,C as De}from"./SortDropdown-BZ2QEsue.js";import{A as w}from"./arrow-up-down-BPvpXmMH.js";import{E as H}from"./ellipsis-vertical-CPx5VAQW.js";import{T as Y}from"./trash-2-BLdsFbCa.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],G=A("ban",Ve);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],$e=A("mail",Be);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],J=A("user-check",Ke);class qe{async getUsers(a){const i=new URLSearchParams;return a&&Object.entries(a).forEach(([u,m])=>{m!=null&&m!==""&&i.append(u,String(m))}),(await j.get("/user",{params:i})).data}async getUserById(a){return(await j.get(`/user/${a}`)).data}async blockUser(a){return(await j.put(`/user/${a}/block`)).data}async unblockUser(a){return(await j.put(`/user/${a}/unblock`)).data}async deleteUser(a){return(await j.delete(`/user/${a}`)).data}async restoreUser(a){return(await j.put(`/user/${a}/restore`)).data}}const k=new qe,ze=r=>{const a=r.profile,i={id:r._id,email:r.email,firstName:r.firstName,lastName:r.lastName,displayName:r.displayName,role:r.role,accountType:r.role,isVerified:r.isVerified,createdAt:r.createdAt,updatedAt:r.updatedAt,avatar:a?.avatar,currentLocationId:r.currentLocationId,currentLocation:r.currentLocation||null,authType:r.authType,stripeCustomerId:r.stripeCustomerId,status:r.status};switch(r.role){case"seller":return{...i,phone:a?.phone,businessName:a?.businessName,businessAddress:a?.businessAddress||a?.address,cellPhone:a?.cellPhone,localDelivery:a?.localDelivery,einNumber:a?.einNumber,salesTaxId:a?.salesTaxId,region:a?.region,address:a?.address,description:a?.description};case"driver":return{...i,phone:a?.phone,address:a?.address,isVehicles:a?.isVehicles,isLicense:a?.isLicense};case"buyer":return{...i,address:a?.address,region:a?.region,description:a?.description};case"admin":return{...i,phone:r.phone,department:a?.department,adminLevel:a?.adminLevel,lastLoginIP:a?.lastLoginIP,twoFactorEnabled:a?.twoFactorEnabled||!1};default:return{...i,phone:r.phone,address:a?.address}}},rs=r=>ue({queryKey:["users",r],queryFn:async()=>{const a=await k.getUsers(r);return console.log("response",a),{users:a.data.map(i=>ze(i)),pagination:a.meta.pagination,stats:a.meta.stats}},staleTime:300*1e3}),ls=()=>D({mutationFn:r=>k.blockUser(r),onSuccess:()=>{V.invalidateQueries({queryKey:["users"]}),y.success("User blocked successfully")},onError:r=>{y.error(r?.response?.data?.message||"Failed to block user")}}),ns=()=>D({mutationFn:r=>k.unblockUser(r),onSuccess:()=>{V.invalidateQueries({queryKey:["users"]}),y.success("User unblocked successfully")},onError:r=>{y.error(r?.response?.data?.message||"Failed to unblock user")}}),is=()=>D({mutationFn:r=>k.deleteUser(r),onSuccess:()=>{V.invalidateQueries({queryKey:["users"]}),y.success("User deleted successfully")},onError:r=>{y.error(r?.response?.data?.message||"Failed to delete user")}}),Oe=({filters:r={status:""},onFilterChange:a,className:i=""})=>{const[g,u]=W.useState(r),m=o=>{u(b=>({...b,status:o}))},S=()=>{const o={status:""};u(o),a?.(o)},U=()=>{a?.(g)};return e.jsxs(E,{children:[e.jsx(M,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",className:`w-8 h-8 bg-primary/10 hover:bg-primary/20 ${i}`,children:e.jsx(pe,{className:"w-4 h-4 text-primary"})})}),e.jsxs(R,{align:"end",className:"w-full md:w-[600px] p-4",children:[e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:" Status"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:["Active","Inactive","Pending"].map(o=>e.jsxs("label",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-sm border border-gray-200 cursor-pointer transition-colors",onClick:b=>{b.preventDefault(),m(o)},children:[e.jsx(ge,{checked:g.status===o,onCheckedChange:()=>{},className:"pointer-events-none h-4 w-4"}),e.jsx("span",{className:"text-sm select-none capitalize",children:o})]},o))})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(d,{variant:"outline",onClick:S,className:"  w-[126px] h-[48px] !text-sm text-primary border border-gray-200-primary hover:bg-primary/10 hover:text-primary",children:"Clear All Filters"}),e.jsx(d,{onClick:U,className:"w-[126px] h-[48px] !text-sm  bg-primary hover:bg-primary/90 text-white",children:"Apply Filter"})]})]})]})},cs=({users:r,onViewDetails:a,onDelete:i,onBlock:g,onUnblock:u,title:m,showFilter:S=!0,showSort:U=!0,showSearch:o=!0,selectedSort:b,onSortChange:X,filters:f,onFilterChange:Z,searchValue:F,onSearchChange:ee,isLoading:I=!1,actionLoading:se=!1})=>{const[c,T]=W.useState({isOpen:!1,type:null,userId:null,userName:null,userEmail:null}),[ae,te]=h.useState([]),[re,le]=h.useState([]),[ne,ie]=h.useState({email:!0}),[ce,oe]=h.useState({}),[v,L]=h.useState(""),de=()=>{if(c.userId){switch(c.type){case"delete":i?.(c.userId);break;case"block":g?.(c.userId);break;case"unblock":u?.(c.userId);break}T({isOpen:!1,type:null,userId:null,userName:null,userEmail:null})}},N=(s,l,t,he)=>{T({isOpen:!0,type:s,userId:l,userName:t,userEmail:he})};h.useEffect(()=>{F!==void 0&&L(F)},[F]);const me=h.useMemo(()=>[{id:"serialNumber",header:()=>e.jsx("div",{className:"text-center",children:"Sr.No."}),cell:s=>e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-primary font-medium text-xs lg:text-sm",children:s.row.index+1})}),enableSorting:!1,enableColumnFilter:!1},{accessorKey:"displayName",header:({column:s})=>e.jsxs(d,{variant:"ghost",className:"p-0 hover:bg-transparent font-semibold text-gray-700 text-xs lg:text-sm",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Name",e.jsx(w,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const l=s.original;return e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3 py-1",children:[e.jsxs(B,{className:"w-10 h-10 lg:w-12 lg:h-12 border-2 border-white shadow-sm",children:[l.avatar?e.jsx($,{src:l.avatar,alt:l.displayName||"User",className:"object-cover"}):null,e.jsx(K,{className:"bg-gray-200 text-gray-700 font-medium text-xs uppercase",children:q(l.displayName||"")})]}),e.jsx("div",{className:"text-left",children:e.jsx("div",{className:"font-medium text-xs lg:text-sm text-gray-900 capitalize",children:l.displayName||"Unknown"})})]})},filterFn:(s,l,t)=>t===void 0||t===""?!0:s.getValue(l)?.toLowerCase().includes(t.toLowerCase())},{accessorKey:"email",header:({column:s})=>e.jsxs(d,{variant:"ghost",className:"p-0 hover:bg-transparent font-semibold text-gray-700 text-xs lg:text-sm hidden lg:flex",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Email",e.jsx(w,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("div",{className:"hidden lg:block",children:e.jsx("span",{className:"text-gray-700 text-xs lg:text-sm",children:s.getValue("email")||"No email"})}),filterFn:(s,l,t)=>t===void 0||t===""?!0:s.getValue(l)?.toLowerCase().includes(t.toLowerCase())},{accessorKey:"authType",header:({column:s})=>e.jsxs(d,{variant:"ghost",className:"p-0 hover:bg-transparent font-semibold text-gray-700 text-xs lg:text-sm",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Login Type",e.jsx(w,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("span",{className:"text-gray-900 text-xs lg:text-sm capitalize",children:s.getValue("authType")||"Email"}),filterFn:(s,l,t)=>t===void 0||t===""?!0:s.getValue(l)?.toLowerCase().includes(t.toLowerCase())},{accessorKey:"createdAt",header:({column:s})=>e.jsxs(d,{variant:"ghost",className:"p-0 hover:bg-transparent font-semibold text-gray-700 text-xs lg:text-sm",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Created On",e.jsx(w,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("span",{className:"text-gray-900 text-xs lg:text-sm",children:Q(s.getValue("createdAt"))}),sortingFn:"datetime"},{accessorKey:"status",header:({column:s})=>e.jsxs(d,{variant:"ghost",className:"p-0 hover:bg-transparent font-semibold text-gray-700 text-xs lg:text-sm",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Status",e.jsx(w,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const l=s.getValue("status");return e.jsx(P,{className:`px-2 lg:px-3 py-1 rounded-full font-medium text-xs capitalize ${_(l)}`,children:l})},filterFn:(s,l,t)=>t===void 0||t===""?!0:s.getValue(l)?.toLowerCase()===t.toLowerCase()},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),cell:({row:s})=>{const l=s.original;return e.jsx("div",{className:"text-center",children:e.jsxs(E,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(d,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(H,{className:"h-4 w-4"})]})}),e.jsxs(R,{align:"end",children:[e.jsxs(p,{onClick:()=>a?.(l.id||""),className:"cursor-pointer text-primary",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4 text-primary"}),"View User"]}),l.status==="active"?e.jsxs(p,{onClick:()=>N("block",l.id||"",l.displayName||"this user",l.email||""),className:"cursor-pointer text-orange-600 hover:text-orange-700",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Block User"]}):l.status==="inactive"?e.jsxs(p,{onClick:()=>N("unblock",l.id||"",l.displayName||"this user",l.email||""),className:"cursor-pointer text-green-600 hover:text-green-700",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Unblock User"]}):null,l.status!=="deleted"&&e.jsxs(p,{onClick:()=>N("delete",l.id||"",l.displayName||"this user",l.email||""),className:"cursor-pointer text-red-600 hover:text-red-700",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Delete User"]})]})]})})},enableSorting:!1,enableColumnFilter:!1}],[a,g,u,i]),x=fe({data:r,columns:me,onSortingChange:te,onColumnFiltersChange:le,getCoreRowModel:ke(),getSortedRowModel:Ce(),getFilteredRowModel:ve(),onColumnVisibilityChange:ie,onRowSelectionChange:oe,globalFilterFn:"includesString",state:{sorting:ae,columnFilters:re,columnVisibility:ne,rowSelection:ce,globalFilter:v},onGlobalFilterChange:L,enableRowSelection:!0,getRowId:(s,l)=>s.id||String(l)}),xe=s=>{L(s),ee?.(s)};return h.useEffect(()=>{f?.status?x.getColumn("status")?.setFilterValue(f.status.toLowerCase()):x.getColumn("status")?.setFilterValue("")},[f,x]),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex sm:flex-row flex-col sm:items-center justify-between gap-2 mb-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:m})}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[o&&e.jsx(Re,{value:v??"",onChange:xe,placeholder:"Search users...",className:"w-64"}),U&&e.jsx(Ae,{selectedSort:b,onSortChange:X}),S&&e.jsx(Oe,{filters:f,onFilterChange:Z})]})]}),I&&e.jsx(Me,{}),!I&&x.getFilteredRowModel().rows.length===0&&e.jsx(Le,{title:`No ${m||"Users"} found`,description:v?`No results found for "${v}". Try adjusting your search.`:`You don't have any ${m?.toLowerCase()||"users"} yet.`,icon:e.jsx("img",{src:Ee,className:"w-64 h-56",alt:"No users"}),className:"min-h-[400px]"}),!I&&x.getFilteredRowModel().rows.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden space-y-3",children:x.getFilteredRowModel().rows.map((s,l)=>{const t=s.original;return e.jsx(C,{className:"bg-white shadow-sm border-gray-200",children:e.jsxs(je,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{className:"w-10 h-10 border-2 border-white shadow-sm",children:[t.avatar?e.jsx($,{src:t.avatar,alt:t.displayName||"User",className:"object-cover"}):null,e.jsx(K,{className:"bg-gray-200 text-gray-700 text-xs font-medium uppercase",children:q(t.displayName||"")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.displayName||"Unknown"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["#",l+1]})]})]}),e.jsx(P,{className:`px-2 py-1 rounded-full font-medium text-xs capitalize ${_(t.status)}`,children:t.status})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx($e,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:t.email||"No email"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(ye,{className:"w-3 h-3 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["Login: ",t.authType||"Email"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(De,{className:"w-3 h-3 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["Joined: ",Q(t.createdAt)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t",children:[e.jsxs(d,{variant:"ghost",size:"sm",className:"text-primary font-semibold text-xs",onClick:()=>a?.(t.id||""),children:["View Details",e.jsx(be,{className:"w-4 h-4 ml-1"})]}),e.jsxs(E,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(H,{className:"h-4 w-4"})]})}),e.jsxs(R,{align:"end",children:[t.status==="active"?e.jsxs(p,{onClick:()=>N("block",t.id||"",t.displayName||"this user",t.email||""),className:"cursor-pointer text-orange-600",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Block User"]}):t.status==="inactive"?e.jsxs(p,{onClick:()=>N("unblock",t.id||"",t.displayName||"this user",t.email||""),className:"cursor-pointer text-green-600",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Unblock User"]}):null,t.status!=="deleted"&&e.jsxs(p,{onClick:()=>N("delete",t.id||"",t.displayName||"this user",t.email||""),className:"cursor-pointer text-red-600",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Delete User"]})]})]})]})]})},t.id||l)})}),e.jsx(C,{className:"hidden md:block bg-white shadow-sm border-gray-50 rounded-3xl p-0 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Se,{children:[e.jsx(Ue,{children:x.getHeaderGroups().map(s=>e.jsx(O,{className:"bg-gray-50/50 hover:bg-gray-50/50",children:s.headers.map(l=>e.jsx(Fe,{children:l.isPlaceholder?null:z(l.column.columnDef.header,l.getContext())},l.id))},s.id))}),e.jsx(Ie,{children:x.getRowModel().rows.map((s,l)=>e.jsx(O,{"data-state":s.getIsSelected()&&"selected",className:"hover:bg-gray-50/30 border-b",children:s.getVisibleCells().map(t=>e.jsx(Te,{className:"py-3 lg:py-4",children:t.column.id==="serialNumber"?e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-primary font-medium text-xs lg:text-sm",children:l+1})}):z(t.column.columnDef.cell,t.getContext())},t.id))},s.id))})]})})})]}),e.jsx(we,{isOpen:c.isOpen,onClose:()=>T({isOpen:!1,type:null,userId:null,userName:null,userEmail:null}),onConfirm:de,title:c.type==="delete"?"Delete User?":c.type==="block"?"Block User?":"Unblock User?",description:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.userName}),c.userEmail&&e.jsx("div",{className:"text-sm text-gray-600",children:c.userEmail}),e.jsx("div",{className:"text-sm text-gray-700 mt-3",children:c.type==="delete"?"This action cannot be undone. The user will be permanently removed from the system.":c.type==="block"?"The user will not be able to access their account until unblocked.":"The user will regain full access to their account."})]}),isLoading:se,confirmText:c.type==="delete"?"Yes, Delete User":c.type==="block"?"Yes, Block User":"Yes, Unblock User"})]})},os=()=>e.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[1,2,3,4,5].map(r=>e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"h-4 w-20"}),e.jsx(n,{className:"h-8 w-16"})]}),e.jsx(n,{className:"h-10 w-10 rounded-lg"})]})},r))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-8 w-32"}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(n,{className:"h-10 w-64"})," ",e.jsx(n,{className:"h-10 w-32"})," ",e.jsx(n,{className:"h-10 w-32"})," "]})]}),e.jsx(C,{className:"bg-white shadow-sm border-gray-50 rounded-3xl p-0 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-7 gap-4 pb-4 border-b",children:[e.jsx(n,{className:"h-4 w-12"}),e.jsx(n,{className:"h-4 w-20"}),e.jsx(n,{className:"h-4 w-32"}),e.jsx(n,{className:"h-4 w-24"}),e.jsx(n,{className:"h-4 w-24"}),e.jsx(n,{className:"h-4 w-20"}),e.jsx(n,{className:"h-4 w-20"})]}),[1,2,3,4,5,6,7,8].map(r=>e.jsxs("div",{className:"grid grid-cols-7 gap-4 py-4 border-b items-center",children:[e.jsx(n,{className:"h-4 w-8"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{className:"h-10 w-10 rounded-full"}),e.jsx(n,{className:"h-4 w-24"})]}),e.jsx(n,{className:"h-4 w-40"}),e.jsx(n,{className:"h-4 w-20"}),e.jsx(n,{className:"h-4 w-24"}),e.jsx(n,{className:"h-6 w-20 rounded-full"}),e.jsx(n,{className:"h-8 w-8 rounded"})]},r))]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(n,{className:"h-10 w-24"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(r=>e.jsx(n,{className:"h-10 w-10"},r))}),e.jsx(n,{className:"h-10 w-24"})]})]});export{os as B,cs as U,ls as a,ns as b,is as c,rs as u};
