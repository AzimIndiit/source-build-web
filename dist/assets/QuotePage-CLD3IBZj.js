import{r as n,ae as k,j as e,D as A,b as K,B as j,c as B,e as F,az as P,am as Q,K as N,N as G,f as H,u as W,ax as Y}from"./index-CUSVstqU.js";import{P as J}from"./pagination-wrapper-Caj-HnEp.js";import{u as X,f as I,g as Z,a as ee,b as se}from"./index-7rtZR-0h.js";import{T as ae,a as te,b as U,c as le,d as re,e as ne}from"./table-DneWR9W7.js";import{S as oe}from"./SearchInput-CIs23NSy.js";import{E as ie}from"./EmptyState-CH6fPGhV.js";import{E as de}from"./ellipsis-vertical-CPx5VAQW.js";import{T as O}from"./trash-2-BLdsFbCa.js";import{a as ce,b as me}from"./useQuoteMutations-CFuvV0_F.js";const xe=({quotes:h,onReply:o,onView:c,onEdit:T,onDelete:i,title:b="Quotes",searchValue:m,onSearchChange:u,isLoading:g=!1})=>{const[q,y]=n.useState([]),[w,f]=n.useState([]),[v,C]=n.useState({}),[S,M]=n.useState({}),[d,l]=n.useState(""),[p,R]=n.useState({isOpen:!1,quoteId:null,quoteName:null});k.useEffect(()=>{m!==void 0&&l(m)},[m]);const D=s=>{R({isOpen:!0,quoteId:s.id||s._id||"",quoteName:s.user?.displayName||"Unknown User"})},L=()=>{p.quoteId&&i&&i(p.quoteId),R({isOpen:!1,quoteId:null,quoteName:null})},V=k.useMemo(()=>[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"ID"}),cell:s=>e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-primary font-medium text-xs lg:text-sm",children:s.row.index+1})}),enableSorting:!1,enableColumnFilter:!1},{id:"nameEmail",accessorFn:s=>{const a=s.user?.displayName||"Unknown User",t=s.user?.email||"No Email";return`${a} ${t}`},header:"Name & Email",cell:({row:s})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:s.original.user?.displayName||"Unknown User"}),e.jsx("span",{className:"text-xs text-primary underline",children:s.original.user?.email||"No Email"})]}),filterFn:(s,a,t)=>{const r=s.original,E=t.toLowerCase(),$=r.user?.displayName||"",z=r.user?.email||"";return $.toLowerCase().includes(E)||z.toLowerCase().includes(E)}},{accessorKey:"projectType",header:"What is the project type?",cell:({row:s})=>{const a=s.getValue("projectType"),t=a?.replace(/-/g," ").replace(/\b\w/g,r=>r.toUpperCase());return e.jsx("span",{className:"text-sm text-gray-900",children:t||a})}},{accessorKey:"installationLocation",header:"What is the installation location?",cell:({row:s})=>{const a=s.getValue("installationLocation"),t=a?.replace(/-/g," ").replace(/\b\w/g,r=>r.toUpperCase());return e.jsx("span",{className:"text-sm text-gray-900",children:t||a})}},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"text-center",children:e.jsxs(A,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(j,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(de,{className:"h-4 w-4"})]})}),e.jsxs(B,{align:"end",children:[e.jsxs(F,{onClick:()=>o?.(a),className:"cursor-pointer text-green-600 hover:text-green-700",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Reply"]}),e.jsxs(F,{onClick:()=>c?.(a),className:"cursor-pointer text-primary",children:[e.jsx(Q,{className:"mr-2 h-4 w-4 text-primary"}),"View"]}),e.jsxs(F,{onClick:()=>D(a),className:"cursor-pointer text-red-600 hover:text-red-700",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})},enableSorting:!1,enableColumnFilter:!1}],[c]),x=X({data:h,columns:V,onSortingChange:y,onColumnFiltersChange:f,getCoreRowModel:se(),getSortedRowModel:ee(),getFilteredRowModel:Z(),onColumnVisibilityChange:C,onRowSelectionChange:M,globalFilterFn:"includesString",state:{sorting:q,columnFilters:w,columnVisibility:v,rowSelection:S,globalFilter:d},onGlobalFilterChange:l,enableRowSelection:!0,getRowId:s=>s.id||s._id||""}),_=s=>{l(s),u?.(s)};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:b}),e.jsx(oe,{value:d??"",onChange:_,placeholder:"Search by name or email...",className:"w-80"})]}),g&&e.jsx(N,{className:"bg-white shadow-sm border-gray-50 rounded-3xl p-6",children:Array.from({length:5}).map((s,a)=>e.jsx("div",{className:"py-4 border-b last:border-b-0 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center flex-1",children:[e.jsx("div",{className:"h-4 w-8 bg-gray-200 rounded"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 w-40 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded ml-4"}),e.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded ml-4"})]}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"})]})},a))}),!g&&e.jsxs(e.Fragment,{children:[x.getFilteredRowModel().rows.length===0&&e.jsx(ie,{title:"No quotes found",description:d?`No results found for "${d}". Try adjusting your search.`:"You don't have any quotes yet.",className:"min-h-[400px]"}),x.getFilteredRowModel().rows.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden space-y-3",children:x.getFilteredRowModel().rows.map((s,a)=>{const t=s.original;return e.jsx(N,{className:"bg-white shadow-sm border-gray-200",children:e.jsxs(G,{className:"p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Quote #",a+1]}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.user?.displayName||"Unknown User"})]})}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Email:"}),e.jsx("span",{className:"text-xs font-medium text-primary",children:t.user?.email||"No Email"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Project Type:"}),e.jsx("span",{className:"text-xs font-medium",children:t.projectType?.replace(/-/g," ").replace(/\b\w/g,r=>r.toUpperCase())})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Location:"}),e.jsx("span",{className:"text-xs font-medium",children:t.installationLocation?.replace(/-/g," ").replace(/\b\w/g,r=>r.toUpperCase())})]})]}),e.jsxs("div",{className:"flex justify-end pt-3 border-t gap-1",children:[e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 bg-yellow-500 hover:bg-yellow-600 text-white rounded-full",onClick:()=>o?.(t),children:e.jsx(P,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 bg-blue-600 hover:bg-blue-700 text-white rounded-full",onClick:()=>c?.(t),children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 bg-red-600 hover:bg-red-700 text-white rounded-full",onClick:()=>D(t),children:e.jsx(O,{className:"h-4 w-4"})})]})]})},t.id||t._id||a)})}),e.jsx(N,{className:"hidden md:block bg-white shadow-sm border-gray-50 rounded-3xl p-0 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ae,{children:[e.jsx(te,{children:x.getHeaderGroups().map(s=>e.jsx(U,{className:"bg-gray-50/50 hover:bg-gray-50/50",children:s.headers.map(a=>e.jsx(le,{children:a.isPlaceholder?null:I(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(re,{children:x.getRowModel().rows.map(s=>e.jsx(U,{"data-state":s.getIsSelected()&&"selected",className:"hover:bg-gray-50/30 border-b",children:s.getVisibleCells().map(a=>e.jsx(ne,{className:"py-3 lg:py-4",children:I(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]})})})]})]}),e.jsx(H,{isOpen:p.isOpen,onClose:()=>R({isOpen:!1,quoteId:null,quoteName:null}),onConfirm:L,title:"Delete Quote",description:`Are you sure you want to delete the quote from ${p.quoteName}? This action cannot be undone.`})]})},he=()=>e.jsxs("div",{className:"py-4 md:p-6 space-y-6 animate-pulse",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsx("div",{className:"h-8 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-10 w-80 bg-gray-200 rounded"})]}),e.jsx(N,{className:"bg-white shadow-sm border-gray-50 rounded-3xl p-0 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"border-b pb-4 mb-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded"})]})})}),[...Array(5)].map((h,o)=>e.jsx("div",{className:"border-b py-4 last:border-b-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center flex-1",children:[e.jsx("div",{className:"h-4 w-8 bg-gray-200 rounded"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 w-40 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded ml-4"}),e.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded ml-4"})]}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"})]})},o))]})})]}),ve=()=>{const h=W(),[o,c]=n.useState(1),[T]=n.useState(10),[i,b]=n.useState(""),{data:m,isLoading:u}=ce({page:o,limit:T,search:i}),{mutate:g,isPending:q}=Y(),y=me(),w=l=>{h(`/admin/quote/${l.id||l._id}`)},f=l=>{l.user?.id&&g({participantId:l.user?.id})},v=l=>{y.mutate(l)},C=l=>{c(l)},S=l=>{b(l),l!==i&&c(1)},M=m?.data?.quotes||[],d=m?.pagination?.pages||1;return u&&!i&&o===1?e.jsx(he,{}):e.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[e.jsx(xe,{quotes:M,onView:w,onReply:f,onDelete:v,title:"Quotes",searchValue:i,onSearchChange:S,isLoading:u}),d>1&&e.jsx(J,{currentPage:o,totalPages:d,onPageChange:C})]})};export{ve as default};
