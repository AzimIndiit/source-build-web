import{r as E,j as e,h as G,a1 as A,x as g,ad as me,B as O,al as te,ah as X,aG as pe,am as xe,I as P,aV as he,aW as ue,aX as ae,aY as ge,aZ as be}from"./index-BCiIUrXb.js";import{F as S}from"./FormSelect-prL940lU.js";import{P as ye}from"./PickupHoursSelector-BvNq3gU7.js";import{U as _}from"./upload-Brfr3HgH.js";import{T as je}from"./trash-2-Ct1NlBzh.js";import{C as ve}from"./calendar-D77CX2lA.js";import{B as z}from"./badge-C6OOTzUs.js";const De=({methods:s,uploadedPhotos:x,existingImages:m=[],removeExistingImage:y,imageError:N,setImageError:u,addressOptions:k=[],showAddAddressModal:C,setShowAddAddressModal:U,variants:b,showVariants:T,handleDrag:$,handleDrop:v,handleFileChange:q,removePhoto:I,addVariant:c,removeVariant:n,handleVariantImageUpload:d,removeVariantImage:M,removeExistingVariantImage:K,handleVariantDrag:F,handleVariantDrop:Q,dragActive:Z,variantDragActive:Y,MAX_IMAGES:J,categoryOptions:re,subCategoryOptions:V,tagOptions:le,isLoading:f=!1})=>{const{watch:ie,setValue:D,clearErrors:H,formState:{errors:w},trigger:ne}=s,h=ie(),[B,ee]=E.useState(1),[L,W]=E.useState(null),ce=async()=>{if(m.length+x.length<2)return u(!0),P.error("Please upload at least 2 product images"),!1;u(!1);const l=["title","price","description","category","subCategory","quantity","brand","color","locationIds","availabilityRadius","productTag"];b&&b.length>0&&b.forEach((i,a)=>{l.push(`variants.${a}.color`),l.push(`variants.${a}.quantity`),l.push(`variants.${a}.price`);const p=h.variants?.[a]?.discount;p?.discountType&&p.discountType!=="none"&&l.push(`variants.${a}.discount.discountValue`)});const t=await ne(l);if(!t){const i=w.variants;if(b.some((p,o)=>i?.[o]?.color||i?.[o]?.quantity||i?.[o]?.price||i?.[o]?.discount?.discountValue)){const p=b.findIndex((o,j)=>i?.[j]?.color||i?.[j]?.quantity||i?.[j]?.price||i?.[j]?.discount?.discountValue);if(p!==-1){const o=i?.[p];o?.color?P.error(`Variant ${p+1}: ${o.color.message}`):o?.quantity?P.error(`Variant ${p+1}: ${o.quantity.message}`):o?.price?P.error(`Variant ${p+1}: ${o.price.message}`):o?.discount?.discountValue&&P.error(`Variant ${p+1}: ${o.discount.discountValue.message}`)}}else{const p=l.find(o=>o.startsWith("variants.")?!1:w[o]);if(p&&w[p]){const o=w[p]?.message;o&&P.error(o)}}}return t},oe=async()=>{await ce()&&(ee(2),window.scrollTo({top:0,behavior:"smooth"}))},de=()=>{ee(1),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("div",{className:"w-full h-full ",children:[e.jsxs(G,{className:"p-0 bg-white rounded-xl shadow-sm border-gray-200 h-full flex flex-col ",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 p-4 sm:p-6",children:[B===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Product Details"}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",id:"photos",children:e.jsxs("h3",{className:`text-sm font-medium ${N?"text-red-600":"text-gray-900"}`,children:["Photos · ",m.length+x.length,"/",J," - Minimum 2, maximum ",J," photos required.",e.jsx("span",{className:"text-red-500",children:"*"})]})}),m.length===0&&x.length===0?e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-6 text-center ${N?"bg-red-50":"bg-gray-50"} ${Z?"border-primary bg-blue-50":N?"border-red-300":"border-gray-300"}`,onDragEnter:$,onDragLeave:$,onDragOver:$,onDrop:v,children:[e.jsx("input",{type:"file",id:"photo-upload",className:"hidden",multiple:!0,accept:"image/*",onChange:q}),e.jsxs("label",{htmlFor:"photo-upload",className:"cursor-pointer inline-flex flex-col items-center",children:[e.jsx(_,{className:"h-10 w-10 text-gray-400 mb-3"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]}),e.jsx("span",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 text-center bg-gray-50 ${Z?"border-primary bg-blue-50":"border-gray-300"}`,onDragEnter:$,onDragLeave:$,onDragOver:$,onDrop:v,children:[e.jsx("input",{type:"file",id:"photo-upload-more",className:"hidden",multiple:!0,accept:"image/*",onChange:q}),e.jsxs("label",{htmlFor:"photo-upload-more",className:"cursor-pointer inline-flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]})]}),e.jsx("div",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]}),e.jsxs("div",{className:"grid grid-cols-3 lg:grid-cols-5 gap-2",children:[m.map((r,l)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:r,alt:`Existing ${l+1}`,className:"w-full h-20 sm:h-24 md:h-28 lg:h-16 object-cover rounded-sm"}),y&&e.jsx("button",{type:"button",onClick:()=>y(l),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(A,{className:"h-3 w-3"})})]},`existing-${l}`)),x.map((r,l)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:URL.createObjectURL(r),alt:`Upload ${l+1}`,className:"w-full h-20 sm:h-24 md:h-28 lg:h-16 object-cover rounded-sm"}),e.jsx("button",{type:"button",onClick:()=>I(l),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(A,{className:"h-3 w-3"})})]},`upload-${l}`))]})]}),N&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:"At least 2 images are required"})]}),e.jsx("div",{className:"",children:e.jsx(g,{name:"title",label:"Title",placeholder:"Primed MDF 3.25″ Casing, 7′ x 1/2",className:"border-gray-300 h-[53px] "})}),e.jsx("div",{children:e.jsx(g,{name:"price",label:"Price ($)",placeholder:"$0.00",type:"text",className:"border-gray-300 h-[53px]",onInput:r=>{const l=r.currentTarget,i=l.value.replace(/[^0-9.]/g,""),a=i.split(".");a.length>2?l.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?l.value=a[0]+"."+a[1].substring(0,2):l.value=i}})}),e.jsx("div",{children:e.jsx(me,{name:"description",label:"Description",placeholder:"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",rows:3,className:"border-gray-300 resize-none rounded-sm"})}),e.jsx("div",{children:e.jsx(S,{name:"category",label:"Category",placeholder:"Select Category",options:re,className:"h-[53px]"})}),e.jsxs("div",{children:[e.jsx(S,{name:"subCategory",label:"Sub Category",placeholder:h.category?"Select Sub Category":"Select category first",options:V,className:"h-[53px]",disabled:!h.category||V.length===0}),!h.category&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Please select a category first"})]}),e.jsx("div",{children:e.jsx(g,{name:"quantity",label:"Quantity",placeholder:"2",type:"number",className:"border-gray-300 h-[53px]",min:"1",step:"1",onInput:r=>{const l=r.currentTarget,t=l.value.replace(/[^0-9]/g,"");l.value=t.replace(/^0+/,"")||""},onKeyDown:r=>{[".","-","+","e","E"].includes(r.key)&&r.preventDefault()}})}),e.jsx("div",{children:e.jsx(g,{name:"brand",label:"Brand",placeholder:"Styling",className:"border-gray-300 h-[53px]"})}),e.jsx("div",{children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(g,{name:"color",label:"Color (HEX)",type:"text",placeholder:"#FF0000",className:"flex-1 h-[53px]",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",maxLength:7,onInput:r=>{const l=r.currentTarget;let t=l.value.toUpperCase();t.length===1&&t!=="#"&&/[A-Fa-f0-9]/.test(t)&&(t="#"+t),t=t.replace(/[^#A-Fa-f0-9]/g,""),t.indexOf("#")>0&&(t="#"+t.replace(/#/g,"")),l.value=t,H("color")}}),e.jsx("input",{type:"color",value:h.color||"#000000",onChange:r=>D("color",r.target.value),className:`w-[53px] h-[53px] ${w.color?"mt-0":"mt-5"} rounded border border-gray-300 cursor-pointer flex-shrink-0`})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Locations"}),e.jsxs(O,{type:"button",onClick:()=>{U&&U(!0)},variant:"outline",className:"flex items-center gap-2 text-sm h-[48px] border border-primary text-primary hover:text-primary hover:bg-primary/10",disabled:b.length>=5,children:[e.jsx(te,{className:"h-4 w-4"}),"Add Location"]})]}),e.jsx(S,{name:"locationIds",label:"",placeholder:"Select locations for this product",options:k,multiple:!0,searchable:!0,searchPlaceholder:"Search locations...",className:"border-gray-300"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Product Dimensions (Optional)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(g,{name:"dimensions.width",label:"Width (inches)",placeholder:"24",type:"text",className:"border-gray-300 h-[53px]",onInput:r=>{const l=r.currentTarget,i=l.value.replace(/[^0-9.]/g,""),a=i.split(".");a.length>2?l.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?l.value=a[0]+"."+a[1].substring(0,2):l.value=i}}),e.jsx(g,{name:"dimensions.length",label:"Length (inches)",placeholder:"36",type:"text",className:"border-gray-300 h-[53px]",onInput:r=>{const l=r.currentTarget,i=l.value.replace(/[^0-9.]/g,""),a=i.split(".");a.length>2?l.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?l.value=a[0]+"."+a[1].substring(0,2):l.value=i}}),e.jsx(g,{name:"dimensions.height",label:"Height (inches)",placeholder:"30",type:"text",className:"border-gray-300 h-[53px]",onInput:r=>{const l=r.currentTarget,i=l.value.replace(/[^0-9.]/g,""),a=i.split(".");a.length>2?l.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?l.value=a[0]+"."+a[1].substring(0,2):l.value=i}})]})]}),e.jsx("div",{children:e.jsx(S,{name:"productTag",label:"Product Tag",placeholder:"Select or create tags",options:le,multiple:!0,searchable:!0,creatable:!0,className:"h-[53px]",createPlaceholder:'Add "{search}" as a new tag',searchPlaceholder:"Type to search or create tags...",maxSelections:10})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{name:"discount.discountType",label:"Discount Type",placeholder:"Select Discount Type",options:[{value:"none",label:"No Discount"},{value:"flat",label:"Flat Amount"},{value:"percentage",label:"Percentage"}],className:"text-sm h-[53px]"}),h.discount?.discountType!=="none"&&e.jsx(g,{name:"discount.discountValue",label:"Discount Value",placeholder:h.discount.discountType==="percentage"?"10%":"10.00",className:"text-sm h-[53px]",type:"text",min:"0",onInput:r=>{const l=r.currentTarget,t=l.value,i=h.discount.discountType==="percentage";let a=t.replace(/[^0-9.]/g,"");a=a.replace(/^-/,"");const p=a.split(".");if(p.length>2&&(a=p[0]+"."+p.slice(1).join("")),p.length===2&&p[1].length>2&&(a=p[0]+"."+p[1].substring(0,2)),i){const o=parseFloat(a);!isNaN(o)&&o>100&&(a="100")}l.value=a},onKeyDown:r=>{r.key==="-"&&r.preventDefault()}})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-base font-medium text-gray-900",children:["Product Variants",e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",b.length,"/5)"]})]}),e.jsxs(O,{type:"button",onClick:c,variant:"outline",className:"flex items-center gap-2 text-sm h-[48px] border border-primary text-primary hover:text-primary hover:bg-primary/10",disabled:b.length>=5,children:[e.jsx(te,{className:"h-4 w-4"}),"Add Variant"]})]}),T&&b.length>0&&e.jsx("div",{className:"space-y-4",children:b.map((r,l)=>e.jsxs(G,{className:"p-4 border-2 border-gray-200 shadow-md gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between h-10",children:[e.jsxs("h4",{className:"font-medium text-sm",children:["Variant ",l+1]}),e.jsx(O,{type:"button",onClick:()=>W(r.id),variant:"ghost",className:"text-red-500 hover:text-red-700 p-1 h-10",children:e.jsx(je,{className:"h-4 w-4"})})]}),e.jsx("hr",{className:"my-0 py-0 text-gray-200"}),e.jsxs("div",{className:"my-3",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-2 block",children:"Variant Images (Max 5)"}),r.images.length===0&&(!r.existingImages||r.existingImages.length===0)?e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-4 text-center bg-gray-50 ${Y===r.id?"border-primary bg-blue-50":"border-gray-300"}`,onDragEnter:t=>{t.preventDefault(),t.stopPropagation(),F(t,r.id)},onDragLeave:t=>{t.preventDefault(),t.stopPropagation(),F(t,r.id)},onDragOver:t=>{t.preventDefault(),t.stopPropagation(),F(t,r.id)},onDrop:t=>{t.preventDefault(),t.stopPropagation(),Q(t,r.id)},children:[e.jsx("input",{type:"file",id:`variant-photo-upload-${r.id}`,className:"hidden",multiple:!0,accept:"image/*",onChange:t=>{if(t.target.files){const i=Array.from(t.target.files);d(r.id,i)}t.target.value=""}}),e.jsxs("label",{htmlFor:`variant-photo-upload-${r.id}`,className:"cursor-pointer inline-flex flex-col items-center",children:[e.jsx(_,{className:"h-8 w-8 text-gray-400 mb-2"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]}),e.jsx("span",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-3 text-center bg-gray-50 ${Y===r.id?"border-primary bg-blue-50":"border-gray-300"}`,onDragEnter:t=>{t.preventDefault(),t.stopPropagation(),F(t,r.id)},onDragLeave:t=>{t.preventDefault(),t.stopPropagation(),F(t,r.id)},onDragOver:t=>{t.preventDefault(),t.stopPropagation(),F(t,r.id)},onDrop:t=>{t.preventDefault(),t.stopPropagation(),Q(t,r.id)},children:[e.jsx("input",{type:"file",id:`variant-photo-upload-more-${r.id}`,className:"hidden",multiple:!0,accept:"image/*",onChange:t=>{if(t.target.files){const i=Array.from(t.target.files);d(r.id,i)}t.target.value=""}}),e.jsxs("label",{htmlFor:`variant-photo-upload-more-${r.id}`,className:"cursor-pointer inline-flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary underline",children:"click here"})]})]}),e.jsx("div",{className:"text-xs text-red-600",children:"Max file size is 5MB"})]}),e.jsxs("div",{className:"grid grid-cols-3 lg:grid-cols-5 gap-2",children:[r.existingImages?.map((t,i)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:t,alt:`Variant ${l+1} Existing ${i+1}`,className:"w-full sm:h-24 md:h-28  h-20 lg:h-16 object-cover rounded-sm"}),K&&e.jsx("button",{type:"button",onClick:()=>K(r.id,i),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(A,{className:"h-3 w-3"})})]},`existing-${i}`)),r.images.map((t,i)=>e.jsxs("div",{className:"relative group border border-gray-200 rounded-sm shadow-sm",children:[e.jsx("img",{src:URL.createObjectURL(t),alt:`Variant ${l+1} Image ${i+1}`,className:"w-full sm:h-24 md:h-28  h-20 lg:h-16 object-cover rounded-sm"}),e.jsx("button",{type:"button",onClick:()=>M(r.id,i),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 cursor-pointer",children:e.jsx(A,{className:"h-3 w-3"})})]},i))]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{name:`variants.${l}.color`,label:"Color (HEX)",type:"text",placeholder:"#FF0000",className:"flex-1 h-[53px]",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",maxLength:7,onInput:t=>{const i=t.currentTarget;let a=i.value.toUpperCase();a.length===1&&a!=="#"&&/[A-Fa-f0-9]/.test(a)&&(a="#"+a),a=a.replace(/[^#A-Fa-f0-9]/g,""),a.indexOf("#")>0&&(a="#"+a.replace(/#/g,"")),i.value=a}}),e.jsx("input",{type:"color",value:h.variants?.[l]?.color||"#000000",onChange:t=>D(`variants.${l}.color`,t.target.value),className:"w-[53px] h-[53px] mt-5 rounded border border-gray-300 cursor-pointer flex-shrink-0"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsx(g,{name:`variants.${l}.quantity`,label:"Quantity",placeholder:"10",type:"number",className:"text-sm",min:"1",step:"1",onInput:t=>{const i=t.currentTarget,a=i.value.replace(/[^0-9]/g,"");i.value=a.replace(/^0+/,"")||""},onKeyDown:t=>{[".","-","+","e","E"].includes(t.key)&&t.preventDefault()}})}),e.jsx("div",{children:e.jsx(g,{name:`variants.${l}.price`,label:"Price ($)",placeholder:"$99.99",type:"text",className:"text-sm",onInput:t=>{const i=t.currentTarget,p=i.value.replace(/[^0-9.]/g,""),o=p.split(".");o.length>2?i.value=o[0]+"."+o.slice(1).join(""):o.length===2&&o[1].length>2?i.value=o[0]+"."+o[1].substring(0,2):i.value=p}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{name:`variants.${l}.discount.discountType`,label:"Discount Type",placeholder:"Select Discount Type",options:[{value:"none",label:"No Discount"},{value:"flat",label:"Flat Amount"},{value:"percentage",label:"Percentage"}],className:"text-sm h-[53px]"}),h.variants?.[l]?.discount?.discountType!=="none"&&e.jsx(g,{name:`variants.${l}.discount.discountValue`,label:"",placeholder:h.variants?.[l]?.discount?.discountType==="percentage"?"10%":"10.00",className:"text-sm h-[53px]",type:"text",min:"0",onInput:t=>{const i=t.currentTarget,a=i.value,p=h.variants?.[l]?.discount?.discountType==="percentage";let o=a.replace(/[^0-9.]/g,"");o=o.replace(/^-/,"");const j=o.split(".");if(j.length>2&&(o=j[0]+"."+j.slice(1).join("")),j.length===2&&j[1].length>2&&(o=j[0]+"."+j[1].substring(0,2)),p){const se=parseFloat(o);!isNaN(se)&&se>100&&(o="100")}i.value=o},onKeyDown:t=>{t.key==="-"&&t.preventDefault()}})]})]})]},r.id))}),!T&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Add variants to offer different options like colors, sizes, or styles for your product."})]})]}),B===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Marketplace"}),e.jsxs("div",{className:"sm:space-y-2 flex flex-row sm:flex-col gap-2 items-center sm:items-start ",children:[e.jsxs("label",{htmlFor:"pickup",className:"flex items-center space-x-3 p-2 m-0 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(X,{id:"pickup",checked:h.marketplaceOptions?.pickup||!1,disabled:f,onCheckedChange:r=>{D("marketplaceOptions",{...h.marketplaceOptions,pickup:r}),H("marketplaceOptions")},className:"h-5 w-5 border-gray-300"}),e.jsx("span",{className:"text-sm font-medium leading-none",children:"Pickup"})]}),e.jsxs("label",{htmlFor:"shipping",className:"flex items-center space-x-3 p-2 m-0 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(X,{id:"shipping",checked:h.marketplaceOptions?.shipping||!1,disabled:f,onCheckedChange:r=>{D("marketplaceOptions",{...h.marketplaceOptions,shipping:r}),H("marketplaceOptions")},className:"h-5 w-5 border-gray-300"}),e.jsx("span",{className:"text-sm font-medium leading-none",children:"Shipping"})]}),e.jsxs("label",{htmlFor:"delivery",className:"flex items-center space-x-3 p-2 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(X,{id:"delivery",checked:h.marketplaceOptions?.delivery||!1,disabled:f,onCheckedChange:r=>{D("marketplaceOptions",{...h.marketplaceOptions,delivery:r}),H("marketplaceOptions")},className:"h-5 w-5 border-gray-300"}),e.jsx("span",{className:"text-sm font-medium leading-none",children:"Delivery"})]})]}),w.marketplaceOptions&&e.jsx("p",{className:"text-red-500",children:typeof w.marketplaceOptions=="object"&&"message"in w.marketplaceOptions?w.marketplaceOptions.message:"At least one marketplace option is required"})]}),h.marketplaceOptions?.pickup&&e.jsxs("div",{className:"mb-4 mt-2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",children:"Pickup Hours"}),e.jsx(ye,{value:h.pickupHours,onChange:r=>D("pickupHours",r)})]}),h.marketplaceOptions?.shipping&&e.jsx("div",{className:"mb-4",children:e.jsx(g,{disabled:f,name:"shippingPrice",label:"Shipping Price ($)",placeholder:"$10.00",type:"text",className:"border-gray-300 h-[53px]",onInput:r=>{const l=r.currentTarget,i=l.value.replace(/[^0-9.]/g,""),a=i.split(".");a.length>2?l.value=a[0]+"."+a.slice(1).join(""):a.length===2&&a[1].length>2?l.value=a[0]+"."+a[1].substring(0,2):l.value=i}})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Ready By"}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(g,{disabled:f,name:"readyByDate",label:"Ready By Date",type:"date",placeholder:"Select date",className:"border-gray-300 h-[53px] pr-10 cursor-pointer w-full [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-inner-spin-button]:hidden [&::-webkit-clear-button]:hidden",onClick:r=>{r.target.showPicker?.()}}),e.jsx(ve,{className:"absolute right-3 top-[38px] h-5 w-5 text-gray-400 pointer-events-none"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(g,{disabled:f,name:"readyByTime",label:"Choose Time",type:"time",placeholder:"Select time",className:"border-gray-300 h-[53px] pr-10 cursor-pointer w-full [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-inner-spin-button]:hidden [&::-webkit-clear-button]:hidden",onClick:r=>{r.target.showPicker?.()}}),e.jsx(pe,{className:"absolute right-3 top-[38px] h-5 w-5 text-gray-400 pointer-events-none"})]})})]})]})]}),e.jsxs("div",{className:"pt-4 space-y-4 flex-shrink-0 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:`h-1 flex-1 ${B>=1?"bg-primary":"bg-gray-200"} rounded-full`}),e.jsx("div",{className:`h-1 flex-1 ${B>=2?"bg-primary":"bg-gray-200"} rounded-full`})]}),B===1?e.jsx(O,{type:"button",onClick:oe,className:"w-full bg-gray-200 h-[48px] hover:bg-gray-300 text-gray-700 font-medium py-3 rounded-lg",children:"Next"}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(O,{type:"button",disabled:f,onClick:de,className:"bg-gray-200 h-[48px] hover:bg-gray-300 text-gray-700 font-medium py-3 rounded-lg",children:"Back"}),e.jsx(O,{disabled:f,type:"submit",className:"bg-primary h-[48px] hover:bg-primary/80 text-white font-medium py-3 rounded-lg",children:f?"Publishing...":"Publish"})]})]})]}),e.jsx(xe,{isOpen:!!L,onClose:()=>W(null),onConfirm:()=>{L&&(n(L),W(null))},title:"Delete Variant?",description:`Are you sure you want to delete Variant ${L?b.findIndex(r=>r.id===L)+1:""}? This action cannot be undone.`,confirmText:"Delete Variant",cancelText:"Cancel"})]})},Oe=({formValues:s,uploadedPhotos:x,existingImages:m=[],addressOptions:y=[],savedAddresses:N=[],variants:u,categoryOptions:k,subCategoryOptions:C,tagOptions:U,handleBackClick:b})=>{const[T,$]=E.useState(0),[v,q]=E.useState();E.useEffect(()=>{v&&v.on("select",()=>{$(v.selectedScrollSnap())})},[v]);const I=s.discount?.discountType==="percentage"&&s.discount?.discountValue?(parseFloat(s.price)*(1-parseFloat(s.discount.discountValue)/100)).toFixed(2):s.discount?.discountType==="flat"&&s.discount?.discountValue?(parseFloat(s.price)-parseFloat(s.discount.discountValue)).toFixed(2):s.price;return e.jsx("div",{className:"w-full lg:flex-1 h-full ",children:e.jsxs(G,{className:"p-4 sm:p-6 border-gray-200 h-full flex flex-col rounded-none border-none lg:border lg:rounded-sm ",children:[e.jsxs("div",{className:"flex  justify-between items-center gap-2 border-b border-gray-200 pb-4 ",children:[e.jsxs("div",{className:"",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Preview"}),e.jsx("p",{className:"text-sm text-gray-500",children:"See how your listing will appear"})]}),b&&e.jsx("button",{type:"button",onClick:b,className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(A,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-4 lg:gap-0 lg:flex-row rounded-lg overflow-hidden min-h-0",children:[e.jsx("div",{className:"w-full  lg:w-3/5  lg:h-full rounded-sm overflow-hidden  lg:rounded-e-none",children:m.length+x.length>=2?e.jsxs(he,{setApi:q,className:" min-h-[300px] min-w-[300px] rounded-sm w-full  flex-col lg:flex-row  lg:rounded-e-none lg:h-full bg-[#A9A9A9]   lg:rounded-l-lg  lg:py-20 lg:px-12 relative flex items-center ",children:[e.jsxs(ue,{children:[m.map((c,n)=>e.jsx(ae,{children:e.jsx("div",{className:"aspect-square relative  overflow-hidden border rounded-sm border-gray-400 shadow-2xl",children:e.jsx("img",{src:c,alt:`Product ${n+1}`,className:"w-full h-full object-cover "})})},`existing-${n}`)),x.map((c,n)=>e.jsx(ae,{children:e.jsx("div",{className:"aspect-square relative  overflow-hidden border rounded-sm border-gray-400 shadow-2xl",children:e.jsx("img",{src:URL.createObjectURL(c),alt:`Product ${m.length+n+1}`,className:"w-full h-full object-cover"})})},`upload-${n}`))]}),m.length+x.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"left-0 lg:left-[49px] bg-white shadow-md border-none hover:bg-gray-50 h-12 sm:h-16 md:h-20 rounded-l-sm"}),e.jsx(be,{className:"right-0 lg:right-[49px] bg-white border-none shadow-md hover:bg-gray-50 h-12 sm:h-16 md:h-20 rounded-r-sm"})]}),e.jsx("div",{className:"hidden sm:flex absolute   bottom-10 md:bottom-20 justify-center items-center text-white z-10 left-0 flex gap-2 w-full px-2",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 m-0 overflow-x-auto max-w-full",children:[m.map((c,n)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(n),children:e.jsx("img",{src:c,alt:`Product ${n+1}`,className:`${n===T?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`existing-thumb-${n}`)),x.map((c,n)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(m.length+n),children:e.jsx("img",{src:URL.createObjectURL(c),alt:`Product ${m.length+n+1}`,className:`${m.length+n===T?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`upload-thumb-${n}`))]})})]}):e.jsx("div",{className:"h-full bg-gray-100 rounded-t-lg sm:rounded-t-none sm:rounded-l-lg flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-600",children:"Your listing Preview"}),e.jsx("p",{className:"text-sm sm:text-base mt-4 text-red-500 font-medium",children:"Minimum 2 images required for preview"}),m.length+x.length===1&&e.jsxs("p",{className:"text-xs sm:text-sm mt-2 text-gray-500",children:["Please add ",2-(m.length+x.length)," more image(s) to see the preview"]}),m.length+x.length===0&&e.jsx("p",{className:"text-xs sm:text-sm mt-2 text-gray-500",children:"Please add at least 2 images to see how your listing will appear"})]})})}),e.jsx("div",{className:" sm:hidden justify-center items-center  flex gap-2 w-full px-2",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 m-0 overflow-x-auto max-w-full",children:[m.map((c,n)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(n),children:e.jsx("img",{src:c,alt:`Product ${n+1}`,className:`${n===T?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`existing-thumb-${n}`)),x.map((c,n)=>e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 flex-shrink-0 cursor-pointer",onClick:()=>v?.scrollTo(m.length+n),children:e.jsx("img",{src:URL.createObjectURL(c),alt:`Product ${m.length+n+1}`,className:`${m.length+n===T?"border-2 border-primary shadow-2xl":"border-2 border-transparent"} w-full h-full object-cover rounded-sm transition-all duration-200 hover:border-primary/50`})},`upload-thumb-${n}`))]})}),e.jsxs("div",{className:"w-full lg:w-2/5 p-3 sm:p-4 md:p-6 border border-gray-200 rounded-sm lg:rounded-l-none lg:rounded-r-lg lg:overflow-y-auto min-h-0",children:[e.jsxs("div",{className:"pb-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 mb-2",children:s.title||"Product Title"}),e.jsxs("div",{className:"flex  items-baseline gap-2",children:[e.jsx("div",{className:"text-xl font-medium text-gray-900 max-content",children:s.discount?.discountType!=="none"&&s.discount?.discountValue?e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["$",s.price]}),e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",I||"0.00"]}),e.jsx(z,{variant:"destructive",className:"text-xs bg-primary text-white",children:s.discount.discountType==="percentage"?`${s.discount.discountValue}% OFF`:`$${s.discount.discountValue} OFF`})]}):e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",s.price||"0.00"]})}),s.category&&e.jsxs("div",{className:"text-gray-600",children:["/"," ",k.find(c=>c.value===s.category)?.label||s.category]}),s.discount?.discountType!=="none"&&s.discount?.discountValue&&e.jsx(z,{variant:"destructive",className:"text-xs ml-2",children:s.discount.discountType==="percentage"?`${s.discount.discountValue}% OFF`:`$${s.discount.discountValue} OFF`})]})]}),s.subCategory&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Sub Category"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:C.find(c=>c.value===s.subCategory)?.label||s.subCategory})]}),s.quantity&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Quantity"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:s.quantity})]}),s.brand&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Brand"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:s.brand})]}),(s.color||u.length>0&&s.variants&&s.variants.some(c=>c.color))&&e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:["Color",u.length>0&&s.variants&&s.variants.filter(c=>c.color).length>0?"s":""]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.color&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border border-gray-300 shadow-sm",style:{backgroundColor:s.color}}),e.jsx("span",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:s.color})]}),u.length>0&&s.variants&&s.variants.filter(c=>c.color).map((c,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border border-gray-300 shadow-sm",style:{backgroundColor:c.color}}),e.jsx("span",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:c.color})]},n))]})]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Product Tag"}),s.productTag&&s.productTag.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.productTag.map((c,n)=>e.jsx(z,{variant:"secondary",className:"bg-blue-50 text-primary border border-blue-200 hover:bg-blue-100",children:typeof c=="string"?c:U.find(d=>d.value===c)?.label||c},n))}):"Tags will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Dimensions"}),s.dimensions?.width||s.dimensions?.length||s.dimensions?.height?e.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[s.dimensions.width&&`W: ${s.dimensions.width}"`,s.dimensions.width&&s.dimensions.length&&" × ",s.dimensions.length&&`L: ${s.dimensions.length}"`,s.dimensions.length&&s.dimensions.height&&" × ",s.dimensions.height&&`H: ${s.dimensions.height}"`]}):"Dimensions will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:s.locationIds.length>1?"Locations":"Location"}),s.locationIds&&s.locationIds.length>0?e.jsx("div",{className:"space-y-3",children:s.locationIds.map(c=>{const n=N.find(d=>(d.id||d._id)===c);if(!n){const d=y.find(M=>M.value===c);return e.jsx("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:e.jsx("p",{className:"font-medium",children:d?.label||c})},c)}return e.jsxs("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsx("p",{className:"text-gray-500 mt-1",children:n.formattedAddress}),s.availabilityRadius&&e.jsxs("p",{className:"text-gray-500 mt-1",children:["Delivery within ",s.availabilityRadius," km"]})]},c)})}):"Locations will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Delivery Options"}),s.marketplaceOptions?.pickup||s.marketplaceOptions?.shipping||s.marketplaceOptions?.delivery?e.jsxs("div",{className:"space-y-2",children:[s.marketplaceOptions?.pickup&&e.jsxs("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pickup"}),s.pickupHours&&e.jsxs("span",{children:[": ",s.pickupHours]})]}),s.marketplaceOptions?.shipping&&e.jsxs("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Shipping"}),s.shippingPrice&&e.jsxs("span",{children:[": $",s.shippingPrice]})]}),s.marketplaceOptions?.delivery&&e.jsx("div",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:e.jsx("span",{className:"font-medium",children:"Delivery Available"})})]}):"Delivery Options will appear here"]}),e.jsxs("div",{className:"py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Ready By"}),s.readyByDate||s.readyByTime?e.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-gray-600",children:[s.readyByDate&&new Date(s.readyByDate).toLocaleDateString(),s.readyByTime&&` at ${s.readyByTime}`]}):"Ready By will appear here"]}),e.jsxs("div",{className:"py-4",children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Description"}),s.description?e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-600 leading-relaxed whitespace-pre-line",children:s.description}):"Description will appear here"]}),u.length>0?e.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Available Variants (",u.filter((c,n)=>s.variants?.[n]?.color&&s.variants?.[n]?.price&&s.variants?.[n]?.quantity).length,")"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[u.map((c,n)=>{const d=s.variants?.[n];if(!d?.color||!d?.price||!d?.quantity)return null;const M=d.discount?.discountType==="percentage"&&d.discount?.discountValue?(parseFloat(d.price)*(1-parseFloat(d.discount.discountValue)/100)).toFixed(2):d.discount?.discountType==="flat"&&d.discount?.discountValue?(parseFloat(d.price)-parseFloat(d.discount.discountValue)).toFixed(2):d.price;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 bg-white h-full",children:e.jsxs("div",{className:"flex gap-3",children:[c.images.length>0&&e.jsxs("div",{className:"relative w-16 h-16 rounded overflow-hidden bg-gray-100 flex-shrink-0",children:[e.jsx("img",{src:URL.createObjectURL(c.images[0]),alt:`Variant ${n+1}`,className:"w-full h-full object-cover"}),c.images.length>1&&e.jsxs("div",{className:"absolute bottom-0 right-0 bg-black/50 text-white text-xs px-1 rounded-tl",children:["+",c.images.length-1]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-300",style:{backgroundColor:d.color},title:d.color}),e.jsxs("span",{className:"text-sm font-medium",children:["Variant ",n+1]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Stock: ",d.quantity," units"]})]}),e.jsx("div",{className:"text-right",children:d.discount?.discountType!=="none"&&d.discount?.discountValue?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["$",d.price]}),e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",M]}),e.jsx(z,{variant:"destructive",className:"text-xs mt-1",children:d.discount.discountType==="percentage"?`${d.discount.discountValue}% OFF`:`$${d.discount.discountValue} OFF`})]}):e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",d.price]})})]})})]})},n)}),u.length>0&&!u.some((c,n)=>s.variants?.[n]?.color&&s.variants?.[n]?.price&&s.variants?.[n]?.quantity)&&e.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"Complete variant details to see them here"})]})]}):"Variants will appear here"]})]})]})})},R={MAX_FILE_SIZE:5*1024*1024,MIN_WIDTH:400,MIN_HEIGHT:400},Ne=async s=>s.type.startsWith("image/")?s.size>R.MAX_FILE_SIZE?{valid:!1,error:`Selected image is ${(s.size/1048576).toFixed(1)}MB. Maximum size is 5MB allowed`}:new Promise(x=>{const m=new Image,y=URL.createObjectURL(s);m.onload=()=>{URL.revokeObjectURL(y),m.width<R.MIN_WIDTH||m.height<R.MIN_HEIGHT?x({valid:!1,error:`Image is ${m.width}x${m.height}px. Minimum size required is ${R.MIN_WIDTH}x${R.MIN_HEIGHT}px`}):x({valid:!0})},m.onerror=()=>{URL.revokeObjectURL(y),x({valid:!1,error:`Failed to load image "${s.name}"`})},m.src=y}):{valid:!1,error:`"${s.name}" is not an image file`},Pe=async(s,x,m=0)=>{const y=x-m,N=[],u=[];if(m>=x)return u.push(`Maximum ${x} images allowed`),{validFiles:N,errors:u};for(let k=0;k<Math.min(s.length,y);k++){const C=await Ne(s[k]);C.valid?N.push(s[k]):C.error&&u.push(C.error)}return s.length>y&&u.push(`Only ${y} more image(s) can be added (max ${x} total)`),{validFiles:N,errors:u}};export{Oe as P,De as a,Pe as v};
