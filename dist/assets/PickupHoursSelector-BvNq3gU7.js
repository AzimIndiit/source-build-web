import{ag as T,r as i,j as l,B as $}from"./index-BCiIUrXb.js";const x=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],k=T.memo(({day:p,hours:m,onUpdateTime:u,onUpdateClosed:f,onApplyToAll:h})=>l.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[l.jsx("span",{className:"w-12 font-medium text-sm",children:p}),l.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[l.jsx("input",{type:"time",value:m.open,disabled:m.closed,onChange:d=>u(p,"open",d.target.value),onClick:d=>d.target.showPicker?.(),className:"border border-gray-300 rounded-md px-2 py-1 text-sm disabled:bg-gray-100 h-8 w-28 cursor-pointer"}),l.jsx("span",{className:"text-gray-500 text-sm",children:"to"}),l.jsx("input",{type:"time",value:m.close,min:m.open,disabled:m.closed,onChange:d=>u(p,"close",d.target.value),onClick:d=>d.target.showPicker?.(),className:"border border-gray-300 rounded-md px-2 py-1 text-sm disabled:bg-gray-100 h-8 w-28 cursor-pointer"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[l.jsx("input",{type:"checkbox",checked:m.closed,onChange:d=>f(p,d.target.checked),className:"h-4 w-4 rounded border-gray-300"}),"Closed"]}),l.jsx($,{type:"button",variant:"outline",size:"sm",onClick:()=>h(p),className:"!text-xs whitespace-nowrap h-7 border-primary text-primary hover:text-primary",children:"Apply to All"})]})]}));k.displayName="DayRow";const v=T.memo(({value:p,onChange:m})=>{const[u,f]=i.useState(()=>x.reduce((e,t)=>(e[t]={open:"09:00",close:"17:00",closed:!1},e),{})),[h,d]=i.useState([]),g=i.useCallback(e=>{const t={Mon:0,Monday:0,Tue:1,Tuesday:1,Wed:2,Wednesday:2,Thu:3,Thursday:3,Fri:4,Friday:4,Sat:5,Saturday:5,Sun:6,Sunday:6},o=[];if(e.includes("–")||e.includes("-")){const s=e.split(/[–-]/);if(s.length===2){const r=s[0].trim(),c=s[1].trim(),a=t[r],n=t[c];if(a!==void 0&&n!==void 0)for(let y=a;y<=n;y++)o.push(x[y])}}else{const s=e.trim(),r=t[s];r!==void 0&&o.push(x[r])}return o},[]),C=i.useCallback(e=>{try{const t={};return x.forEach(s=>{t[s]={open:"09:00",close:"17:00",closed:!1}}),e.split(",").map(s=>s.trim()).forEach(s=>{if(!s.toLowerCase().includes("holiday"))if(s.includes("Closed")){const r=s.replace("Closed","").trim();g(r).forEach(a=>{t[a]={open:"09:00",close:"17:00",closed:!0}})}else{const r=s.match(/^(.+?)\s+(\d{2}:\d{2})[–-](\d{2}:\d{2})$/);if(r){const[,c,a,n]=r;g(c).forEach(E=>{t[E]={open:a,close:n,closed:!1}})}}}),t}catch(t){return console.error("Error parsing formatted string:",t),null}},[g]);i.useEffect(()=>{if(p)try{const e=JSON.parse(p);if(e.hours){const t={};Object.entries(e.hours).forEach(([o,s])=>{t[o]={open:s.open||"09:00",close:s.close||"17:00",closed:s.closed||!1}}),f(t)}e.holidays&&d(e.holidays)}catch{const e=C(p);e&&f(e)}},[]);const j=i.useCallback(e=>{const t={Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6,Sun:7},o=e.sort((a,n)=>t[a]-t[n]),s=[];let r=o[0],c=o[0];for(let a=1;a<o.length;a++)t[o[a]]!==t[c]+1&&(s.push(r===c?r:`${r}–${c}`),r=o[a]),c=o[a];return s.push(r===c?r:`${r}–${c}`),s.join(", ")},[]),b=i.useCallback((e,t=[])=>{const o=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],s={};o.forEach(c=>{const a=e[c];if(a.closed){const n="Closed";s[n]||(s[n]=[]),s[n].push(c)}else{const n=`${a.open}–${a.close}`;s[n]||(s[n]=[]),s[n].push(c)}});const r=Object.entries(s).map(([c,a])=>`${j(a)} ${c}`);return t.length>0&&t.some(c=>c)&&r.push(`Holidays: ${t.filter(Boolean).join(", ")}`),r.join(", ")},[j]),N=i.useCallback((e,t)=>{f(o=>({...o,[e]:{...o[e],closed:t}}))},[]),w=i.useCallback((e,t,o)=>{f(s=>{const r={...s},c=s[e];if(t==="open"&&o>=c.close){const a=new Date(`2000-01-01T${o}`);a.setHours(a.getHours()+1);const n=a.toTimeString().slice(0,5);r[e]={...c,open:o,close:n}}else{if(t==="close"&&o<=c.open)return s;r[e]={...c,[t]:o}}return r})},[]),S=i.useCallback(e=>{const t=u[e];f(x.reduce((o,s)=>(o[s]={...t},o),{}))},[u]);i.useEffect(()=>{if(!m)return;const e=setTimeout(()=>{const t=b(u,h);m(t)},500);return()=>clearTimeout(e)},[u,h]);const D=i.useMemo(()=>b(u,h)||"No pickup hours set",[u,h,b]);return l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"space-y-2",children:x.map(e=>l.jsx(k,{day:e,hours:u[e],onUpdateTime:w,onUpdateClosed:N,onApplyToAll:S},e))}),l.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[l.jsx("h3",{className:"font-medium text-sm mb-1 text-primary",children:"Preview"}),l.jsx("p",{className:"text-sm text-primary",children:D})]})]})});v.displayName="PickupHoursSelector";export{v as P};
