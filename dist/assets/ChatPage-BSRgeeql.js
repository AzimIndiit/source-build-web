import{V as G,j as e,aX as be,K as Ie,ay as De,S as l,N as Ce,u as Ze,ad as Ke,g as Ge,bX as Qe,r as x,bY as Xe,bZ as qe,b_ as Je,b$ as es,a6 as ue,a7 as xe,a8 as he,a9 as fe,D as ss,b as ts,B as k,c as as,e as rs,H as ge,Q as H,c0 as pe,c1 as Ne,c2 as D,aW as ns,ac as je,f as is,bw as ls,z as B,a5 as cs}from"./index-CUSVstqU.js";import{R as ds}from"./ReadMore-BauWGJlf.js";import{I as os}from"./ImagePreviewModal-B-qkumMp.js";import{E as ms}from"./ellipsis-vertical-CPx5VAQW.js";import{T as us}from"./trash-2-BLdsFbCa.js";import{c as Q,t as ye,m as Me,a as Se}from"./en-US-CPLesiGp.js";import{c as _e}from"./constructNow-CYnDNQGr.js";import{i as Te,a as xs}from"./isSameDay-CeY-boyx.js";import{f as Z}from"./format-Byp0gi1d.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],we=G("check-check",hs);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],gs=G("paperclip",fs);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ns=G("send",ps);function js(a,s){return Te(Q(a,a),_e(a))}function ys(a,s,t){return xs(a,-1,t)}function ws(a,s){return Te(Q(a,a),ys(_e(a)))}function ve(a,s){const t=()=>Q(s?.in,NaN),c=Ds(a);let f;if(c.date){const p=Cs(c.date,2);f=Ms(p.restDateString,p.year)}if(!f||isNaN(+f))return t();const C=+f;let M=0,j;if(c.time&&(M=Ss(c.time),isNaN(M)))return t();if(c.timezone){if(j=_s(c.timezone),isNaN(j))return t()}else{const p=new Date(C+M),_=ye(0,s?.in);return _.setFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()),_.setHours(p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCMilliseconds()),_}return ye(C+M+j,s?.in)}const Y={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},vs=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,bs=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Is=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ds(a){const s={},t=a.split(Y.dateTimeDelimiter);let r;if(t.length>2)return s;if(/:/.test(t[0])?r=t[0]:(s.date=t[0],r=t[1],Y.timeZoneDelimiter.test(s.date)&&(s.date=a.split(Y.timeZoneDelimiter)[0],r=a.substr(s.date.length,a.length))),r){const c=Y.timezone.exec(r);c?(s.time=r.replace(c[1],""),s.timezone=c[1]):s.time=r}return s}function Cs(a,s){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=a.match(t);if(!r)return{year:NaN,restDateString:""};const c=r[1]?parseInt(r[1]):null,f=r[2]?parseInt(r[2]):null;return{year:f===null?c:f*100,restDateString:a.slice((r[1]||r[2]).length)}}function Ms(a,s){if(s===null)return new Date(NaN);const t=a.match(vs);if(!t)return new Date(NaN);const r=!!t[4],c=O(t[1]),f=O(t[2])-1,C=O(t[3]),M=O(t[4]),j=O(t[5])-1;if(r)return zs(s,M,j)?Ts(s,M,j):new Date(NaN);{const p=new Date(0);return!Us(s,f,C)||!Fs(s,c)?new Date(NaN):(p.setUTCFullYear(s,f,Math.max(c,C)),p)}}function O(a){return a?parseInt(a):1}function Ss(a){const s=a.match(bs);if(!s)return NaN;const t=K(s[1]),r=K(s[2]),c=K(s[3]);return Es(t,r,c)?t*Me+r*Se+c*1e3:NaN}function K(a){return a&&parseFloat(a.replace(",","."))||0}function _s(a){if(a==="Z")return 0;const s=a.match(Is);if(!s)return 0;const t=s[1]==="+"?-1:1,r=parseInt(s[2]),c=s[3]&&parseInt(s[3])||0;return Ls(r,c)?t*(r*Me+c*Se):NaN}function Ts(a,s,t){const r=new Date(0);r.setUTCFullYear(a,0,4);const c=r.getUTCDay()||7,f=(s-1)*7+t+1-c;return r.setUTCDate(r.getUTCDate()+f),r}const ks=[31,null,31,30,31,30,31,31,30,31,30,31];function ke(a){return a%400===0||a%4===0&&a%100!==0}function Us(a,s,t){return s>=0&&s<=11&&t>=1&&t<=(ks[s]||(ke(a)?29:28))}function Fs(a,s){return s>=1&&s<=(ke(a)?366:365)}function zs(a,s,t){return s>=1&&s<=53&&t>=0&&t<=6}function Es(a,s,t){return a===24?s===0&&t===0:t>=0&&t<60&&s>=0&&s<60&&a>=0&&a<25}function Ls(a,s){return s>=0&&s<=59}const Os=()=>{const a=[{label:"Messages",href:"/seller/messages"},{label:"Chat Details",isCurrentPage:!0}];return e.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[e.jsx(be,{items:a}),e.jsxs(Ie,{className:"h-[calc(100vh-200px)] flex flex-col overflow-hidden border-gray-200",children:[e.jsxs(De,{className:"flex flex-row items-center justify-between p-4 border-b border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-5 w-32"}),e.jsx(l,{className:"h-3 w-12"})]})]}),e.jsx(l,{className:"h-8 w-8 rounded"})]}),e.jsxs(Ce,{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-white",children:[e.jsx("div",{className:"flex items-center justify-center my-4",children:e.jsx(l,{className:"h-6 w-20 rounded-full"})}),e.jsxs("div",{className:"flex items-start gap-2 justify-start",children:[e.jsx(l,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[70%] items-start space-y-2",children:[e.jsx(l,{className:"h-3 w-20"}),e.jsx(l,{className:"h-20 w-64 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})]}),e.jsx("div",{className:"flex items-start gap-2 justify-end",children:e.jsxs("div",{className:"flex flex-col max-w-[70%] items-end space-y-2",children:[e.jsx(l,{className:"h-16 w-48 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})}),e.jsxs("div",{className:"flex items-start gap-2 justify-start",children:[e.jsx(l,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[70%] items-start space-y-2",children:[e.jsx(l,{className:"h-3 w-20"}),e.jsx(l,{className:"h-12 w-56 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})]}),e.jsx("div",{className:"flex items-start gap-2 justify-end",children:e.jsxs("div",{className:"flex flex-col max-w-[70%] items-end space-y-2",children:[e.jsx(l,{className:"h-48 w-48 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})}),e.jsxs("div",{className:"flex items-start gap-2 justify-start",children:[e.jsx(l,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[70%] items-start space-y-2",children:[e.jsx(l,{className:"h-3 w-20"}),e.jsx(l,{className:"h-10 w-40 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})]})]}),e.jsx("div",{className:"border-t bg-white p-4 border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(l,{className:"h-12 w-full rounded-md"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[e.jsx(l,{className:"h-12 w-16 rounded"}),e.jsx(l,{className:"h-12 w-16 rounded"})]})]})})]})]})},Rs=()=>{const a=Ze(),t=Ke().id,{user:r}=Ge(),{emit:c,on:f,isConnected:C,off:M}=Qe(),[j,p]=x.useState(1),[_]=x.useState(20),[X,q]=x.useState(!0),[P,W]=x.useState(!1),{data:R,isLoading:Ue}=Xe(t),{data:U,isLoading:J,error:ee}=qe({chatId:t,page:j,limit:_}),{mutate:se}=Je(),{mutate:Fe}=es(),[F,b]=x.useState([]),[A,te]=x.useState(""),[y,V]=x.useState(null),[ae,re]=x.useState([]),[ze,ne]=x.useState(0),[Ee,ie]=x.useState(!1),I=x.useRef(null),T=x.useRef(null),[w,le]=x.useState(null),ce=x.useRef(0),z=x.useRef(!1);x.useEffect(()=>{if(R?.data?.participants&&r?.id){const n=R.data.participants.find(o=>(o?.id||o?._id)!==r.id);console.log("Current user ID:",r?.id),console.log("Participants:",R.data.participants),console.log("Other user found:",n),le(n?{...n,isOnline:!1}:null)}},[R,r?.id]),x.useEffect(()=>{j===1&&F.length>0&&de()},[F.length,j]),x.useEffect(()=>{if(U?.data){if(j===1)b(U.data);else if(b(n=>[...U.data,...n]),I.current){const o=I.current.scrollHeight-ce.current;I.current.scrollTop=o}q(U.data.length===_),W(!1)}},[U,j,_]),x.useEffect(()=>{t&&r?.id&&se(t)},[t,r?.id,se]),x.useEffect(()=>{p(1),q(!0),W(!1),b([])},[t]),x.useEffect(()=>{z.current&&F.length>0&&setTimeout(()=>{de(),z.current=!1},50)},[F]),x.useEffect(()=>{if(!t)return;const n=d=>{if(console.log("Frontend: Received new_message event:",d),d.chat&&d.chat.toString()!==t){console.log("Frontend: Message is for different chat, ignoring");return}b(g=>{if(d.tempId){const h=g.findIndex($=>$._id===d.tempId);if(h!==-1){console.log("Frontend: Replacing temp message with real message");const $=[...g];return $[h]={...d,senderId:d.sender||d.senderId,status:D.DELIVERED},c("mark_as_delivered",{messageId:d._id}),(d.sender===r?.id||d.senderId===r?.id)&&(z.current=!0),$}}const v=g.findIndex(h=>h._id===d._id);if(v!==-1){console.log("Frontend: Updating existing message");const h=[...g];return h[v]={...d,senderId:d.sender||d.senderId},h}return console.log("Frontend: Adding new message to chat"),z.current=!0,[...g,{...d,senderId:d.sender||d.senderId}]})},o=d=>{b(g=>{const v=g.findIndex(h=>h._id===d._id);if(v!==-1){const h=[...g];return h[v]={...h[v],...d,status:D.READ,senderId:d.sender||h[v].senderId},h}return g})},N=()=>{console.log("Frontend: Joining chat room with ID:",t),c("join_chat",{roomId:t})};C()&&N();const u=f("connect",N);console.log("Frontend: Setting up new_message listener for chat:",t);const i=f("new_message",n),S=f("message_delivered",d=>{b(g=>{const v=g.findIndex(h=>h._id===d._id);if(v!==-1){const h=[...g];return h[v]={...h[v],...d,status:D.DELIVERED,senderId:d.sender||h[v].senderId},h}return g})}),E=d=>{le(g=>g?.id===d.userId?{...g,isOnline:d.is_online}:g)},L=f("message_read",o),Ve=f("is_online",E);return()=>{C()&&c("leave_chat",{roomId:t}),u(),i(),S(),L(),Ve()}},[t,c,f,M,C,r?.id]);const de=()=>{I.current&&(I.current.scrollTop=I.current.scrollHeight)},Le=()=>{!I.current||P||!X||I.current.scrollTop===0&&Oe()},Oe=async()=>{P||!X||(W(!0),I.current&&(ce.current=I.current.scrollHeight),p(n=>n+1))},oe=async()=>{if(!A.trim()&&!y||!r?.id||!t)return;const n=Date.now().toString(),o=A.trim(),N=y;if(te(""),V(null),z.current=!0,N){const u={_id:n,messageType:"file",content:o,sentAt:new Date().toISOString(),senderId:r.id,status:D.SENDING,attachments:[{_id:n+"_file",id:n+"_file",originalName:N.name,mimeType:N.type,mimetype:N.type,url:URL.createObjectURL(N),size:N.size,uploading:!0}]};b(i=>[...i,u]),cs.uploadFile(N).then(i=>{if(i.status==="success"){const m={_id:i.data.id,id:i.data.id,originalName:i.data.originalName,mimeType:i.data.mimeType,url:i.data.url,size:i.data.size,bestImageUrl:i.data.bestImageUrl||"",bestMediaUrl:i.data.bestMediaUrl||"",thumbnailUrl:i.data.thumbnailUrl||"",streamingUrl:i.data.streamingUrl||null,isImage:i.data.isImage||!1,isVideo:i.data.isVideo||!1},S={_id:n,messageType:"file",content:o,sentAt:u.sentAt,senderId:r.id,status:D.SENT,chatId:t,attachments:[{_id:m.id}]};c("send_message",S),b(E=>E.map(L=>L._id===n?{...L,attachments:[m]}:L))}else B.error("Failed to upload file"),b(m=>m.filter(S=>S._id!==n))}).catch(i=>{console.error("File upload error:",i),B.error("Failed to upload file"),b(m=>m.filter(S=>S._id!==n))})}else{const u={_id:n,messageType:"text",content:o,sentAt:new Date().toISOString(),senderId:r.id,status:D.SENDING,attachments:void 0};b(m=>[...m,u]);const i={...u,chatId:t,attachments:[]};c("send_message",i)}},Re=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),oe())},Ae=n=>{const o=n.target.files?.[0];if(o){if(o.size>5*1024*1024){B.error("File size must be less than 5MB");return}V(o),T.current&&(T.current.value="")}},me=()=>{V(null),T.current&&(T.current.value="")},$e=()=>{t&&Fe(t,{onSuccess:()=>{B.success("Chat deleted successfully"),a(`/${r?.role}/messages`)}})},He=n=>{re([n]),ne(0)},Be=n=>n.reduce((o,N)=>{const u=Z(ve(N.sentAt),"yyyy-MM-dd");return o[u]||(o[u]=[]),o[u].push(N),o},{}),Ye=n=>{const o=new Date(n);return js(o)?"Today":ws(o)?"Yesterday":Z(o,"MMM dd, yyyy")},Pe=n=>n===D.SENDING?e.jsx("p",{className:"text-[10px] text-gray-500",children:"sending..."}):n===D.DELIVERED?e.jsx(we,{className:"w-4 h-4 text-gray-400"}):n===D.READ?e.jsx(we,{className:"w-4 h-4 text-primary"}):e.jsx(ls,{className:"w-4 h-4 text-gray-400"}),We=[{label:"Messages",href:r?.role==="buyer"?"/messages":`/${r?.role}/messages`},{label:"Chat Details",isCurrentPage:!0}];return Ue?e.jsx(Os,{}):e.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[r?.role!="admin"&&e.jsx(be,{items:We}),e.jsxs(Ie,{className:"h-[calc(100vh-200px)] flex flex-col overflow-hidden border-gray-200",children:[e.jsxs(De,{className:"flex flex-row items-center justify-between p-4 border-b border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ue,{className:"h-10 w-10",children:[e.jsx(xe,{src:w?.avatar,alt:w?.displayName}),e.jsx(he,{className:"bg-gray-200",children:w?fe(w.displayName):"?"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 capitalize",children:w?.displayName||"Loading..."}),e.jsx("p",{className:`xtext-sm mt-1 ${w?.isOnline?"text-green-500":"text-red-500"}`,children:w?.isOnline?"Online":"Offline"})]})]}),e.jsxs(ss,{children:[e.jsx(ts,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ms,{className:"h-4 w-4"})})}),e.jsx(as,{align:"end",children:e.jsxs(rs,{className:"text-red-600 cursor-pointer",onClick:()=>ie(!0),children:[e.jsx(us,{className:"w-4 h-4 mr-2"}),"Delete Chat"]})})]})]}),e.jsxs(Ce,{ref:I,className:"flex-1 overflow-y-auto p-4 space-y-2 bg-white",onScroll:Le,children:[J&&j===1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center my-4",children:e.jsx(l,{className:"h-6 w-20 rounded-full"})}),[...Array(5)].map((n,o)=>e.jsx("div",{className:"space-y-4",children:o%2===0?e.jsxs("div",{className:"flex items-start gap-2 justify-start",children:[e.jsx(l,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[70%] items-start space-y-2",children:[e.jsx(l,{className:"h-3 w-20"}),e.jsx(l,{className:"h-16 w-56 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})]}):e.jsx("div",{className:"flex items-start gap-2 justify-end",children:e.jsxs("div",{className:"flex flex-col max-w-[70%] items-end space-y-2",children:[e.jsx(l,{className:"h-12 w-48 rounded-2xl"}),e.jsx(l,{className:"h-3 w-16"})]})})},o))]}),ee&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-red-500",children:"Failed to load messages"})}),(!J||j>1)&&!ee&&e.jsxs(e.Fragment,{children:[P&&e.jsxs("div",{className:"flex items-center justify-center py-2",children:[e.jsx(ge,{className:"h-5 w-5 animate-spin text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Loading previous messages..."})]}),Object.entries(Be(F)).map(([n,o],N)=>e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-center my-4",children:e.jsx("div",{className:"bg-gray-100 px-3 py-1 rounded-full",children:e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:Ye(n)})})}),o.map(u=>{const i=u.senderId===r?.id||u?.sender?.id===r?.id;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:H("flex items-start gap-2",i?"justify-end":"justify-start"),children:[!i&&e.jsxs(ue,{className:"h-10 w-10 mt-1",children:[e.jsx(xe,{src:w?.avatar,alt:w?.displayName}),e.jsx(he,{className:"bg-gray-200 text-sm",children:w?fe(w.displayName):"?"})]}),e.jsxs("div",{className:H("flex flex-col max-w-[70%]",i?"items-end":"items-start"),children:[!i&&w&&e.jsx("span",{className:"text-xs text-gray-500 mb-1 px-1",children:w.displayName}),e.jsxs("div",{className:H("px-4 py-2 rounded-2xl break-words",i?"bg-primary text-white":"bg-gray-200 border border-gray-200"),children:[u.attachments&&u.attachments.length>0&&u.attachments.map((m,S)=>{const E=m.mimeType?.startsWith("image/")||m.mimetype?.startsWith("image/")||m.url?.includes("image/upload")||m.url?.match(/\.(jpg|jpeg|png|gif|webp|svg)$/i);return e.jsxs("div",{className:"mb-2 relative",children:[m.uploading&&e.jsxs("div",{className:"absolute inset-0 bg-black/50 rounded-lg flex flex-col items-center justify-center z-10",children:[e.jsx(ge,{className:"h-8 w-8 text-white animate-spin mb-2"}),e.jsx("span",{className:"text-white text-sm font-medium",children:"Uploading..."})]}),E?e.jsx("img",{src:m.url||m.bestImageUrl||m.thumbnailUrl,alt:m.originalName||"attachment",className:"rounded-lg max-w-full cursor-pointer object-cover",style:{height:"200px",width:"200px"},onClick:()=>!m.uploading&&He(m.url||m.bestImageUrl||"")}):e.jsx("div",{className:"flex items-center gap-2 flex-col justify-center h-full w-full bg-gray-100 rounded-sm cursor-pointer",style:{height:"200px",width:"200px"},children:e.jsxs("a",{href:m.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 flex-col",children:[e.jsx(pe,{className:"h-5 w-5 text-gray-500"}),e.jsx("div",{className:"",children:e.jsx("p",{className:"text-xs font-medium text-gray-700 truncate",title:m.originalName||"attachment",children:Ne(m.originalName||"attachment",10)})})]})})]},S)}),u.content&&e.jsx(ds,{text:u.content,maxLength:1e3,className:` ${i?"text-white hover:text-white":"text-gray-700"}  `,buttonClassName:`${i?"text-white hover:text-white":"text-gray-700"} !text-sm`})]}),e.jsxs("div",{className:H("flex items-center gap-1 mt-1 px-1",i?"justify-end":"justify-start"),children:[e.jsx("span",{className:"text-xs text-gray-500",children:u.status!==D.SENDING&&Z(ve(u.sentAt),"h:mm a")}),i&&Pe(u.status)]})]})]}),u._id==="2"&&e.jsx("div",{className:"flex justify-end",children:e.jsx(k,{variant:"default",size:"sm",className:"bg-primary hover:bg-blue-700 text-white",children:"Hi!"})})]},u._id)})]},N))]})]}),e.jsxs("div",{className:"border-t bg-white p-4 border-gray-200 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ns,{type:"text",placeholder:"Type a message",value:A,onChange:n=>te(n.target.value),onKeyDown:Re,className:"w-full pr-32 bg-gray-50"}),e.jsx("input",{type:"file",ref:T,className:"hidden",accept:"image/*,application/pdf,.doc,.docx",onChange:Ae}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"h-12 w-16 bg-gray-100 hover:bg-gray-200",onClick:()=>T.current?.click(),children:e.jsx(gs,{className:"h-4 w-4 text-gray-500"})}),e.jsx(k,{size:"icon",onClick:oe,disabled:!A.trim()&&!y,className:"h-12 w-16 bg-primary hover:bg-primary/80",children:e.jsx(Ns,{className:"h-4 w-4 text-white"})})]})]}),y&&e.jsx("div",{className:"mt-2 inline-block",children:e.jsx("div",{className:"relative group bg-gray-100 rounded-lg inline-block",children:y.type.startsWith("image/")?e.jsxs("div",{className:"relative w-20 h-20",children:[e.jsx("img",{src:URL.createObjectURL(y),alt:y.name,className:"w-full h-full object-cover rounded-sm"}),e.jsx(k,{variant:"ghost",size:"icon",className:"absolute top-[-5px] right-[-5px] h-6 w-6 bg-red-500 hover:bg-red-600 transition-opacity rounded-full",onClick:me,children:e.jsx(je,{className:"h-3 w-3 text-white"})})]}):e.jsxs("div",{className:"flex relative flex-col items-center gap-2 p-2 h-20 w-20",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-col justify-center",children:[e.jsx(pe,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 truncate",title:y.name,children:Ne(y.name,10)}),e.jsx("p",{className:"text-xs text-gray-500",children:y.size<1024?`${y.size} B`:y.size<1024*1024?`${(y.size/1024).toFixed(1)} KB`:`${(y.size/(1024*1024)).toFixed(1)} MB`})]})]}),e.jsx(k,{variant:"ghost",size:"icon",className:"absolute top-[-5px] right-[-5px] h-6 w-6 bg-red-500 hover:bg-red-600 transition-opacity rounded-full",onClick:me,children:e.jsx(je,{className:"h-3 w-3 text-white"})})]})})})]})]}),e.jsx(os,{images:ae,open:ae.length>0,onClose:()=>re([]),currentIndex:ze,setCurrentIndex:ne}),e.jsx(is,{isOpen:Ee,onClose:()=>ie(!1),onConfirm:$e,title:"Delete Chat",description:"Are you sure you want to delete this chat? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel"})]})},Ks=()=>e.jsx(Rs,{});export{Ks as default};
