import{bD as fe,bE as _,bF as be,bG as re,aJ as ye,bH as je,bI as ve,r as g,bJ as Ne,bK as we,bL as ke,bM as Ce,bN as J,bO as X,bP as Re,bQ as Se,j as e,S as c,n as N,E as Oe,z as P,G as D,ae as Pe,af as qe,ag as Ie,aD as Qe,aE as Te,B as S,K as $e,N as Ee,ad as Ae,u as Fe,g as Me,aZ as De,aX as Le,Y as _e,X as Be,ai as We,ab as ze,M as He,b8 as Ve,b9 as Ue,aO as Ke,bR as Ge}from"./index-CUSVstqU.js";import{B as L}from"./badge-c_xwgsXg.js";import{R as Je}from"./ReadMore-BauWGJlf.js";import{f as Xe,R as Ye}from"./ProductDetailsPage-DqhKD1S8.js";import{S as ae}from"./StarRating-sEf5bhyI.js";import{p as Y}from"./useProductMutations-CP-SVJ5v.js";import{m as Z,L as ee}from"./LazyImage-D5w62-6q.js";import{u as Ze,a as es}from"./useWishlist-DogIdL_T.js";import{g as ss,P as ts}from"./ProductCard-Bxz0lhNv.js";import{g as I}from"./colorUtils-BjIcJb6R.js";import{C as rs}from"./CustomerDetailsSection-Bh0WC976.js";import{M as as}from"./minus-Cdk7QGCs.js";import{P as is}from"./pen-DY7MLpXg.js";import"./date-utils-CIparGJB.js";import"./format-Byp0gi1d.js";import"./en-US-CPLesiGp.js";function se(i,r){const l=new Set(r);return i.filter(n=>!l.has(n))}function ls(i,r,l){const n=i.slice(0);return n[r]=l,n}var ns=class extends fe{#r;#e;#a;#i;#s;#t;#l;#n;#o=[];constructor(i,r,l){super(),this.#r=i,this.#i=l,this.#a=[],this.#s=[],this.#e=[],this.setQueries(r)}onSubscribe(){this.listeners.size===1&&this.#s.forEach(i=>{i.subscribe(r=>{this.#u(i,r)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#s.forEach(i=>{i.destroy()})}setQueries(i,r){this.#a=i,this.#i=r,_.batch(()=>{const l=this.#s,n=this.#m(this.#a);this.#o=n,n.forEach(m=>m.observer.setOptions(m.defaultedQueryOptions));const d=n.map(m=>m.observer),u=d.map(m=>m.getCurrentResult()),a=d.some((m,x)=>m!==l[x]);l.length===d.length&&!a||(this.#s=d,this.#e=u,this.hasListeners()&&(se(l,d).forEach(m=>{m.destroy()}),se(d,l).forEach(m=>{m.subscribe(x=>{this.#u(m,x)})}),this.#x()))})}getCurrentResult(){return this.#e}getQueries(){return this.#s.map(i=>i.getCurrentQuery())}getObservers(){return this.#s}getOptimisticResult(i,r){const l=this.#m(i),n=l.map(d=>d.observer.getOptimisticResult(d.defaultedQueryOptions));return[n,d=>this.#d(d??n,r),()=>this.#c(n,l)]}#c(i,r){return r.map((l,n)=>{const d=i[n];return l.defaultedQueryOptions.notifyOnChangeProps?d:l.observer.trackResult(d,u=>{r.forEach(a=>{a.observer.trackProp(u)})})})}#d(i,r){return r?((!this.#t||this.#e!==this.#n||r!==this.#l)&&(this.#l=r,this.#n=this.#e,this.#t=be(this.#t,r(i))),this.#t):i}#m(i){const r=new Map(this.#s.map(n=>[n.options.queryHash,n])),l=[];return i.forEach(n=>{const d=this.#r.defaultQueryOptions(n),u=r.get(d.queryHash);u?l.push({defaultedQueryOptions:d,observer:u}):l.push({defaultedQueryOptions:d,observer:new re(this.#r,d)})}),l}#u(i,r){const l=this.#s.indexOf(i);l!==-1&&(this.#e=ls(this.#e,l,r),this.#x())}#x(){if(this.hasListeners()){const i=this.#t,r=this.#c(this.#e,this.#o),l=this.#d(r,this.#i?.combine);i!==l&&_.batch(()=>{this.listeners.forEach(n=>{n(this.#e)})})}}};function te({queries:i,...r},l){const n=ye(),d=je(),u=ve(),a=g.useMemo(()=>i.map(s=>{const h=n.defaultQueryOptions(s);return h._optimisticResults=d?"isRestoring":"optimistic",h}),[i,n,d]);a.forEach(s=>{Ne(s),we(s,u)}),ke(u);const[m]=g.useState(()=>new ns(n,a,r)),[x,y,w]=m.getOptimisticResult(a,r.combine),k=!d&&r.subscribed!==!1;g.useSyncExternalStore(g.useCallback(s=>k?m.subscribe(_.batchCalls(s)):Ce,[m,k]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),g.useEffect(()=>{m.setQueries(a,r)},[a,r,m]);const j=x.some((s,h)=>J(a[h],s))?x.flatMap((s,h)=>{const b=a[h];if(b){const q=new re(n,b);if(J(b,s))return X(b,q,u);Re(s,d)&&X(b,q,u)}return[]}):[];if(j.length>0)throw Promise.all(j);const R=x.find((s,h)=>{const b=a[h];return b&&Se({result:s,errorResetBoundary:u,throwOnError:b.throwOnError,query:n.getQueryCache().get(b.queryHash),suspense:b.suspense})});if(R?.error)throw R.error;return y(w())}const os=()=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"})]}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-20"})]}),e.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((i,r)=>e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"},r))}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})]})]})}),cs=()=>e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-4 w-12"}),e.jsx(c,{className:"h-4 w-2"}),e.jsx(c,{className:"h-4 w-20"}),e.jsx(c,{className:"h-4 w-2"}),e.jsx(c,{className:"h-4 w-24"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-12",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx(c,{className:"w-full h-[250px] sm:h-[350px] md:h-[400px] rounded-sm"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{className:"absolute left-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full"}),e.jsx("div",{className:"flex gap-2 sm:gap-3 mx-10 sm:mx-12 md:mx-14",children:Array.from({length:3}).map((i,r)=>e.jsx(c,{className:"flex-shrink-0 w-[80px] h-[60px] sm:w-[120px] sm:h-[80px] md:w-[150px] md:h-[100px] lg:w-[180px] lg:h-[120px] rounded-lg"},r))}),e.jsx(c,{className:"absolute right-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"h-8 sm:h-10 lg:h-12 w-full mb-3 sm:mb-4"}),e.jsx(c,{className:"h-6 sm:h-8 w-3/4 mb-2"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(c,{className:"h-8 sm:h-10 w-20"}),e.jsx(c,{className:"h-6 sm:h-8 w-16"}),e.jsx(c,{className:"h-6 w-12 rounded-full"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(c,{className:"h-4 w-20"}),e.jsx(c,{className:"h-4 w-24"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 sm:pt-6 space-y-2",children:[e.jsx(c,{className:"h-4 w-full"}),e.jsx(c,{className:"h-4 w-full"}),e.jsx(c,{className:"h-4 w-3/4"}),e.jsx(c,{className:"h-4 w-1/2"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsx(c,{className:"h-4 w-48"})}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsx(c,{className:"h-4 w-32"})}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:[e.jsx(c,{className:"h-4 w-16 mb-2"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:3}).map((i,r)=>e.jsx(c,{className:"h-6 w-16 rounded-full"},r))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:[e.jsx(c,{className:"h-4 w-16 mb-2"}),e.jsx("div",{className:"flex gap-3",children:Array.from({length:4}).map((i,r)=>e.jsx(c,{className:"w-12 h-12 rounded-full"},r))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4 pt-4 sm:pt-6",children:[e.jsx(c,{className:"w-full sm:flex-1 h-[48px] sm:h-[56px] rounded"}),e.jsx(c,{className:"w-full sm:flex-1 h-[48px] sm:h-[56px] rounded"})]})]})]}),e.jsxs("div",{className:"mt-8 sm:mt-12 border-t border-gray-200 pt-6 sm:pt-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx(c,{className:"h-6 sm:h-8 w-40 mb-3 sm:mb-4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex space-x-1",children:Array.from({length:5}).map((i,r)=>e.jsx(c,{className:"w-5 h-5"},r))}),e.jsx(c,{className:"h-4 w-20"})]})]}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:Array.from({length:3}).map((i,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsx(c,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"h-4 w-24"}),e.jsx(c,{className:"h-3 w-20"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"flex space-x-1",children:Array.from({length:5}).map((l,n)=>e.jsx(c,{className:"w-4 h-4"},n))})})]}),e.jsx(c,{className:"h-4 w-full"}),e.jsx(c,{className:"h-4 w-3/4"}),e.jsx(c,{className:"h-4 w-1/2"})]},r))})]})]});class ds{async createReview(r){return(await N.post("/reviews",r)).data}async getProductReviews(r,l){return(await N.get(`/reviews/products/${r}`,{params:l})).data}async getUserReviews(r){return(await N.get("/reviews/my-reviews",{params:r})).data}async updateReview(r,l){return(await N.put(`/reviews/${r}`,l)).data}async deleteReview(r){return(await N.delete(`/reviews/${r}`)).data}async markReviewHelpful(r,l){return(await N.post(`/reviews/${r}/helpful`,{helpful:l})).data}async addReviewResponse(r,l){return(await N.post(`/reviews/${r}/response`,{comment:l})).data}async updateReviewStatus(r,l,n){return(await N.put(`/reviews/${r}/status`,{status:l,reason:n})).data}}const ie=new ds,ms=()=>Oe({mutationFn:ie.createReview,onSuccess:i=>{D.invalidateQueries({queryKey:["reviews"]}),D.invalidateQueries({queryKey:["product-reviews"]}),D.invalidateQueries({queryKey:["user-reviews"]})},onError:i=>{const r=i.response?.data?.message||"Failed to submit review";P.error(r)}}),us=({isOpen:i,onClose:r,productId:l,orderId:n,onSuccess:d,existingReview:u})=>{const[a,m]=g.useState(0),[x,y]=g.useState(""),w=ms();Pe.useEffect(()=>{i&&(u&&u.id?(m(u.rating||0),y(u.comment||"")):(m(0),y("")))},[i,u]);const k=async()=>{if(a===0){P.error("Please select a rating");return}if(x.length<10){P.error("Comment must be at least 10 characters");return}try{await w.mutateAsync({type:"product",product:l,order:n,rating:a,comment:x}),P.success(u?"Review updated successfully!":"Review submitted successfully!"),m(0),y(""),d?.(),C()}catch(j){console.error("Failed to submit review:",j)}},C=()=>{m(0),y(""),r()};return e.jsx(qe,{open:i,onOpenChange:C,children:e.jsxs(Ie,{className:"sm:max-w-[500px] bg-white",children:[e.jsx(Qe,{children:e.jsx(Te,{className:"text-xl font-bold",children:u?"Edit Review & Rating":"Add Review & Rating"})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Rating"}),e.jsx(ae,{size:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8",rating:a,onRatingChange:j=>m(j)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Comment"}),e.jsx("textarea",{placeholder:"Share your experience with the seller...",className:"w-full min-h-[100px] sm:min-h-[120px] md:min-h-[150px] p-2 sm:p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none text-sm sm:text-base  leading-relaxed",value:x,maxLength:500,onChange:j=>y(j.target.value),rows:3})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(S,{variant:"outline",onClick:C,className:"px-6 w-[220px] border-gray-200 text-gray-600 ",children:"Cancel"}),e.jsx(S,{onClick:k,disabled:w.isPending||a===0||x.length<10,className:"bg-primary hover:bg-primary/90 text-white px-6 w-[220px]",children:w.isPending?"Submitting...":u?"Update Review":"Add Review"})]})]})})},xs=()=>e.jsxs($e,{className:"overflow-hidden border-none shadow-none bg-transparent p-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-full h-44 bg-gray-200 rounded-xl animate-pulse"}),e.jsx("div",{className:"absolute top-2 right-2 w-10 h-10 bg-gray-300 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute bottom-2 left-2 w-24 h-6 bg-gray-300 rounded animate-pulse"})]}),e.jsxs(Ee,{className:"p-3 space-y-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-24 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full animate-pulse"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 animate-pulse"})]})]})]}),qs=()=>{const{slug:i}=Ae(),r=Fe(),{user:l,isAuthenticated:n}=Me(),[d,u]=g.useState(0),[a,m]=g.useState(null),[x,y]=g.useState(1),[w,k]=g.useState(!1),C=g.useRef(null),j=g.useRef([]),R=te({queries:[{queryKey:["product",i],queryFn:()=>Y.getProductBySlug(i||""),enabled:!!i}]})[0],s=R.data?.data,h=s?.id||s?._id||"",b=te({queries:[{queryKey:["related-products",h],queryFn:()=>Y.getRelatedProducts(h,4),enabled:!!h},{queryKey:["product-reviews",h],queryFn:()=>ie.getProductReviews(h),enabled:!!h}]}),[q,T]=b,le=R.isLoading,ne=R.error,$=q.data,B=q.isLoading,oe=T.data,ce=T.isLoading,W=Ze(),z=es(),[E,Q]=g.useState(s?.isInWishlist||!1),H=W.isPending||z.isPending;g.useEffect(()=>{Q(s?.isInWishlist||!1)},[s?.isInWishlist]);const de=t=>{if(t.stopPropagation(),!n){P.error("Please login to add to wishlist");return}if(!H&&h){const o=!E;Q(o),o?W.mutate({productId:h},{onError:()=>{Q(!1)}}):z.mutate({productId:h},{onError:()=>{Q(!0)}})}},v=a?.images?.length>0?a.images:s?.images||[];g.useEffect(()=>{u(0),y(1)},[a]);const A=oe?.data?.reviews?.map(t=>({id:t._id||t.id,userName:`${t.reviewer?.firstName||""} ${t.reviewer?.lastName||""}`.trim()||"Anonymous",date:new Date(t.createdAt),rating:t.rating,comment:t.comment,avatar:t.reviewer?.profile?.avatar||`https://placehold.co/50x50/FF6B6B/ffffff?text=${(t.reviewer?.firstName?.[0]||"A").toUpperCase()}${(t.reviewer?.lastName?.[0]||"").toUpperCase()}`,helpfulCount:t.helpfulCount,response:t.response}))||[];g.useEffect(()=>{const t=j.current[d],o=C.current;if(t&&o){const p=o.getBoundingClientRect(),f=t.getBoundingClientRect();(f.left<p.left||f.right>p.right)&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[d]);const me=()=>{v.length&&u(t=>t>0?t-1:v.length-1)},ue=()=>{v.length&&u(t=>t<v.length-1?t+1:0)},xe=t=>{u(t)},V=t=>{const o=a?a?.outOfStock?0:a?.quantity:s?.outOfStock?0:s?.quantity||0;t?x<o&&y(x+1):x>1&&y(x-1)},{addItem:pe}=De(),U=(t=!1)=>{if(!s)return;const o=a?.price||s.price||0,p=a?.discount||s.discount;let f=o;p&&p.discountType!=="none"&&p.discountValue&&(p.discountType==="flat"?f=Math.max(0,o-p.discountValue):p.discountType==="percentage"&&(f=o*(1-p.discountValue/100)));const F=a?a?.outOfStock?0:a?.quantity:s?.outOfStock?0:s?.quantity||0,O=a?.color||s.color,K=O?I(O).name:"",ge=K?` - ${K}`:"",M=`${s.title}${ge}`;if(t){if(!l){r("/auth/login",{state:{from:{pathname:"/checkout"},buyNowItem:{productId:s.id||"",variantId:a&&(a?._id||a?.id)||"",title:M,slug:s.slug,price:f,originalPrice:o,discount:p,quantity:x,image:v[0]||"https://placehold.co/300x200.png",color:O,seller:s.seller?.profile?.businessName?{id:s.seller?._id||"",businessName:s.seller.profile.businessName}:void 0,maxQuantity:F,selectedOptions:a?{color:a.color}:s.color?{color:s.color}:void 0}}});return}r("/checkout",{state:{buyNowItem:{id:`${s.id}-${a?.id||"base"}-${Date.now()}`,productId:s.id||"",variantId:a&&(a?._id||a?.id)||"",title:M,slug:s.slug,price:f,originalPrice:o,discount:p,quantity:x,image:v[0]||"https://placehold.co/300x200.png",color:O,seller:s.seller?.profile?.businessName?{id:s.seller?._id||"",businessName:s.seller.profile.businessName}:void 0,maxQuantity:F,marketplaceOptions:s.marketplaceOptions,shippingPrice:s.shippingPrice,selectedOptions:a?{color:a.color}:s.color?{color:s.color}:void 0}}});return}const G=a&&(a._id||a.id||a.color)||"";console.log("Adding to cart with:",{productId:s.id,variantId:G,selectedVariant:a,color:O}),pe({productId:s.id||"",variantId:G,title:M,slug:s.slug,price:f,originalPrice:o,discount:p,quantity:x,image:v[0]||"https://placehold.co/300x200.png",color:O,seller:s.seller?.profile?.businessName?{id:s.seller?._id||"",businessName:s.seller.profile.businessName}:void 0,maxQuantity:F,marketplaceOptions:s.marketplaceOptions,shippingPrice:s.shippingPrice,selectedOptions:a?{color:a.color}:s.color?{color:s.color}:void 0})},he=[{label:"Home",href:"/"},{label:"Marketplace",href:"/marketplace"},{label:s?.title||"Product",isCurrentPage:!0}];return le?e.jsx(cs,{}):ne||!s?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load product"}),e.jsx(S,{onClick:()=>r("/seller/products"),variant:"outline",children:"Back to Products"})]})}):e.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[e.jsx("div",{className:"",children:e.jsx(Le,{items:he})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-12",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"rounded-md relative",children:[e.jsx("div",{className:"w-full absolute bottom-2 left-2 z-10 justify-end",children:ss(s)}),e.jsx(Z.button,{className:"absolute top-2 right-2 rounded-full bg-black/20 backdrop-blur-sm p-2 transition-all duration-200 hover:bg-black/30 z-10",onClick:de,whileHover:{scale:1.1},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2},children:e.jsx(Z.div,{animate:{scale:E?[1,1.2,1]:1},transition:{duration:.3},children:e.jsx(_e,{className:Be("h-5 w-5 transition-colors duration-200 cursor-pointer",E?"text-red-500 fill-red-500":"text-white hover:text-red-400",H&&"opacity-50")})})}),e.jsx(ee,{src:v[d]||"https://placehold.co/600x600/e5e7eb/6b7280?text=No+Image",alt:s?.title||"Product image",className:"rounded-sm bg-white border-gray-200 shadow-md border",wrapperClassName:"w-full h-[250px] sm:h-[350px] md:h-[450px] bg-gray-100 rounded-sm",fallbackSrc:"https://placehold.co/600x600/e5e7eb/6b7280?text=No+Image",objectFit:"cover",showSkeleton:!0,fadeInDuration:.3,rootMargin:"100px"})]}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:me,className:"absolute left-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-white rounded-full border border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm cursor-pointer","aria-label":"Previous image",children:e.jsx(We,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})}),e.jsx("div",{ref:C,className:"flex gap-2 sm:gap-3 overflow-x-auto mx-10 sm:mx-12 md:mx-14 px-1 sm:px-2 scroll-smooth [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:v.map((t,o)=>e.jsx("button",{ref:p=>{j.current[o]=p},onClick:()=>xe(o),className:`flex-shrink-0 w-[80px] h-[60px cursor-pointer bg-white sm:w-[120px] sm:h-[80px] md:w-[150px] md:h-[100px] lg:w-[180px] lg:h-[120px] rounded-lg overflow-hidden border-2 transition-all ${d===o?"border-primary shadow-md":"border-gray-200 hover:border-gray-300"}`,children:e.jsx(ee,{src:t,alt:`${s?.title} ${o+1}`,className:"rounded-lg  border-gray-200 shadow-md border",wrapperClassName:"w-full h-full",fallbackSrc:"https://placehold.co/180x120/e5e7eb/6b7280?text=No+Image",objectFit:"cover",showSkeleton:!0,fadeInDuration:.2,rootMargin:"50px"})},o))}),e.jsx("button",{onClick:ue,className:"absolute right-0 z-10 w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-white rounded-full border border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm cursor-pointer","aria-label":"Next image",children:e.jsx(ze,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-3 sm:mb-4",children:s.title}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4",children:[e.jsx("div",{className:"flex items-center space-x-2 sm:space-x-4",children:(()=>{const t=a?.discount||s.discount,o=a?.price||s.price||0;if(t?.discountType!=="none"&&t?.discountValue){if(t.discountType==="percentage"){const p=o*(1-t.discountValue/100),f=s?.priceType==="sqft"?"/sq ft":s?.priceType==="linear"?"/linear ft":s?.priceType==="pallet"?"/pallet":"";return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-primary",children:["$",p.toFixed(2),e.jsx("span",{className:"text-sm",children:f})]}),e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl text-gray-400 line-through",children:["$",o.toFixed(2),e.jsx("span",{className:"text-sm",children:f})]}),e.jsxs(L,{className:"bg-primary text-white px-2 sm:px-3 py-0.5 sm:py-1 text-xs sm:text-sm font-semibold",children:["-",t.discountValue,"%"]})]})}if(t.discountType==="flat"){const p=o-t.discountValue,f=s?.priceType==="sqft"?"/sq ft":s?.priceType==="linear"?"/linear ft":s?.priceType==="pallet"?"/pallet":"";return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-primary",children:["$",p.toFixed(2),e.jsx("span",{className:"text-sm",children:f})]}),e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl text-gray-400 line-through",children:["$",o.toFixed(2),e.jsx("span",{className:"text-sm",children:f})]}),e.jsxs(L,{className:"bg-primary text-white px-2 sm:px-3 py-0.5 sm:py-1 text-xs sm:text-sm font-semibold",children:["-$",t.discountValue]})]})}}else{const p=s?.priceType==="sqft"?"/sq ft":s?.priceType==="linear"?"/linear ft":s?.priceType==="pallet"?"/pallet":"";return e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-primary",children:["$",o.toFixed(2),e.jsx("span",{className:"text-sm",children:p})]})}})()}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Availability:"}),(()=>{const t=a?a?.outOfStock?0:a?.quantity:s.outOfStock?0:s.quantity||0;return t>0?e.jsxs("span",{className:"text-green-600 font-medium",children:["In stock (",t," available)"]}):e.jsx("span",{className:"text-red-600 font-medium",children:"Out of stock"})})()]})]})]}),(s.color||s.variants&&s.variants.some(t=>!!t.color))&&e.jsxs("div",{className:" flex flex-col sm:hidden border-t border-gray-200 text-xs sm:text-sm text-gray-600 pt-4 sm:pt-6 space-y-2",children:[e.jsx("span",{className:"font-medium",children:"Colors: "}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2",children:[s.color&&e.jsx("div",{onClick:()=>m(null),className:`w-12 h-12 rounded-full border-2transition-all cursor-pointer ${a===null?"border-black bg-primary/5 border-3":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:s.color},title:s.color?I(s.color).name:""}),s.variants&&s.variants.length>0&&s.variants.filter(t=>!!t.color).map((t,o)=>e.jsx("div",{onClick:()=>m(t),className:`w-12 h-12 rounded-full cursor-pointer transition-all ${a===t?"ring-2 ring-black ring-offset-2":"ring-1 ring-gray-300 ring-offset-2 hover:ring-gray-400"}`,style:{backgroundColor:t.color},title:t.color?I(t.color).name:""},o))]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsx(Je,{text:s.description||"No description available",maxLength:200,className:"text-sm sm:text-base text-gray-700 leading-relaxed"})}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Categories: "}),e.jsxs("span",{className:"text-gray-900",children:[typeof s.category=="object"&&s.category?s.category.name:s.category,s.subCategory&&e.jsxs(e.Fragment,{children:[","," ",typeof s.subCategory=="object"&&s.subCategory?s.subCategory.name:s.subCategory]})]})]})}),s.marketplaceOptions&&e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-gray-600 mb-2",children:e.jsx("span",{className:"font-medium",children:"Delivery Options"})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.marketplaceOptions.pickup&&e.jsx("div",{className:"group relative p-4 border-2 rounded-xl border-gray-200 transition-all duration-200 bg-gradient-to-br from-white to-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mb-2 transition-transform",children:e.jsx(He,{className:"text-green-600 w-5 h-5"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Pickup"}),s.pickupHours&&e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wider mb-1.5",children:"Hours"}),e.jsx("div",{className:"mx-auto flex flex-col justify-center items-center w-full px-2 ",children:Xe(s.pickupHours)})]})]})}),s.marketplaceOptions.shipping&&e.jsx("div",{className:"group relative p-4 border-2 rounded-xl border-gray-200 transition-all duration-200 bg-gradient-to-br from-white to-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mb-2 transition-transform",children:e.jsx(Ve,{className:"text-blue-600 w-5 h-5"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Shipping"}),s.shippingPrice?e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-[10px] font-medium text-gray-600 uppercase tracking-wide",children:"Cost"}),e.jsxs("p",{className:"text-base font-bold text-blue-600",children:["$",s.shippingPrice]})]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Contact for rates"})]})}),s.marketplaceOptions.delivery&&e.jsx("div",{className:"group relative p-4 border-2 rounded-xl border-gray-200 transition-all duration-200 bg-gradient-to-br from-white to-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mb-2 transition-transform",children:e.jsx(Ue,{className:"text-purple-600 w-5 h-5"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Local Delivery"}),s.localDeliveryFree?"Free":s.deliveryDistance?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Within"}),e.jsxs("p",{className:"text-base font-bold text-purple-600",children:[s.deliveryDistance," miles"]})]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Local delivery available"})]})})]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6 grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs sm:text-sm",children:s.brand&&e.jsxs("div",{className:" text-gray-600 flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Brand: "}),e.jsx("p",{className:"text-sm font-medium",children:s.brand})]})}),s.productTag&&s.productTag.length>0&&e.jsx("div",{className:"border-t border-gray-200 pt-4 sm:pt-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.jsxs("div",{className:"col-span-2 space-y-2 text-xs sm:text-sm  text-gray-600 flex-col items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Tags: "}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.productTag.map((t,o)=>e.jsx(L,{variant:"secondary",className:"text-xs bg-blue-100 capitalize",children:t},o))})]})}),(s.color||s.variants&&s.variants.some(t=>!!t.color))&&e.jsxs("div",{className:"border-t hidden sm:flex flex-col border-gray-200 text-xs sm:text-sm text-gray-600 pt-4 sm:pt-6 space-y-2 ",children:[e.jsx("span",{className:"font-medium",children:"Colors: "}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2",children:[s.color&&e.jsx("div",{onClick:()=>m(null),className:`w-12 h-12 rounded-full cursor-pointer transition-all ${a===null?"ring-2 ring-black ring-offset-2 ":"ring-1 ring-gray-300 ring-offset-2 hover:ring-gray-400 "}`,style:{backgroundColor:s.color},title:s.color?I(s.color).name:""}),s.variants&&s.variants.length>0&&s.variants.filter(t=>!!t.color).map((t,o)=>e.jsx("div",{onClick:()=>m(t),className:`w-12 h-12 rounded-full cursor-pointer transition-all ${a===t?"ring-2 ring-black ring-offset-2":"ring-1 ring-gray-300 ring-offset-2 hover:ring-gray-400"}`,style:{backgroundColor:t.color},title:t.color?I(t.color).name:""},o))]})]}),s.seller&&e.jsx(rs,{customerDetails:s.seller,title:"",reviewTitle:""}),e.jsxs("div",{className:"flex items-center gap-4 pt-6",children:[e.jsxs("div",{className:"flex items-center bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>V(!1),disabled:x<=1,className:"p-3  hover:bg-gray-200 transition-colors cursor-pointer  disabled:opacity-50 disabled:cursor-not-allowed h-[56px]",children:e.jsx(as,{className:"h-5 w-5 text-gray-600"})}),e.jsx("span",{className:"px-6 py-3 text-lg font-semibold min-w-[60px] text-center",children:x}),e.jsx("button",{onClick:()=>V(!0),disabled:x>=(a?a?.outOfStock?0:a?.quantity:s?.outOfStock?0:s?.quantity||0),className:"p-3 hover:bg-gray-200 transition-colors cursor-pointer  disabled:opacity-50 disabled:cursor-not-allowed h-[56px]",children:e.jsx(Ke,{className:"h-5 w-5 text-gray-600"})})]}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsxs(S,{onClick:()=>U(!1),disabled:a?a?.outOfStock||a?.quantity===0:s?.outOfStock||s?.quantity===0,className:"flex-1 bg-primary hover:bg-primary/90 text-white font-semibold py-3 text-base h-[56px] rounded-xl flex items-center justify-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Add to Cart"]}),e.jsx(S,{onClick:()=>{U(!0)},disabled:a?a?.outOfStock||a?.quantity===0:s?.outOfStock||s?.quantity===0,variant:"outline",className:"flex-1 border-primary text-primary hover:bg-primary/10 font-semibold py-3 text-base h-[56px] rounded-xl",children:"Buy Now"})]})]})]})]}),(B||$?.data&&$.data.length>0)&&e.jsx("div",{className:"mt-8 sm:mt-12 border-t border-gray-200 pt-6 sm:pt-8",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Related Products"})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-4 sm:gap-6",children:B?[...Array(8)].map((t,o)=>e.jsx(xs,{},`skeleton-${o}`)):$?.data?.slice(0,8).map(t=>e.jsx(ts,{product:t,onProductClick:o=>{r(`/products/${o}`),window.scrollTo(0,0)}},t._id||t.id))})]})}),e.jsx("div",{className:"mt-8 sm:mt-12 border-t border-gray-200 pt-6 sm:pt-8",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 flex justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 ",children:"Reviews & Rating"}),e.jsx(ae,{rating:s?.rating||0,showValue:!0,totalReviews:s?.totalReviews||0})]}),e.jsx(S,{variant:"link",leftIcon:is,onClick:()=>{if(!n){P.error("Please login to write a review"),r("/auth/login");return}k(!0)},className:" underline text-sm sm:text-base h-[40px]",children:s?.hasUserReviewed?"Edit Review":"Write a review"})]}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:ce?[...Array(3)].map((t,o)=>e.jsx(os,{},`skeleton-${o}`)):A.length>0?A.map(t=>e.jsx(Ye,{review:t},t.id)):e.jsx("div",{className:"text-gray-500 w-full text-center text-lg flex justify-center items-center min-h-[400px]",children:"No reviews yet!"})}),A.length>10&&e.jsx("div",{className:"mt-6 sm:mt-8 text-center",children:e.jsx(S,{variant:"outline",className:"px-6 sm:px-8 py-2 text-sm sm:text-base text-primary hover:text-primary/80 underline border-none shadow-none",children:"View all"})})]})}),e.jsx(us,{isOpen:w,onClose:()=>{k(!1)},productId:h,existingReview:s?.userReview,onSuccess:()=>{R?.refetch(),T?.refetch()}})]})};export{qs as default};
