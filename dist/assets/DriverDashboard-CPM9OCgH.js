import{r,u as G,j as t}from"./index-CUSVstqU.js";import{M as L}from"./MetricsGrid-BlEYQlJ2.js";import{m as Q,W as z,w as B,R as J,r as K,O as U}from"./mockData-aSsFA7gM.js";import{O as X}from"./OrdersTable-CwWRM3zg.js";import{u as Z}from"./useOrderMutations-CL6oNQvb.js";import{t as _}from"./orderTransformers-DSlKWA6p.js";import"./SortDropdown-BZ2QEsue.js";import"./en-US-CPLesiGp.js";import"./isSameDay-CeY-boyx.js";import"./format-Byp0gi1d.js";import"./endOfMonth-B0jjArdg.js";import"./index-pqJlTpbO.js";import"./index-Chjiymov.js";import"./table-DneWR9W7.js";import"./badge-c_xwgsXg.js";import"./orderUtils-DR-jD4b-.js";import"./date-utils-CIparGJB.js";const St=()=>{const[w,b]=r.useState("2024"),[h]=r.useState(1),[g]=r.useState(5),[d,j]=r.useState("recent"),[p,v]=r.useState(),[n,k]=r.useState({orderStatus:"",pricing:""}),u=G(),S=r.useCallback((e,a,s)=>{const x=new Date;let o,D,m="-createdAt";if(a)switch(a){case"high-to-low":m="-amount";break;case"low-to-high":m="amount";break}else switch(e){case"custom":if(s){const P=s.from.getFullYear(),H=String(s.from.getMonth()+1).padStart(2,"0"),I=String(s.from.getDate()).padStart(2,"0");o=`${P}-${H}-${I}`;const V=s.to.getFullYear(),W=String(s.to.getMonth()+1).padStart(2,"0"),q=String(s.to.getDate()).padStart(2,"0");D=`${V}-${W}-${q}`}break;case"this-week":const i=new Date;i.setDate(i.getDate()-i.getDay()),i.setHours(0,0,0,0),o=i.toISOString().split("T")[0];break;case"this-month":const f=new Date(x.getFullYear(),x.getMonth(),1);f.setHours(0,0,0,0),o=f.toISOString().split("T")[0];break;case"last-3-months":const l=new Date;l.setMonth(l.getMonth()-3),l.setHours(0,0,0,0),o=l.toISOString().split("T")[0];break;case"last-6-months":const c=new Date;c.setMonth(c.getMonth()-6),c.setHours(0,0,0,0),o=c.toISOString().split("T")[0];break}return{startDate:o,endDate:D,sort:m}},[]),y=r.useMemo(()=>{const{startDate:e,endDate:a,sort:s}=S(d,n.pricing,p);return{page:h,limit:g,...e&&{startDate:e},...a&&{endDate:a},...s&&{sort:s},...n.orderStatus&&{status:n.orderStatus}}},[h,g,d,n,p,S]),{data:M,isLoading:O,isError:N,error:C}=Z(y),T=M?.data||[],Y=_(T),F=()=>{u("/driver/orders")},$=e=>{u(`/driver/orders/${e}`)},A=(e,a)=>{j(e),v(a)},E=e=>{k(e)};return t.jsxs("div",{className:"py-4 md:p-4 space-y-4 md:space-y-6",children:[t.jsx("div",{children:t.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"Dashboard"})}),t.jsx(L,{metrics:Q}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[t.jsx("div",{className:"min-h-[350px] lg:min-h-[400px]",children:t.jsx(z,{title:"This Week Earnings",data:B})}),t.jsx("div",{className:"min-h-[350px] lg:min-h-[400px]",children:t.jsx(J,{title:"Total Earnings",data:K,selectedYear:w,onYearChange:b})})]}),O?t.jsx(U,{}):N?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:t.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[200px] text-center",children:[t.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Error loading orders"}),t.jsx("p",{className:"text-gray-600 text-sm",children:C?.response?.data?.message||"Failed to fetch orders. Please try again."})]})}):t.jsx(X,{title:"New Assigned Orders",orders:Y,showSort:!1,showFilter:!0,selectedSort:d,onSortChange:A,filters:n,onFilterChange:E,onViewAll:F,onViewDetails:$})]})};export{St as DriverDashboard,St as default};
