import{u as N,U as b,r as a,o as P,p as S,j as e,L as i,F as T,x as p,B as R,V as I,T as u,I as t}from"./index-BCiIUrXb.js";import{A as L}from"./AuthWrapper-zmeuqRTi.js";function V(){const h=N(),[y]=b(),r=y.get("token"),[f,l]=a.useState(!1),[g,c]=a.useState(!0),[w,v]=a.useState(!1),[d,o]=a.useState(null),m=P({resolver:S(I)}),{handleSubmit:j}=m;a.useEffect(()=>{(async()=>{if(!r){o("No reset token provided. Please request a new password reset link."),c(!1);return}try{const s=await u.verifyResetToken(r);s.status==="success"&&s.data?.valid?v(!0):o(s.message||"Invalid or expired reset token. Please request a new password reset link.")}catch(s){console.error("Token verification error:",s);const n=s?.response?.data?.message||"Invalid or expired reset token. Please request a new password reset link.";o(n)}finally{c(!1)}})()},[r]);const k=async x=>{if(!r){t.error("No reset token provided");return}l(!0);try{const s=await u.resetPassword(r,x.password);s.status==="success"?(t.success(s.message||"Password reset successfully! Redirecting to login..."),setTimeout(()=>{h("/auth/login")},1500)):t.error(s.message||"Failed to reset password. Please try again.")}catch(s){console.error("Reset password error:",s);const n=s?.response?.data?.message||s?.message||"Failed to reset password. Please try again.";t.error(n)}finally{l(!1)}};return e.jsx(L,{children:g?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Verifying Reset Token"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your reset token..."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):d?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Token Invalid"}),e.jsx("p",{className:"text-red-600",children:d}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{to:"/auth/forgot-password",className:"block w-full bg-primary hover:bg-primary/80 text-white font-medium text-base rounded-lg py-3",children:"Request New Reset Link"}),e.jsx(i,{to:"/auth/login",className:"block text-primary hover:text-primary/80 font-medium",children:"Back to Login"})]})]}):w?e.jsx(T,{...m,children:e.jsxs("form",{onSubmit:j(k),className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600",children:"Please enter your details below to reset your password"})]}),e.jsx(p,{name:"password",label:"New Password",type:"password",placeholder:"Enter new password",className:"text-base px-4 border-gray-300"}),e.jsx(p,{name:"confirmPassword",label:"Confirm Password",type:"password",placeholder:"Confirm new password",className:"text-base px-4 border-gray-300"}),e.jsx(R,{type:"submit",className:"w-full bg-primary hover:bg-primary/80 text-white font-medium text-base",loading:f,children:"Continue"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Back to"," ",e.jsx(i,{to:"/auth/login",className:"text-primary hover:text-primary/80 font-medium",children:"Login"})]})})]})}):null})}export{V as default};
