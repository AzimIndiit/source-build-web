import{r as h,a1 as B,j as e,C as b,ah as T,b as v,L as O,aN as Z,B as M,ai as $,aO as F,ap as E}from"./index-BiCr9dd_.js";import{u as I,j as P,d as y,a as U,b as D,m as z,v as R,c as V,e as Y,f as _,g as Q,h as q,A as G}from"./unionpay-CZN5Yg3W.js";import{M as J}from"./ManageBankAccountsSkeleton-C8V7MDwX.js";import{T as K}from"./trash-2-BSx2CMeK.js";import"./alert-BWvEVmDW.js";import"./index-Drpci46K.js";import"./circle-alert-Cy-Zb1fX.js";const W="data:image/svg+xml,%3csvg%20width='49'%20height='39'%20viewBox='0%200%2049%2039'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M43.5312%2038.5111H4.5237C2.04998%2038.5111%200.0195312%2036.4679%200.0195312%2033.9787V4.89956C0.0195312%202.41036%202.04998%200.367188%204.5237%200.367188H43.5312C46.0049%200.367188%2048.0354%202.41036%2048.0354%204.89956V33.9787C48.0497%2036.4823%2046.0192%2038.5111%2043.5312%2038.5111Z'%20fill='%23F6C859'/%3e%3cpath%20d='M18.5076%2033.4323C18.3074%2033.4323%2018.1072%2033.3172%2018.0071%2033.1301C17.8641%2032.8568%2017.9785%2032.5114%2018.2502%2032.3819C19.0509%2031.9647%2020.152%2031.1877%2020.7811%2029.8352C21.5819%2028.1229%2021.3817%2026.2668%2021.0385%2026.1086C20.9527%2026.0654%2020.6095%2026.2381%2020.4093%2026.3532C19.8803%2026.6265%2019.1653%2027.0006%2018.3217%2026.6985C17.4924%2026.4107%2017.092%2025.6769%2016.9061%2025.3172C15.6478%2023.0006%2015.2617%2016.9575%2016.5915%2013.9503C17.0348%2012.9575%2017.6353%2012.3675%2018.3789%2012.1949C19.1367%2012.0222%2019.7516%2012.3388%2020.2521%2012.5978C20.6667%2012.8136%2020.8669%2012.8999%2020.9956%2012.828C21.5104%2012.5114%2021.4961%2010.5978%2020.7811%209.07258C20.152%207.72006%2019.0509%206.94308%2018.2502%206.52581C17.9785%206.38193%2017.8641%206.05099%2018.0071%205.77761C18.1501%205.50423%2018.479%205.38913%2018.7507%205.53301C19.7087%206.02222%2021.0099%206.95747%2021.782%208.58337C22.5399%2010.1949%2022.8974%2012.9719%2021.5676%2013.7776C20.8955%2014.1805%2020.2521%2013.8496%2019.7373%2013.5906C19.3512%2013.3891%2018.9794%2013.2021%2018.622%2013.2884C18.1358%2013.4035%2017.7926%2013.9647%2017.5925%2014.4251C16.4342%2017.0438%2016.7631%2022.756%2017.8641%2024.7992C18.05%2025.1445%2018.2788%2025.5186%2018.6649%2025.6625C19.0366%2025.792%2019.3941%2025.6337%2019.8946%2025.3747C20.3807%2025.1301%2020.9241%2024.8424%2021.5104%2025.1301C22.7544%2025.7345%2022.6686%2028.4395%2021.7677%2030.3532C20.9956%2031.9791%2019.6944%2032.9143%2018.7364%2033.4035C18.6792%2033.4035%2018.5934%2033.4323%2018.5076%2033.4323Z'%20fill='%237D662D'/%3e%3cpath%20d='M16.8369%2014.9573H6.82768C6.5274%2014.9573%206.27002%2014.7127%206.27002%2014.3961C6.27002%2014.0796%206.5131%2013.835%206.82768%2013.835H16.8369C17.1372%2013.835%2017.3946%2014.0796%2017.3946%2014.3961C17.3946%2014.7127%2017.1515%2014.9573%2016.8369%2014.9573Z'%20fill='%237D662D'/%3e%3cpath%20d='M16.8369%2025.0286H6.82768C6.5274%2025.0286%206.27002%2024.784%206.27002%2024.4674C6.27002%2024.1653%206.5131%2023.9062%206.82768%2023.9062H16.8369C17.1372%2023.9062%2017.3946%2024.1509%2017.3946%2024.4674C17.3946%2024.784%2017.1515%2025.0286%2016.8369%2025.0286Z'%20fill='%237D662D'/%3e%3cpath%20d='M30.1922%2033.432C30.1064%2033.432%2030.0206%2033.4176%2029.9349%2033.3744C28.9768%2032.8852%2027.6756%2031.95%2026.9035%2030.3241C26.0026%2028.4104%2025.9169%2025.7197%2027.1609%2025.101C27.7471%2024.8133%2028.2905%2025.101%2028.7766%2025.3456C29.2771%2025.6046%2029.6346%2025.7629%2030.0064%2025.6334C30.421%2025.4895%2030.6641%2025.0435%2030.8071%2024.7701C31.9224%2022.7269%2032.2513%2017.0291%2031.0788%2014.396C30.8786%2013.95%2030.5354%2013.3744%2030.0492%2013.2593C29.749%2013.1874%2029.5631%2012.8852%2029.6346%2012.5831C29.7061%2012.2809%2030.0064%2012.0938%2030.3066%2012.1658C31.0502%2012.3385%2031.6507%2012.9284%2032.094%2013.9356C33.4238%2016.9284%2033.0377%2022.9715%2031.7794%2025.3025C31.5935%2025.6622%2031.1789%2026.396%2030.3638%2026.6838C29.5202%2026.9715%2028.8052%2026.6118%2028.2762%2026.3384C28.076%2026.2377%2027.7328%2026.0651%2027.647%2026.0938C27.3181%2026.2521%2027.1037%2028.1082%2027.9044%2029.8205C28.5336%2031.173%2029.6346%2031.95%2030.4353%2032.3672C30.707%2032.5111%2030.8214%2032.842%2030.6784%2033.1154C30.5783%2033.3169%2030.3924%2033.432%2030.1922%2033.432Z'%20fill='%237D662D'/%3e%3cpath%20d='M27.963%2012.7267C27.7343%2012.7267%2027.5198%2012.5828%2027.434%2012.3382C26.2472%208.74112%2029.0355%205.96414%2029.9363%205.50371C30.208%205.35983%2030.5511%205.47494%2030.6798%205.74832C30.8228%206.0217%2030.7084%206.36702%2030.4368%206.49652C30.0364%206.69796%2027.4769%208.91378%2028.4921%2011.9785C28.5922%2012.2663%2028.4349%2012.5829%2028.1346%2012.6836C28.0774%2012.7123%2028.0202%2012.7267%2027.963%2012.7267Z'%20fill='%237D662D'/%3e%3cpath%20d='M41.857%2014.9573H31.8477C31.5474%2014.9573%2031.29%2014.7127%2031.29%2014.3961C31.29%2014.0796%2031.5331%2013.835%2031.8477%2013.835H41.857C42.1572%2013.835%2042.4146%2014.0796%2042.4146%2014.3961C42.4146%2014.7127%2042.1715%2014.9573%2041.857%2014.9573Z'%20fill='%237D662D'/%3e%3cpath%20d='M41.857%2025.0286H31.8477C31.5474%2025.0286%2031.29%2024.784%2031.29%2024.4674C31.29%2024.1653%2031.5331%2023.9062%2031.8477%2023.9062H41.857C42.1572%2023.9062%2042.4146%2024.1509%2042.4146%2024.4674C42.4146%2024.784%2042.1715%2025.0286%2041.857%2025.0286Z'%20fill='%237D662D'/%3e%3c/svg%3e",X={visa:R,mastercard:z,amex:D,"american express":D,discover:U,diners:y,"diners club":y,jcb:P,unionpay:I},e2=c=>{const l=c.toLowerCase().trim();return X[l]||null},a2=({id:c,accountHolder:l,accountNumber:s,bankName:d,expiryDate:j,onDelete:C,onToggleDefault:o,className:u,isDefault:i,totalCards:f,isCard:w=!1})=>{const[n,m]=h.useState(!1),[x,p]=h.useState(i);B.useEffect(()=>{p(i)},[i]);const r=async t=>{if(!n&&t&&(console.log("id",c),p(t),o)){m(!0);try{await o(c,t)}catch(N){console.error("Failed to update default status:",N),p(i)}finally{m(!1)}}};return console.log("isDefault && totalBankAccount ",i,f),e.jsx(b,{className:T("relative h-[240px] flex flex-col overflow-hidden rounded-2xl shadow-lg hover:shadow-xl transition-shadow","bg-gradient-to-l from-[#93278F]/90 to-black border-0",u),children:e.jsxs(v,{className:"flex flex-col h-full p-6 text-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"w-12 h-10 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("img",{src:W,alt:"Card chip",className:"w-full h-full object-contain"})})}),e.jsxs("div",{className:"flex items-center space-x-2 absolute right-6 top-6",children:[e.jsx(O,{htmlFor:`default-${s}`,className:`text-xs text-white transition-opacity duration-200 ${n?"opacity-50":"opacity-80"}`,children:"Default"}),e.jsx(Z,{id:`default-${s}`,checked:x,onCheckedChange:r,disabled:n||x&&f,className:`h-6 w-12 transition-all duration-200 ${n?"data-[state=checked]:bg-primary":x&&f?"data-[state=checked]:bg-green-500  opacity-80 cursor-not-allowed":"data-[state=checked]:bg-green-500 hover:data-[state=checked]:bg-green-600"}`})]}),e.jsx("div",{className:"flex flex-col items-end mt-4",children:(()=>{const t=e2(d);return t?e.jsx("img",{src:t,alt:`${d} logo`,className:"h-12 w-auto object-contain"}):e.jsx("span",{className:"text-2xl font-bold uppercase tracking-wider italic",children:d})})()})]}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-lg font-mono tracking-[0.2em] ",children:s})}),e.jsx("div",{className:" mt-8",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"mb-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wider opacity-80",children:"Card Holder Name"}),e.jsx("p",{className:"text-base font-medium",children:l})]})}),w&&e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-wider opacity-80",children:"Expiry Date"}),e.jsx("p",{className:"text-base font-medium",children:j})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx(M,{title:"Delete",variant:"ghost",size:"icon",onClick:C,className:"w-8 h-8 hover:bg-red-500/20 text-red-500 hover:text-red-500 rounded-md",children:e.jsx(K,{className:"w-4 h-4"})})})]})})]})})},o2=()=>{const[c,l]=h.useState(!1),[s,d]=h.useState(null),[j,C]=h.useState(!1),[o,u]=h.useState(null),{data:i,isLoading:f,error:w}=V(),n=Y(),m=_(),x=Q(),p=q(),r=i?.data||[],t=async(a,g)=>{g?await p.mutateAsync(a):r.find(A=>A.id===a)&&await m.mutateAsync({id:a,data:{isDefault:!1}})},N=async a=>{try{s?await m.mutateAsync({id:s.id,data:{cardholderName:a.cardholderName,isDefault:a.isDefault}}):await n.mutateAsync(a),l(!1),d(null)}catch(g){console.error("Failed to save card:",g)}},S=a=>{u(a),C(!0)},k=()=>{o&&x.mutate(o?._id||"",{onSuccess:()=>{C(!1),u(null)}})},H=()=>{C(!1),u(null)},L=()=>{l(!1),d(null)};return f?e.jsx(J,{}):w?e.jsx(b,{className:"bg-white border-gray-200 shadow-none h-[calc(100vh-200px)] justify-center items-center",children:e.jsx(v,{className:"px-4 sm:px-6",children:e.jsx("div",{className:"text-center py-12 text-red-500",children:"Failed to load cards. Please try again."})})}):e.jsx(b,{className:"bg-white border-gray-200 shadow-none min-h-[calc(100vh-200px)] flex flex-col",children:e.jsxs(v,{className:"px-4 sm:px-6 flex flex-col flex-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold",children:"Manage Saved Cards"}),e.jsxs(M,{onClick:()=>l(!0),className:"w-full sm:w-auto min-w-full sm:min-w-[180px] h-10 sm:h-11 bg-primary hover:bg-primary/90 text-white px-3 sm:px-5 rounded-lg flex items-center justify-center gap-2 text-sm sm:text-base font-medium",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Card"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6 ",children:r?.length>0?r?.map(a=>{const g=`${String(a.expiryMonth).padStart(2,"0")}/${String(a.expiryYear).slice(-2)}`;return e.jsx(a2,{id:a?._id||"",totalCards:r.length>0,accountHolder:a.cardholderName,accountNumber:`**** **** **** ${a.last4}`,bankName:a.brand.toUpperCase(),expiryDate:g,onDelete:()=>S(a),onToggleDefault:t,isDefault:a.isDefault,isCard:!0},a.id)}):e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center min-h-[400px]",children:[e.jsx(F,{className:"h-12 w-12 mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No cards added yet"})]})}),e.jsx(G,{isOpen:c,isSubmitting:n.isPending||m?.isPending,onClose:L,onSubmit:N,totalCards:r.length>0,initialData:s?{cardholderName:s.cardholderName,isDefault:s.isDefault}:void 0,isEdit:!!s}),j&&e.jsx(E,{isOpen:j,onClose:H,onConfirm:k,title:"Delete Card?",description:e.jsxs(e.Fragment,{children:["Are you sure you want to delete the card ending in"," ",e.jsxs("strong",{className:"font-semibold",children:["****",o?.last4]}),"? This action cannot be undone."]}),confirmText:"Yes, I'm Sure",cancelText:"Cancel",isLoading:x.isPending})]})})};export{o2 as default};
