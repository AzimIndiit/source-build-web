import{A as _,u as O,r as b,j as e,aq as $,ar as z,at as I,B as j,aF as f,ag as C,bF as B,C as A,Y as L,Z as U,$ as V,ah as P,bk as H,as as W,bo as q,M as E,S as l,D as G,c as Q}from"./index-BiCr9dd_.js";import{B as J}from"./breadcrumb-wrapper-448K_ANJ.js";import{a as F}from"./StarRating-BvoSMCCK.js";import{o as D,c as Y}from"./useOrderMutations-CLFnksb7.js";import{B as Z}from"./badge-gylWw4eT.js";import{f as T}from"./date-utils-CIparGJB.js";import{g as K}from"./orderUtils-DR-jD4b-.js";import{g as X}from"./colorUtils-Cg0F6a_m.js";import{U as ee}from"./upload-BsZw_j0x.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}]],ae=_("message-square-more",se),te=({order:s,isOpen:a,onClose:d,orderId:c,onSubmit:i,onSuccess:m})=>{const{user:h}=O();console.log("order",s);const t={buyerRating:s?.customer?.rating||0,buyerComment:s?.customer?.review||"",driverRating:s?.driver?.rating||0,driverComment:s?.driver?.review||"",sellerRating:s?.seller?.rating||0,sellerComment:s?.seller?.review||""},[r,o]=b.useState(t),[g,N]=b.useState(!1),y=(n,v)=>{o(R=>({...R,[n]:v}))},u=async()=>{if(!c){if(i){const{buyerRating:n,buyerComment:v,driverRating:R,driverComment:S,sellerRating:k,sellerComment:x}=r;i(n,v,R,S,k,x)}p();return}N(!0);try{const n={};if(r.buyerRating>0){if(r.buyerComment==="")return f.error("Please enter a comment ");n.customer={rating:r.buyerRating,review:r.buyerComment||""}}if(r.driverRating>0){if(r.driverComment==="")return f.error("Please enter a comment ");n.driver={rating:r.driverRating,review:r.driverComment||""}}if(r.sellerRating>0){if(r.sellerComment==="")return f.error("Please enter a comment ");n.seller={rating:r.sellerRating,review:r.sellerComment||""}}await D.addOrderReview(c,n),m?.(),p()}catch(n){console.error("Failed to submit review:",n);const v=n?.response?.data?.message||"Failed to submit review. Please try again.";f.error(v)}finally{N(!1)}},p=()=>{o(t),d()};return e.jsx($,{open:a,onOpenChange:p,children:e.jsxs(z,{className:"w-full max-w-[95vw] sm:max-w-xl md:max-w-2xl bg-white p-4 sm:p-6 max-h-[90vh] overflow-y-auto rounded-sm",children:[e.jsx(I,{className:"text-lg sm:text-xl font-semibold",children:"Add Review & Rating"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[h?.role==="seller"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Rating"}),e.jsx(F,{size:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8",rating:r.sellerRating,onRatingChange:n=>y("sellerRating",n)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Comment"}),e.jsx("textarea",{placeholder:"Share your experience with the seller...",className:"w-full min-h-[100px] sm:min-h-[120px] md:min-h-[150px] p-2 sm:p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none text-sm sm:text-base",value:r.sellerComment,maxLength:500,onChange:n=>y("sellerComment",n.target.value),rows:3})]})]}),h?.role==="driver"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Rating"}),e.jsx(F,{size:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8",rating:r.driverRating,onRatingChange:n=>y("driverRating",n)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-600",children:"Comment"}),e.jsx("textarea",{placeholder:"Share your experience with the driver...",className:"w-full min-h-[100px] sm:min-h-[120px] md:min-h-[150px] p-2 sm:p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none text-sm sm:text-base",value:r.driverComment,maxLength:500,onChange:n=>y("driverComment",n.target.value),rows:3})]})]}),e.jsxs("div",{className:"flex flex-row justify-center sm:justify-end gap-2 sm:gap-3 pt-4",children:[e.jsx(j,{variant:"outline",onClick:p,className:"w-[224px]  px-6 sm:px-8 py-2 sm:py-2.5 border-gray-300 text-gray-600 hover:bg-gray-100 hover:text-gray-600 text-sm sm:text-base h-[53px]",children:"Cancel"}),e.jsx(j,{type:"button",disabled:g||r.buyerRating===0&&r.driverRating===0&&r.sellerRating===0,onClick:u,className:"  bg-primary hover:bg-primary/80 text-white px-6 sm:px-8 py-2 sm:py-2.5 w-[220px] text-sm sm:text-base h-[53px]",children:g?"Submitting...":"Add Review"})]})]})]})})},re=({order:s,onViewItem:a,onWriteReview:d})=>{const{user:c}=O(),[i,m]=b.useState(!1),h=s.id.includes("-")?s.id:`408-2671656-${s.id.padStart(7,"0")}`,t=s.products?.reduce((o,g)=>o+(g.quantity||1),0)||1,r=s.products?.reduce((o,g)=>o+(g.price||0),0)||s.amount||0;return s.products&&s.products.length>0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-4 sm:px-6 py-3  border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-0",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-4 lg:gap-6 flex-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Order Placed"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:T(s.date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Total"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:C(r)})]}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Quantity"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1 lg:col-span-1",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Status"}),e.jsx(Z,{className:`px-2 lg:px-3 py-1 rounded-full font-medium text-xs ${K(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"hidden lg:block",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Payment"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Paid"})]})]}),e.jsxs("div",{className:"sm:ml-4 lg:ml-6 text-left sm:text-right space-y-1",children:[e.jsxs("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["Order # ",h]}),s.status==="Delivered"&&e.jsx("div",{className:"flex-shrink-0 self-start",children:e.jsx(j,{type:"button",onClick:()=>m(!0),className:"bg-primary  hover:bg-primary/80 text-white rounded-lg px-6 py-3 h-auto font-medium text-base whitespace-nowrap",children:"Write a Review"})})]})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:s.products.map((o,g)=>e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-5",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 sm:gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:o.image||"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=128&h=96&fit=crop",alt:o.title,className:"w-full sm:w-32 h-32 sm:h-24 object-cover rounded-lg"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:o.title}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Price:"})," ",C(o.price||0)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Qty:"})," ",o.quantity||1]}),o.color&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Color:"})," ",e.jsx("span",{className:"capitalize",children:X(o.color).name})]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3 sm:mb-4",children:["Delivery on ",T(o.deliveryDate||"12 October 2024")]})]}),c?.role==="seller"&&e.jsx(j,{variant:"outline",onClick:()=>{a?.({slug:o.productRef?.slug||""}),console.log("Viewing item:",o.title)},className:"border-primary text-primary hover:bg-blue-50 rounded-lg px-6 py-2 h-auto font-medium",children:"View your item"})]})},o.id||g))}),i&&e.jsx(te,{isOpen:i,onClose:()=>m(!1),orderId:s?._id,order:s,onSuccess:()=>{d?.()}})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("p",{children:"No products found for this order"})})},M=({customerDetails:s,title:a="Customer Details",reviewTitle:d="Reviews & Rating From Customer"})=>{const{mutate:c}=B(),i=()=>{s?.id&&c({participantId:s.id})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 capitalize",children:a}),e.jsx(A,{className:"bg-white rounded-sm border border-gray-200 shadow-none p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(L,{className:"w-12 h-12",children:[s?.avatar?e.jsx(U,{src:s.avatar,alt:s.displayName,className:"object-cover"}):null,e.jsx(V,{className:" font-medium text-lg",children:s?.displayName?.charAt(0)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base capitalize",children:s?.displayName}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:s?.email})]})]}),e.jsx("button",{className:"p-3 bg-primary/10 hover:bg-primary/20 rounded-full transition-colors cursor-pointer",onClick:i,children:e.jsx(ae,{className:"w-5 h-5 text-primary "})})]})})]}),s?.rating&&s?.rating>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"font-medium text-gray-900 text-lg capitalize",children:d}),e.jsxs(A,{className:"p-4 border-gray-200 gap-3",children:[e.jsx("div",{className:"",children:e.jsx(F,{size:"h-6 w-6",rating:s?.rating||0})}),e.jsx("p",{className:"text-gray-500 leading-relaxed text-[15px] capitalize",children:s?.review})]})]}):""]})},le=(s,a)=>{const d=new Date(a),c=m=>m.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})+" at "+m.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),i=[{title:"Order Received",description:"New order received and pending confirmation",date:c(d),completed:!1},{title:"Order Confirmed",description:"Order has been confirmed and is being prepared.",date:c(new Date(d.getTime()+3600*1e3)),completed:!1},{title:"In Transit",description:"Shipment arrived at Driver location",date:c(new Date(d.getTime()+480*60*1e3)),completed:!1},{title:"Out for Delivery",description:"Driver has picked up the order and is en route to the customer.",date:c(new Date(d.getTime()+1440*60*1e3)),completed:!1},{title:"Delivered",description:"Order successfully delivered to the customer.",date:c(new Date(d.getTime()+1440*60*1e3)),completed:!1}];switch(s.toLowerCase()){case"pending":i[0].completed=!0;break;case"processing":i[0].completed=!0,i[1].completed=!0;break;case"in transit":i[0].completed=!0,i[1].completed=!0,i[2].completed=!0;break;case"out for delivery":i[0].completed=!0,i[1].completed=!0,i[2].completed=!0,i[3].completed=!0;break;case"delivered":i.forEach(m=>m.completed=!0);break;case"cancelled":return[{title:"Order Received",description:"New order received and pending confirmation",date:c(d),completed:!0},{title:"Order Cancelled",description:"Order has been cancelled",date:c(new Date),completed:!0,isLast:!0}];default:i[0].completed=!0}return i[i.length-1].isLast=!0,i},ie=({order:s})=>{const a=le(s.status,s.date);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Booking Status"}),e.jsx(A,{className:"relative p-4 border-gray-200 shadow-none gap-0",children:a.map((d,c)=>e.jsxs("div",{className:"flex gap-4 relative",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:P("w-10 h-10 rounded-full flex items-center justify-center z-10",d.completed?"bg-green-500":"bg-gray-300"),children:d.completed?e.jsx(H,{className:"w-5 h-5 text-white",strokeWidth:3}):e.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center bg-gray-300",children:e.jsx("span",{className:"text-xs text-gray-500",children:c+1})})}),!d.isLast&&e.jsx("div",{className:P("w-0.5 flex-1 ",d.completed&&c==a.length-1?"bg-green-500":"bg-gray-300"),style:{minHeight:"80px"}})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-1",children:d.title}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:d.description}),e.jsx("p",{className:"text-xs text-gray-400",children:d.date})]})]},c))})]})},ne=({isOpen:s,onClose:a,onSubmit:d,isSubmitting:c=!1})=>{const[i,m]=b.useState(null),[h,t]=b.useState(null),[r,o]=b.useState(""),[g,N]=b.useState(!1),y=b.useRef(null),u=x=>{if(!x.type.startsWith("image/")){f.error("Please select an image file");return}if(x.size>5*1024*1024){f.error("File size must be less than 5MB");return}m(x);const w=new FileReader;w.onloadend=()=>{t(w.result)},w.readAsDataURL(x)},p=x=>{const w=x.target.files?.[0];w&&u(w)},n=x=>{x.preventDefault(),N(!0)},v=x=>{x.preventDefault(),N(!1)},R=x=>{x.preventDefault(),N(!1);const w=x.dataTransfer.files[0];w&&u(w)},S=async()=>{await d(i,r)},k=()=>{m(null),t(null),o(""),a()};return e.jsx($,{open:s,onOpenChange:x=>!x&&k(),children:e.jsxs(z,{className:"max-w-2xl bg-white",children:[e.jsx(W,{children:e.jsx(I,{className:"text-2xl font-semibold",children:"Photo Confirmation for Secure Drop-Offs"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{onDragOver:n,onDragLeave:v,onDrop:R,onClick:()=>y.current?.click(),className:`
              border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all
              ${g?"border-primary bg-blue-50":"border-gray-300 hover:border-gray-400"}
              ${h?"p-4":"p-8"}
            `,children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsx("img",{src:h,alt:"Proof of delivery preview",className:"mx-auto max-h-64 rounded-lg"}),e.jsx(j,{variant:"outline",size:"sm",onClick:x=>{x.stopPropagation(),m(null),t(null)},className:"mx-auto",children:"Remove Image"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto text-gray-400"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-gray-600",children:["Drag & drop media or"," ",e.jsx("span",{className:"text-primary font-medium",children:"click here"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Maximum file size: 5MB â€¢ Supported formats: JPG, PNG, GIF"})]})]})}),e.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:p,className:"hidden"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message (optional)"}),e.jsx("textarea",{value:r,onChange:x=>o(x.target.value),placeholder:"Type Message Here",className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",rows:4})]}),e.jsxs(q,{children:[e.jsx(j,{variant:"outline",onClick:k,disabled:c,className:"px-8",children:"Cancel"}),e.jsx(j,{type:"button",variant:"default",onClick:S,disabled:c||!i,className:"px-8 text-white hover:text-white",children:c?"Submitting...":"Mark Delivered"})]})]})})},ce=({order:s,orderSummary:a,showHelpBtn:d,refetch:c})=>{const{user:i}=O(),[m,h]=b.useState(!1),[t,r]=b.useState(!1),o=async()=>{if(s?._id){h(!0);try{await D.updateOrderStatus(s._id,"Out for Delivery"),f.success("Delivery started successfully!"),c?.()}catch(u){console.error("Failed to start delivery:",u);const p=u?.response?.data?.message||"Failed to start delivery. Please try again.";f.error(p)}finally{h(!1)}}},g=async()=>{if(!s?._id)return;const u=window.prompt("Please provide a reason for cancellation:");if(u){h(!0);try{await D.cancelOrder(s._id,u),f.success("Order cancelled successfully!"),c?.()}catch(p){console.error("Failed to cancel order:",p);const n=p?.response?.data?.message||"Failed to cancel order. Please try again.";f.error(n)}finally{h(!1)}}},N=()=>{r(!0)},y=async(u,p)=>{if(console.log("order",s),!!s?._id){h(!0);try{let n="";u&&(n=(await E.uploadFile(u)).data.url),await D.markAsDelivered(s._id,n,p),f.success("Order marked as delivered successfully!"),r(!1),c?.()}catch(n){console.error("Failed to mark order as delivered:",n);const v=n?.response?.data?.message||"Failed to mark order as delivered. Please try again.";f.error(v)}finally{h(!1)}}};return console.log("order?.status",s?.status),e.jsxs(A,{className:"w-full p-4 gap-3 border-gray-200 shadow-none",children:[i?.role==="driver"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pick Up Location"}),e.jsx("div",{className:"space-y-2",children:a.pickupAddress?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-base text-gray-600",children:[a.pickupAddress.name,", ",a.pickupAddress.phone]}),e.jsx("p",{className:"text-sm text-gray-500 leading-relaxed",children:a.formattedPickupAddress||`${a.pickupAddress.address}, ${a.pickupAddress.city}, ${a.pickupAddress.state}, ${a.pickupAddress.country}, ${a.pickupAddress.zip}`})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-base text-gray-600",children:"Judy Nguyen, +1 972 234 5678"}),e.jsx("p",{className:"text-sm text-gray-500 leading-relaxed",children:"SCO 50-51, Sub. City Center, 2nd Floor Sector 34A, Sector 34, Chandigarh, 160022, punjab, India"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Drop Address"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-base text-gray-600",children:[a.shippingAddress.name||"Yousef Alaoui",","," ",a.shippingAddress.phone||"+1 786 234 5678"]}),e.jsx("p",{className:"text-sm text-gray-500 leading-relaxed",children:a.formattedShippingAddress||`${a.shippingAddress.address}, ${a.shippingAddress.city}, ${a.shippingAddress.state}, ${a.shippingAddress.country}, ${a.shippingAddress.zip}`})]})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Shipping Address"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-base  text-gray-600",children:[a.shippingAddress.name,", ",a.shippingAddress.phone]}),e.jsx("p",{className:"text-sm text-gray-500 leading-relaxed",children:a.formattedShippingAddress||`${a.shippingAddress.address}, ${a.shippingAddress.city}, ${a.shippingAddress.state}, ${a.shippingAddress.country}, ${a.shippingAddress.zip}`})]})]}),a.proofOfDelivery&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Proof of Delivery"}),d&&e.jsx("div",{className:"flex justify-end",children:e.jsx(j,{className:"h-[40px] text-white",children:"Help"})})]}),e.jsx("div",{className:"rounded-lg w-48 h-48 overflow-hidden border border-gray-200",children:e.jsx("img",{src:a.proofOfDelivery,alt:"Proof of delivery",className:" w-full h-full object-cover"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-[#98a2b3]",children:"Sub total"}),e.jsx("span",{className:"text-base font-medium text-gray-900",children:C(Number(a.subTotal))})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-[#98a2b3]",children:"Shipping fee"}),e.jsx("span",{className:"text-base font-medium text-gray-900",children:C(Number(a.shippingFee))})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-[#98a2b3]",children:"Marketplace Fee"}),e.jsx("span",{className:"text-base font-medium text-gray-900",children:C(Number(a.marketplaceFee))})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-[#98a2b3]",children:"Taxes"}),e.jsx("span",{className:"text-base font-medium text-gray-900",children:C(Number(a.taxes))})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Total you'll receive"}),e.jsx("span",{className:"text-lg font-bold text-primary",children:C(Number(a.total))})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Payment"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-[#98a2b3] uppercase tracking-wide",children:a.paymentMethod?.type}),e.jsx("p",{className:"text-base font-medium text-gray-900",children:a.paymentMethod?.cardNumber})]}),e.jsx("div",{className:"text-lg font-bold text-primary italic",children:a.paymentMethod?.cardType})]})})]}),(s?.status==="Processing"||s?.status==="In Transit")&&i?.role==="driver"&&e.jsxs("div",{className:"space-y-2 flex justify-end gap-2",children:[e.jsx(j,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50 w-[124px]",onClick:g,disabled:m,children:"Cancel"}),e.jsx(j,{type:"button",className:"w-[124px] text-white hover:text-white",onClick:o,disabled:m,children:m?"Starting...":"Start"})]}),s?.status==="Out for Delivery"&&i?.role==="driver"&&e.jsxs("div",{className:"space-y-2 flex justify-end gap-2",children:[e.jsx(j,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50 w-[124px]",onClick:g,disabled:m,children:"Cancel"}),e.jsx(j,{className:"w-[180px] text-white hover:text-white",onClick:N,disabled:m,children:m?"Marking...":"Mark as Delivered"})]}),e.jsx(ne,{isOpen:t,onClose:()=>r(!1),onSubmit:y,isSubmitting:m})]})},de=()=>e.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{className:"h-4 w-16"}),e.jsx(l,{className:"h-4 w-2"}),e.jsx(l,{className:"h-4 w-24"})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:"lg:w-1/3",children:e.jsx(l,{className:"w-full h-48 rounded-lg"})}),e.jsxs("div",{className:"lg:w-2/3 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(l,{className:"h-6 w-32"}),e.jsx(l,{className:"h-8 w-20 rounded-full"})]}),e.jsx(l,{className:"h-5 w-48"}),e.jsx(l,{className:"h-4 w-64"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(l,{className:"h-6 w-24"}),e.jsxs("div",{className:"space-y-2 text-right",children:[e.jsx(l,{className:"h-4 w-20"}),e.jsx(l,{className:"h-4 w-16"}),e.jsx(l,{className:"h-4 w-18"})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx(l,{className:"h-6 w-32 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx(l,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-24"}),e.jsx(l,{className:"h-3 w-32"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-full"}),e.jsx(l,{className:"h-4 w-3/4"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx(l,{className:"h-6 w-24 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx(l,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-24"}),e.jsx(l,{className:"h-3 w-32"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx(l,{className:"h-6 w-28 mb-4"}),e.jsx("div",{className:"space-y-4",children:Array.from({length:4}).map((s,a)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(l,{className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-32"}),e.jsx(l,{className:"h-3 w-20"})]})]},a))})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx(l,{className:"h-6 w-32 mb-6"}),e.jsxs("div",{className:"mb-6",children:[e.jsx(l,{className:"h-5 w-28 mb-3"}),e.jsx(l,{className:"h-4 w-full"}),e.jsx(l,{className:"h-4 w-3/4"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(l,{className:"h-5 w-32 mb-3"}),e.jsx(l,{className:"h-4 w-48"})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(l,{className:"h-4 w-20"}),e.jsx(l,{className:"h-4 w-16"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(l,{className:"h-4 w-24"}),e.jsx(l,{className:"h-4 w-16"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(l,{className:"h-4 w-28"}),e.jsx(l,{className:"h-4 w-16"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(l,{className:"h-4 w-16"}),e.jsx(l,{className:"h-4 w-16"})]}),e.jsxs("div",{className:"flex justify-between border-t pt-3",children:[e.jsx(l,{className:"h-5 w-20"}),e.jsx(l,{className:"h-5 w-20"})]})]})]})})]})]}),fe=()=>{const{user:s}=O(),{id:a}=G(),d=Q(),{data:c,isLoading:i,isError:m,refetch:h}=Y(a||"");if(i)return e.jsx(de,{});if(m||!c?.data)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Order Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The order you're looking for doesn't exist."}),e.jsx(j,{className:"text-white hover:text-white",onClick:()=>d(`/${s?.role}/orders`),children:"Back to Orders"})]})});const t=c.data,r={_id:t._id,id:t.orderNumber||t._id,seller:{id:t.seller?.userRef?._id||"",displayName:t.seller?.userRef?.displayName||"Seller",email:t.seller?.userRef?.email||"",avatar:t.seller?.userRef?.avatar||"",rating:t.seller?.reviewRef?.rating,review:t.seller?.reviewRef?.review},customer:{id:t.customer?.userRef?._id||"",displayName:t.customer?.userRef?.displayName||"Customer",email:t.customer?.userRef?.email||"",avatar:t.customer?.userRef?.avatar||"",rating:t.customer?.reviewRef?.rating,review:t.customer?.reviewRef?.review},driver:t.driver?{id:t.driver?.userRef?._id||"",displayName:t.driver?.userRef?.displayName||"Driver",email:t.driver?.userRef?.email||"",avatar:t.driver?.userRef?.avatar||"",rating:t.driver?.reviewRef?.rating,review:t.driver?.reviewRef?.review}:void 0,products:t.products,date:t.date,amount:t.amount,status:t.status,orderSummary:t.orderSummary?{shippingAddress:t.orderSummary.shippingAddress,pickupAddress:t.orderSummary.pickupAddress||null,proofOfDelivery:t.orderSummary.proofOfDelivery||"",paymentMethod:{type:t.orderSummary.paymentMethod.type,cardType:t.orderSummary.paymentMethod.cardType||"",cardNumber:t.orderSummary.paymentMethod.cardNumber||""},subTotal:t.orderSummary.subTotal,shippingFee:t.orderSummary.shippingFee,marketplaceFee:t.orderSummary.marketplaceFee,taxes:t.orderSummary.taxes,total:t.orderSummary.total}:void 0},o=[{label:"Orders",href:s?.role==="buyer"?"/buying":`/${s?.role}/orders`},{label:"Order Details",isCurrentPage:!0}],g=()=>{h()},N=({slug:v})=>{console.log("Viewing item..."),d(`/${s?.role}/products/${v}`)},y=r.customer?.rating&&r.customer.rating>0,u=r.driver?.rating&&r.driver.rating>0,p=!y&&!u,n=!!(r.status==="Delivered"&&p);return e.jsxs("div",{className:"py-4 md:p-6 space-y-6",children:[e.jsx(J,{items:o}),e.jsx(re,{order:r,onViewItem:N,onWriteReview:g}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:" space-y-4",children:[r?.seller&&s?.role==="driver"&&e.jsx(M,{customerDetails:r.seller,title:"Vendor Details",reviewTitle:"Reviews & Rating From Vendor"}),e.jsx(M,{customerDetails:r.customer,title:"Customer Details",reviewTitle:"Reviews & Rating From Customer"}),r?.driver&&s?.role==="seller"&&e.jsx(M,{customerDetails:r.driver,title:"Assign To",reviewTitle:"Reviews & Rating From Driver"}),p&&e.jsx(ie,{order:r})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(ce,{refetch:h,order:r,showHelpBtn:n,orderSummary:r.orderSummary})})]})]})};export{fe as default};
