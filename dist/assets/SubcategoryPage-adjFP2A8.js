import{n,a3 as U,E as S,aK as i,G as b,ad as R,r as c,j as l}from"./index-CUSVstqU.js";import{P as $}from"./pagination-wrapper-Caj-HnEp.js";import{C as B,a as V}from"./CategoryModal-DI7WPGP9.js";import"./index-7rtZR-0h.js";import"./table-DneWR9W7.js";import"./badge-c_xwgsXg.js";import"./date-utils-CIparGJB.js";import"./EmptyState-CH6fPGhV.js";import"./SearchInput-CIs23NSy.js";import"./SortDropdown-BZ2QEsue.js";import"./en-US-CPLesiGp.js";import"./isSameDay-CeY-boyx.js";import"./format-Byp0gi1d.js";import"./endOfMonth-B0jjArdg.js";import"./UserTableSkeleton-Dw2BkS24.js";import"./buyingEmptyState-C5ryqnDV.js";import"./arrow-up-down-BPvpXmMH.js";import"./ellipsis-vertical-CPx5VAQW.js";import"./layers-DUzS6LzX.js";import"./trash-2-BLdsFbCa.js";import"./imageValidation-BOnAwXS7.js";import"./upload-BVTc7vsb.js";class G{async getSubcategories(t){const s=new URLSearchParams;return t&&Object.entries(t).forEach(([g,r])=>{r!=null&&r!==""&&s.append(g,String(r))}),(await n.get("/subcategories",{params:s})).data}async getSubcategoryById(t){return(await n.get(`/subcategories/${t}`)).data}async createSubcategory(t){return(await n.post("/subcategories",t)).data}async updateSubcategory(t,s){return(await n.put(`/subcategories/${t}`,s)).data}async deleteSubcategory(t){return(await n.delete(`/subcategories/${t}`)).data}async toggleSubcategoryStatus(t){return(await n.patch(`/subcategories/${t}/toggle-status`)).data}async getSubcategoriesByCategory(t,s){const o=new URLSearchParams;return o.append("category",t),s&&Object.entries(s).forEach(([r,u])=>{u!=null&&u!==""&&r!=="category"&&o.append(r,String(u))}),(await n.get("/subcategories",{params:o})).data}async getSubcategoryStats(){return(await n.get("/subcategories/stats")).data}async getAvailableSubcategories(t){const s=new URLSearchParams;return t&&s.append("categoryId",t),(await n.get("/subcategories/available",{params:s})).data}}const d=new G,N=()=>S({mutationFn:e=>d.createSubcategory(e),onSuccess:()=>{i.success("Subcategory created successfully"),b.invalidateQueries({queryKey:["subcategories"]})},onError:e=>{i.error(e?.response?.data?.message||"Failed to create subcategory")}}),W=()=>S({mutationFn:({id:e,data:t})=>d.updateSubcategory(e,t),onSuccess:()=>{i.success("Subcategory updated successfully"),b.invalidateQueries({queryKey:["subcategories"]})},onError:e=>{i.error(e?.response?.data?.message||"Failed to update subcategory")}}),_=()=>S({mutationFn:e=>d.deleteSubcategory(e),onSuccess:()=>{i.success("Subcategory deleted successfully"),b.invalidateQueries({queryKey:["subcategories"]})},onError:e=>{i.error(e?.response?.data?.message||"Failed to delete subcategory")}}),z=()=>S({mutationFn:e=>d.toggleSubcategoryStatus(e),onSuccess:e=>{i.success(e.data.isActive?"Subcategory activated":"Subcategory deactivated"),b.invalidateQueries({queryKey:["subcategories"]})},onError:e=>{i.error(e?.response?.data?.message||"Failed to toggle subcategory status")}}),H=e=>U({queryKey:["subcategories",e],queryFn:()=>d.getSubcategories(e),staleTime:300*1e3}),he=()=>{const{id:e}=R(),[t,s]=c.useState(!1),[o,g]=c.useState(null),[r,u]=c.useState(1),[h]=c.useState(10),[p,j]=c.useState(""),[y,q]=c.useState("");c.useEffect(()=>{const a=e;a&&q(a)},[e]);const v=c.useMemo(()=>{const a={page:r,limit:h};return p&&(a.search=p),y&&(a.category=y),a},[r,h,p,y]),{data:A,isLoading:L}=H(v),m=A?.data;console.log("responseData",m);const D=m||[],f=m?.meta?.pagination?.pages||1,w=N(),P=W(),C=_(),x=z(),E=a=>{g(a||null),s(!0)},F=()=>{g(null),s(!1)},K=async a=>{o?await P.mutateAsync({id:o._id,data:a}):await w.mutateAsync(a),F()},O=async a=>{await C.mutateAsync(a)},Q=async a=>{await x.mutateAsync(a)},I=a=>{j(a),u(1)},M=w.isPending||P.isPending||C.isPending||x.isPending,T=a=>{u(a)};return l.jsxs("div",{className:"container mx-auto py-6 px-4",children:[l.jsx(B,{title:"Subcategories",categories:D,onEdit:E,onDelete:O,onToggleStatus:Q,isLoading:L,actionLoading:M,searchValue:p,onSearchChange:I,showSearch:!0,showSort:!1,showFilter:!1,onAddCategory:E}),f>1&&l.jsx($,{currentPage:r,totalPages:f,onPageChange:T}),t&&l.jsx(V,{isOpen:t,onClose:F,onSubmit:K,category:o,categoryId:y,isLoading:M,edit:!!o})]})};export{he as default};
