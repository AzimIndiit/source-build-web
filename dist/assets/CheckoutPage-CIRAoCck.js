import{A as me,c as he,j as e,aq as _e,ar as $e,as as ze,at as Be,au as Te,bo as Ve,B as L,r as o,a1 as qe,ah as p,K as I,t as xe,z as y,a as Re,u as Ge,af as Ue,a2 as Ye,a3 as He,bp as Qe,x as We,C as F,R as Q,i as E,L as W,al as ne,aB as Ke,aA as Ze,ag as C,ai as ce,V as oe,W as de,aO as Je,a6 as Xe}from"./index-BiCr9dd_.js";import{L as ye}from"./LazyImage-B7kMTuiL.js";import{u as es,j as ss,d as pe,a as ts,b as ue,m as as,v as rs,c as is,e as ls,g as ns,h as cs,A as os}from"./unionpay-CZN5Yg3W.js";import{g as ds}from"./colorUtils-Cg0F6a_m.js";import"./proxy-16hbtkMy.js";import"./alert-BWvEVmDW.js";import"./index-Drpci46K.js";import"./circle-alert-Cy-Zb1fX.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],us=me("clock-3",ps);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],hs=me("shield-check",ms),xs="/assets/success-Cn7pfYR-.svg",ys=({isOpen:d,onClose:n,onViewOrders:x})=>{const f=he(),B=()=>{n(),x?x():f("/buying")};return e.jsx(_e,{open:d,onOpenChange:n,children:e.jsxs($e,{className:"sm:max-w-[500px] text-center bg-white",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(ye,{src:xs,alt:"Order placed successfully",className:"w-40 h-40 object-contain",loading:"lazy"})}),e.jsxs(ze,{className:"space-y-3",children:[e.jsx(Be,{className:"text-2xl font-bold text-center",children:"Order Placed Successfully!"}),e.jsxs(Te,{className:"text-center text-gray-600",children:["Success! Your payment has been processed.",e.jsx("br",{}),"Thank you for your purchase!"]})]}),e.jsx(Ve,{className:"mt-6",children:e.jsx(L,{onClick:B,className:"w-full bg-primary hover:bg-primary/90 text-white font-semibold py-3 text-base h-12",children:"Check Buying List"})})]})})},gs={visa:rs,mastercard:as,amex:ue,"american express":ue,discover:ts,diners:pe,"diners club":pe,jcb:ss,unionpay:es},fs=d=>{const n=d.toLowerCase().trim();return gs[n]||null},js=({id:d,accountHolder:n,accountNumber:x,bankName:f,expiryDate:B,onDelete:K,onToggleDefault:l,className:A,isDefault:r,totalCards:S,isCard:D=!1})=>{const[Z,J]=o.useState(!1),[O,u]=o.useState(r);return qe.useEffect(()=>{u(r)},[r]),console.log("isDefault && totalBankAccount ",r,S),e.jsx("div",{className:p("relative  flex flex-col overflow-hidden "),children:e.jsxs("div",{className:"flex h-full justify-between items-end text-gray-700",children:[e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("p",{className:"text-base font-medium",children:n}),r&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 text-xs font-medium text-primary bg-blue-100 rounded",children:"Default"})]}),e.jsx("p",{className:"text-lg font-mono tracking-[0.2em] ",children:x})]}),e.jsx("div",{className:"flex flex-col justify-end items-end ",children:(()=>{const w=fs(f);return w?e.jsx("img",{src:w,alt:`${f} logo`,className:"h-12 w-auto object-contain"}):e.jsx("span",{className:"text-2xl font-bold uppercase tracking-wider italic",children:f})})()})]})})};class bs{async createPaymentIntent(n){return(await I.post("/checkout/create-payment-intent",n)).data.data}async confirmPayment(n){return(await I.post("/checkout/confirm-payment",n)).data.data}async cancelPayment(n,x){return(await I.post("/checkout/cancel-payment",{paymentIntentId:n,orderId:x})).data}async getPaymentStatus(n){return(await I.get(`/checkout/payment-status/${n}`)).data.data}async retryPayment(n,x){return(await I.post("/checkout/retry-payment",{paymentIntentId:n,paymentMethodId:x})).data.data}}const ge=new bs,vs=()=>xe({mutationFn:d=>ge.createPaymentIntent(d),onError:d=>{y.error(d.response?.data?.message||"Failed to create payment intent")}}),Ns=()=>xe({mutationFn:d=>ge.confirmPayment(d),onSuccess:()=>{y.success("Payment confirmed successfully")},onError:d=>{y.error(d.response?.data?.message||"Failed to confirm payment")}}),Es=()=>{const d=he(),n=Re(),{isAuthenticated:x}=Ge(),{items:f,getTotalPrice:B,clearCart:K}=Ue(),[l,A]=o.useState("delivery"),[r,S]=o.useState(null),[D,Z]=o.useState(!1),[J,O]=o.useState(!1),[u,w]=o.useState(null),[fe,T]=o.useState(!1),[V,X]=o.useState(null),[_,je]=o.useState(!1),[be,ee]=o.useState(!1),[j,se]=o.useState(!1),{data:$,refetch:ve}=Ye(x),te=He(),Ne=vs(),we=Ns(),ae=n.state?.buyNowItem,q=!!ae,P=q?[ae]:f,ke=()=>{const s=new Map;return P.forEach(t=>{const a=t.seller?.id||"default";t.seller?.businessName,s.has(a)||s.set(a,{pickup:!1,delivery:!1,shipping:!1,items:[]});const i=s.get(a);i.items.push(t),t.marketplaceOptions?(t.marketplaceOptions.pickup&&(i.pickup=!0),t.marketplaceOptions.delivery&&(i.delivery=!0),t.marketplaceOptions.shipping&&(i.shipping=!0)):(i.pickup=!0,i.delivery=!0,i.shipping=!0)}),s},c=(()=>{const s={pickup:!1,delivery:!1,shipping:!1};return P.forEach(t=>{t.marketplaceOptions?(t.marketplaceOptions.pickup&&(s.pickup=!0),t.marketplaceOptions.delivery&&(s.delivery=!0),t.marketplaceOptions.shipping&&(s.shipping=!0)):(s.pickup=!0,s.delivery=!0,s.shipping=!0)}),s})(),Ce=ke().size>1,R=s=>!!(!s.marketplaceOptions||l==="pickup"&&s.marketplaceOptions.pickup||l==="delivery"&&s.marketplaceOptions.delivery||l==="shipping"&&s.marketplaceOptions.shipping),b=P.filter(R),re=P.filter(s=>!R(s)),Se=re.length>0,{data:Pe,refetch:G}=is(),ie=ls(),Ae=ns(),De=cs(),h=Array.isArray($?.data)?$.data:$?.data?[$.data]:[],m=Pe?.data||[];o.useEffect(()=>{l||(c.pickup?A("pickup"):c.delivery?A("delivery"):c.shipping&&A("shipping"))},[c,l]),o.useEffect(()=>{if(h&&h.length>0&&!r){const s=h.find(t=>t.isDefault);S(s||h[0])}},[h,r]),o.useEffect(()=>{if(m&&m.length>0&&!u){const s=m.find(t=>t.isDefault);w(s||m[0])}},[m,u]);const z=Qe(({currentLocation:s,nextLocation:t})=>j&&s.pathname!==t.pathname);o.useEffect(()=>{z.state==="blocked"&&(window.confirm("Payment is being processed. Are you sure you want to leave this page? Your payment may fail.")?z.proceed():z.reset())},[z]),o.useEffect(()=>{const s=i=>{if(j)return i.preventDefault(),i.returnValue="Payment is being processed. Are you sure you want to leave?","Payment is being processed. Are you sure you want to leave?"},t=()=>{j&&console.warn("Payment processing was interrupted")},a=i=>{j&&(i.preventDefault(),window.history.pushState(null,"",window.location.href),alert("Payment is being processed. Please wait for it to complete."))};return window.addEventListener("beforeunload",s),window.addEventListener("unload",t),window.addEventListener("popstate",a),j&&window.history.pushState(null,"",window.location.href),()=>{window.removeEventListener("beforeunload",s),window.removeEventListener("unload",t),window.removeEventListener("popstate",a)}},[j]);const U=b.reduce((s,t)=>s+t.price*t.quantity,0);re.reduce((s,t)=>s+t.price*t.quantity,0);const Me=()=>{if(l!=="shipping")return 0;const s=new Map;b.forEach(a=>{const i=a.seller?.id||"default";s.has(i)||s.set(i,[]),s.get(i).push(a)});let t=0;return s.forEach((a,i)=>{const N=new Map;a.forEach(g=>{const M=g.productId||g.id;N.has(M)||N.set(M,[]),N.get(M).push(g)});let v=0;N.forEach(g=>{const M=g[0].shippingPrice||0;v=Math.max(v,M)}),t+=v}),t};let k=0;l==="delivery"?k=39:l==="shipping"&&(k=Me());const Y=0,H=0,le=U+k+Y-H,Ie=async()=>{if((l==="delivery"||l==="shipping")&&!r){y.error(`Please select a ${l} address`);return}if(!u){y.error("Please select a payment method");return}se(!0);try{const s={items:b.map(a=>({productId:a.productId||a.id,title:a.title,price:a.price,quantity:a.quantity,image:a.image,color:a.color,seller:a.seller,shippingPrice:a.shippingPrice||0})),deliveryMethod:l,deliveryAddress:r?{name:r.name||r.label||"",phone:r.phoneNumber||r.phone||"",street:r.street||r.location||"",city:r.city||"",state:r.state||"",zipCode:r.zipCode||r.zip||"",country:r.country||"USA"}:void 0,paymentCardId:u._id||u.id,totals:{subtotal:U,deliveryFee:k,tax:Y,discount:H,total:le},notes:""},t=await Ne.mutateAsync(s);await we.mutateAsync({paymentIntentId:t.paymentIntentId,orderId:t.orderIds[0]}),ee(!0)}catch(s){console.error("Payment error:",s),y.error(s.response?.data?.message||"Payment failed. Please try again.")}finally{se(!1)}},Fe=async s=>{try{await te.mutateAsync(s),await ve(),O(!1)}catch(t){console.error("Failed to add address:",t)}},Ee=async s=>{try{V||await ie.mutateAsync(s),await G(),T(!1),X(null),y.success("Card added successfully")}catch(t){console.error("Failed to add card:",t),y.error("Failed to add card")}},Le=async s=>{try{await Ae.mutateAsync(s._id||s.id),await G(),y.success("Card deleted successfully")}catch(t){console.error("Failed to delete card:",t),y.error("Failed to delete card")}},Oe=async s=>{try{await De.mutateAsync(s),await G(),y.success("Default card updated")}catch(t){console.error("Failed to update default card:",t),y.error("Failed to update default card")}};return P.length===0?e.jsxs("div",{className:"min-h-[600px] flex flex-col items-center justify-center px-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"Please add items to your cart before checkout."}),e.jsx(L,{onClick:()=>d("/marketplace"),className:"bg-primary hover:bg-primary/90 text-white",children:"Continue Shopping"})]}):e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/80 backdrop-blur-sm flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl",children:e.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(We,{className:"h-16 w-16 text-primary animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(hs,{className:"h-8 w-8 text-primary/50"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Processing Payment"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we securely process your payment..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Do not close or refresh this page"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-4 py-2 rounded-lg",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 2L4 7V12C4 16.5 7 20.26 12 21C17 20.26 20 16.5 20 12V7L12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("span",{children:"Secured by Stripe"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"bg-primary h-full rounded-full animate-pulse",style:{width:"70%"}})})]})})}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"sm:col-span-2 space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:q?"Buy Now Checkout":"Checkout"}),e.jsxs(F,{className:"p-4 gap-1",children:[e.jsx("div",{className:"flex justify-between gap-2 items-center border-b border-gray-200 pb-2",children:e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"How would you like to get your Product?"})}),Ce&&e.jsxs("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-amber-800 font-medium mb-2",children:"Note: You have items from multiple sellers"}),e.jsx("p",{className:"text-sm text-amber-700",children:"When you select a delivery method, only items from sellers who support that method will be included in the order. Items from other sellers will need to be ordered separately."})]}),e.jsx("div",{className:"mt-4",children:e.jsx(Q,{value:l,onValueChange:s=>A(s),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:p("flex items-center space-x-3 rounded-lg",c.pickup?"hover:bg-gray-50":"opacity-50"),children:[e.jsx(E,{value:"pickup",id:"pickup",disabled:!c.pickup}),e.jsxs(W,{htmlFor:"pickup",className:p("flex-1 flex items-center justify-between",c.pickup?"cursor-pointer":"cursor-not-allowed"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-600"}),"Pickup"]}),e.jsx("span",{className:c.pickup?"text-green-600 font-medium":"text-gray-500",children:c.pickup?"Free":"Not available"})]})]}),e.jsxs("div",{className:p("flex items-center space-x-3 rounded-lg",c.delivery?"hover:bg-gray-50":"opacity-50"),children:[e.jsx(E,{value:"delivery",id:"delivery",disabled:!c.delivery}),e.jsxs(W,{htmlFor:"delivery",className:p("flex-1 flex items-center justify-between",c.delivery?"cursor-pointer":"cursor-not-allowed"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-5 w-5 text-gray-600"}),"Delivery"]}),e.jsx("span",{className:"text-gray-600",children:c.delivery?"$39 + $1/mile":"Not available"})]})]}),e.jsxs("div",{className:p("flex items-center space-x-3 rounded-lg",c.shipping?"hover:bg-gray-50":"opacity-50"),children:[e.jsx(E,{value:"shipping",id:"shipping",disabled:!c.shipping}),e.jsxs(W,{htmlFor:"shipping",className:p("flex-1 flex items-center justify-between",c.shipping?"cursor-pointer":"cursor-not-allowed"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5 text-gray-600"}),"Shipping"]}),e.jsx("span",{className:"text-gray-600",children:c.shipping?(()=>{const s=new Map;b.forEach(a=>{const i=a.seller?.id||"default";s.has(i)||s.set(i,[]),s.get(i).push(a)});let t=0;return s.forEach(a=>{const i=new Map;a.forEach(v=>{const g=v.productId||v.id;i.has(g)||i.set(g,[]),i.get(g).push(v)});let N=0;i.forEach(v=>{const g=v[0].shippingPrice||0;N=Math.max(N,g)}),t+=N}),t>0?C(t):"Free"})():"Not available"})]})]})]})})})]}),(l==="delivery"||l==="shipping")&&e.jsxs(F,{className:p("p-4 min-h-40",(l==="delivery"||l==="shipping")&&!r&&"border-red-200"),children:[e.jsxs("div",{className:"flex justify-between gap-2 items-center border-b border-gray-200 pb-4",children:[e.jsxs("h3",{className:"flex gap-2 items-center font-semibold text-gray-900",children:[" ",e.jsx(ne,{})," ",l==="delivery"?"Delivery":"Shipping"," Address"]}),e.jsxs(L,{type:"button",onClick:()=>O(!0),variant:"outline",className:" flex items-center justify-center gap-2 text-sm h-10 border border-primary text-primary hover:text-primary hover:bg-primary/10",children:[e.jsx(ce,{className:"h-4 w-4"}),"Add New Address"]})]}),h&&h.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Q,{value:r?.id||r?._id||"",onValueChange:s=>{const t=h.find(a=>(a.id||a._id)===s);t&&S(t)},children:e.jsx("div",{className:p("space-y-3 transition-all duration-300",!D&&h.length>3&&"max-h-[300px] overflow-hidden"),children:(D?h:h.slice(0,3)).map(s=>e.jsxs("div",{className:p("flex items-start gap-3 p-3 rounded-lg cursor-pointer relative border",r?.id===s.id||r?._id===s._id?"bg-blue-50 border-primary":"bg-gray-50 border-gray-200 hover:bg-gray-100"),onClick:()=>S(s),children:[e.jsx(E,{value:s.id||s._id,id:s.id||s._id,className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name||s.label||"Address"}),s.isDefault&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 text-xs font-medium text-primary bg-blue-100 rounded",children:"Default"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.formattedAddress||s.fullAddress||`${s.street||""}, ${s.city||""}, ${s.state||""} ${s.zipCode||""}`}),(s.phoneNumber||s.phone)&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Phone: ",s.phoneNumber||s.phone]})]})]},s.id||s._id))})}),h.length>3&&e.jsx("button",{onClick:()=>Z(!D),className:"flex items-center gap-2 text-sm text-primary hover:text-primary/80 font-medium mx-auto mt-4",children:D?e.jsxs(e.Fragment,{children:["Show Less",e.jsx(oe,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["Show More (",h.length-3," more)",e.jsx(de,{className:"w-4 h-4"})]})})]}):e.jsx("div",{className:"space-y-4 flex justify-center items-center min-h-40",children:e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Save your addresses for quick access during checkout"})})]}),e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between gap-2 items-center border-b border-gray-200 pb-4",children:e.jsxs("h3",{className:"flex gap-2 items-center font-semibold text-gray-900",children:[e.jsx(us,{})," Expected Delivery Time"]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-700",children:"12-02-2025 to 20-02-2025"})})]}),e.jsxs(F,{className:p("p-4 min-h-40",!u&&"border-red-200"),children:[e.jsxs("div",{className:"flex justify-between gap-2 items-center border-b border-gray-200 pb-4",children:[e.jsxs("h3",{className:"flex gap-2 items-center font-semibold text-gray-900",children:[" ",e.jsx(Je,{})," Payment Method"]}),e.jsxs(L,{type:"button",onClick:()=>T(!0),variant:"outline",className:"flex items-center justify-center gap-2 text-sm h-10 border border-primary text-primary hover:text-primary hover:bg-primary/10",children:[e.jsx(ce,{className:"h-4 w-4"}),"Add New Card"]})]}),m&&m.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Q,{value:u?.id||u?._id||"",onValueChange:s=>{const t=m.find(a=>(a.id||a._id)===s);t&&w(t)},children:e.jsx("div",{className:p("space-y-3 transition-all duration-300",_&&m.length>3&&"max-h-[400px] overflow-y-auto pr-2"),children:(_?m:m.slice(0,3)).map(s=>e.jsxs("div",{className:p("flex items-start gap-3 p-3 rounded-lg cursor-pointer relative border",u&&(u.id&&u.id===s.id||u._id&&u._id===s._id)?"bg-blue-50 border-primary":"bg-gray-50 border-gray-200 hover:bg-gray-100"),onClick:()=>w(s),children:[e.jsx(E,{value:s.id||s._id,id:s.id||s._id,className:"mt-1"}),e.jsx("div",{className:"flex-1",children:e.jsx(js,{id:s._id||s.id,accountHolder:s.cardholderName||s.name||"Card Holder",accountNumber:`**** **** **** ${s.last4||s.last4Digits||"****"}`,bankName:s.brand||s.cardBrand||"Card",expiryDate:s.expiryMonth&&s.expiryYear?`${s.expiryMonth}/${s.expiryYear}`:void 0,onDelete:()=>Le(s),onToggleDefault:async(t,a)=>{a&&await Oe(t)},isDefault:s.isDefault,totalCards:m.length>0,isCard:!0})})]},s.id||s._id))})}),m.length>3&&e.jsx("button",{onClick:()=>je(!_),className:"flex items-center gap-2 text-sm text-primary hover:text-primary/80 font-medium mx-auto mt-4",children:_?e.jsxs(e.Fragment,{children:["Show Less",e.jsx(oe,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["Show More (",m.length-3," more)",e.jsx(de,{className:"w-4 h-4"})]})})]}):e.jsx("div",{className:"space-y-4 flex justify-center items-center min-h-40",children:e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Save your payment cards for quick and secure checkout"})})]})]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsxs(F,{className:"p-4 sticky top-4 gap-1",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2 border-b border-gray-200 pb-2",children:"Order Details"}),e.jsx("div",{className:"space-y-4  max-h-[400px] overflow-y-auto",children:P.map(s=>{const t=R(s);return e.jsxs("div",{className:p("flex gap-4 pb-4 border-b border-gray-200 last:border-0 relative",!t&&"opacity-50"),children:[!t&&e.jsx("div",{className:"absolute -left-2 top-0 bottom-0 w-1 bg-red-400 rounded-r"}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ye,{src:s.image,alt:s.title,className:"rounded-lg",wrapperClassName:"w-20 h-20 rounded-lg overflow-hidden bg-gray-100",fallbackSrc:"https://placehold.co/80x80",objectFit:"cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:p("font-medium line-clamp-2",t?"text-gray-900":"text-gray-500"),children:s.title}),!t&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Not available for ",l]}),s.color&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Color: ",e.jsx("span",{className:"capitalize",children:ds(s.color).name})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Quantity: ",s.quantity]}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[s.originalPrice&&s.originalPrice>s.price&&e.jsx("span",{className:"text-sm line-through text-gray-400",children:C(s.originalPrice*s.quantity)}),e.jsx("p",{className:p("font-semibold",t?"text-primary":"text-gray-400 line-through"),children:C(s.price*s.quantity)}),s.discount&&s.discount.discountType!=="none"&&s.discount.discountValue&&t&&e.jsx("span",{className:"text-xs font-medium text-primary bg-primary/10 px-1.5 py-0.5 rounded",children:s.discount.discountType==="percentage"?`${s.discount.discountValue}% OFF`:`$${s.discount.discountValue} OFF`})]})]})]},s.id)})}),e.jsxs("div",{className:"space-y-3 mt-2 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:C(U)})]}),k>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:l==="delivery"?"Delivery":l==="shipping"?"Shipping":"Service Fee"}),e.jsx("span",{children:C(k)})]}),l==="shipping"&&k>0&&e.jsxs("div",{className:"mt-1 text-xs text-gray-500 italic",children:["Combined shipping from"," ",new Set(b.map(s=>s.seller?.id||"default")).size," ","seller(s)"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:C(Y)})]}),H>0,e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-3 border-t border-gray-200",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-primary",children:C(le)})]})]}),e.jsx("div",{className:"flex flex-col justify-end items-end ",children:e.jsxs("div",{children:[e.jsx(L,{onClick:Ie,disabled:j||b.length===0,className:"w-[224px] mt-6 bg-primary hover:bg-primary/80 text-white font-semibold py-3 text-base disabled:opacity-50",children:j?"Processing...":b.length===0?"No items available":Se?`Place Order (${b.length} ${b.length===1?"item":"items"})`:"Place Order"}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ”’ Secure checkout powered by Stripe"})})]})})]})})]}),e.jsx(Xe,{isOpen:J,onClose:()=>O(!1),onSubmit:Fe,isSubmitting:te.isPending,totalAddress:h.length>0}),e.jsx(os,{isOpen:fe,onClose:()=>{T(!1),X(null)},onSubmit:Ee,isSubmitting:ie.isPending,totalCards:m.length>0,isEdit:!!V,initialData:V}),e.jsx(ys,{isOpen:be,onClose:()=>{ee(!1),q||K(),d("/buying")}})]})]})};export{Es as default};
